"use strict";const e=require("../../common/vendor.js"),r=require("../../stores/user.js"),t=require("../../stores/app.js"),o=require("../../api/account.js"),s=require("../../utils/client.js");if(require("../../api/user.js"),require("../../utils/request/index.js"),require("../../utils/request/http.js"),require("../../enums/requestEnums.js"),require("../../utils/request/cancel.js"),require("../../utils/auth.js"),require("../../enums/constantEnums.js"),require("../../utils/cache.js"),require("../../router/index.js"),require("../../config/index.js"),require("../../hooks/useShareMessage.js"),require("../../utils/util.js"),require("../../stores/navigationBarTitle.js"),require("../../api/app.js"),require("../../api/chat.js"),require("../../api/voice_chat.js"),require("../../enums/appEnums.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("router-navigate")+e.resolveComponent("tabbar")+e.resolveComponent("u-button")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+u+(()=>"../../components/tabbar/tabbar.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../components/popup-bottom/popup-bottom.js"))();const u=()=>"../login/components/update-user-info.js",n=e.defineComponent({__name:"user",setup(u){const n=r.useUserStore(),{userInfo:a,isLogin:i,userTokens:p}=e.toRefs(n),c=t.useAppStore(),l=e.computed((()=>c.getWebsiteConfig)),m=e.computed((()=>c.getRechargeConfig)),g=e.computed((()=>c.getCardCodeConfig)),d=e.computed((()=>{if(l.value.customer_service){const{wx_image:e,title:r,time:t,phone:o}=l.value.customer_service;return{wx_image:e,title:r,time:t,phone:o}}return{}})),f=e.ref(!1),v=async e=>{await o.updateUser(e,{token:a.value.token}),n.getUser(),f.value=!1},h=e.ref(!1),j=()=>{e.index.downloadFile({url:d.value.wx_image,success:r=>{e.index.saveImageToPhotosAlbum({filePath:r.tempFilePath,success:()=>{e.index.$u.toast("保存成功")},fail:r=>{e.index.$u.toast("保存失败")}})},fail:r=>{e.index.$u.toast("保存失败")}})};return e.onShow((()=>{n.getUser()})),(r,t)=>e.e({a:e.p({"is-custom-back-icon":!0,"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"}}),b:e.unref(i)},e.unref(i)?{c:e.unref(a).avatar,d:e.o((e=>f.value=!0))}:{e:e.unref(l).shop_logo},{f:!e.unref(i)},(e.unref(i),{}),{g:e.t(e.unref(a).nickname),h:e.t(e.unref(i)?e.unref(p):"-"),i:e.o((r=>(r=>{let t;switch(r){case"recharge":t="/packages/pages/recharge/recharge",s.isIOS()&&1==m.value.is_ios_open&&1==g.value.is_open&&(t="/packages/pages/redeem/redeem");break;case"creation_record":t="/packages/pages/creation_record/creation_record"}e.index.$u.route({url:t})})("recharge"))),j:e.t(e.unref(l).shop_name),k:e.p({to:"/packages/pages/creation_record/creation_record"}),l:e.p({to:"/packages/pages/tokens_rule/tokens_rule"}),m:e.o((e=>{h.value=!0})),n:e.p({to:"/packages/pages/setting/setting","hover-class":"none"}),o:e.o(v),p:e.o((r=>e.isRef(f)?f.value=r:null)),q:e.p({logo:e.unref(l).shop_logo,title:e.unref(l).shop_name,userInfo:e.unref(a),show:e.unref(f)}),r:e.unref(d).wx_image,s:e.o(j),t:e.p({type:"primary",shape:"circle","custom-style":{width:"606rpx",height:"90rpx",fontWeight:"bold",fontSize:"26rpx"}}),v:e.t(e.unref(d).time),w:e.o((r=>e.isRef(h)?h.value=r:null)),x:e.p({title:"了解更多",height:"80%","custom-style":{background:"linear-gradient(180deg, #E4F5FF 6.21%, #F9FAFB 64.71%)"},show:e.unref(h)})})}}),a=e._export_sfc(n,[["__scopeId","data-v-0f84de54"]]);wx.createPage(a);
