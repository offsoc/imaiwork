"use strict";const e=require("../../../common/vendor.js"),r=require("../../../api/account.js"),t=require("./hooks.js");if(require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../utils/auth.js"),require("../../../enums/constantEnums.js"),require("../../../utils/cache.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../hooks/useShareMessage.js"),require("../../../router/index.js"),require("../../../utils/util.js"),require("../../../stores/navigationBarTitle.js"),require("../../../stores/app.js"),require("../../../api/app.js"),require("../../../api/chat.js"),require("../../../api/voice_chat.js"),require("../../../config/index.js"),require("../../../hooks/useLockFn.js"),!Array){(e.resolveComponent("u-button")+e.resolveComponent("agreement"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../components/agreement/agreement.js"))();const s=e.defineComponent({__name:"weixin",props:{loading:{type:Boolean},authKey:null},emits:["login"],setup(s,{emit:i}){const{showOtherWayBtn:u}=t.useLoginWay(),o=e.shallowRef(),n=()=>{var e;null==(e=o.value)||e.checkAgreement()},a=e.computed((()=>{var e;return null==(e=o.value)?void 0:e.isActive})),c=async t=>{const{encryptedData:s,iv:u,code:o,errno:n,errMsg:a}=t.detail;try{if(!o)throw a;e.index.showLoading({title:"获取中...",mask:!0});const t=await r.getMobileNumber({code:o});i("login",t)}catch(c){e.index.showToast({title:c||"获取手机号失败",icon:"none",duration:5e3})}finally{e.index.hideLoading()}};return(r,t)=>e.e({a:e.o(n),b:e.o(c),c:e.p({type:"primary",shape:"circle","open-type":e.unref(a)||s.authKey?"getPhoneNumber":"","custom-style":{height:"90rpx","box-shadow":"0px 6px 12px 0px rgba(0,101,251,0.2)",marginBottom:s.authKey?"120rpx":"0rpx"}}),d:!s.authKey},s.authKey?{}:e.e({e:e.unref(u)},e.unref(u)?{f:e.o((r=>{e.index.$u.route({url:"/pages/login/mobile",type:"redirect"})})),g:e.p({shape:"circle","custom-style":{height:"90rpx",border:"1rpx solid #DCDDDE",backgroundColor:"transparent"}})}:{},{h:e.sr(o,"5c1fc504-2",{k:"agreementRef"})}))}});wx.createComponent(s);
