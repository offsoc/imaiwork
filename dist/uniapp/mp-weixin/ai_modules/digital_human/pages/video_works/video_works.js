"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../api/digital_human.js"),t=require("../../../../utils/file.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button")+e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+o+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+n)();const o=()=>"../../components/video-item/video-item.js",n=()=>"../../components/video-preview/video-preview.js",r=e.defineComponent({__name:"video_works",setup(o){const n=e.ref([]),r=e.shallowRef(),s=async(e,t)=>{var o,n;try{const{lists:n}=await i.digitalHumanLists({page_no:e,page_size:t});n.forEach((e=>{e.is_delete=!1})),null==(o=r.value)||o.complete(n)}catch(s){null==(n=r.value)||n.complete(!1)}},u=e.ref(!1),a=e.computed((()=>n.value.filter((e=>e.is_delete)).map((e=>e.id)))),l=()=>{u.value=!u.value},d=e.ref(""),c=e.ref(!1),p=({video_url:e})=>{d.value=e,c.value=!0},m=t=>{e.index.showModal({title:"提示",content:"确定要删除吗？",success:async o=>{var s;if(o.confirm){e.index.showLoading({title:"删除中...",mask:!0});try{return await i.deleteDigitalHuman({id:a.value.length>0?a.value:t}),null==(s=r.value)||s.reload(),void e.index.showToast({title:"删除成功",icon:"none",duration:2e3})}catch(l){e.index.showToast({title:l||"删除失败",icon:"none",duration:2e3})}finally{e.index.hideLoading()}}else u.value=!1,n.value.forEach((e=>{e.is_delete=!1}))}})},v=t=>{e.index.showModal({title:"提示",content:"确定要重试吗？",success:async o=>{var n;if(o.confirm){e.index.showLoading({title:"重试中...",mask:!0});try{await i.retryVideo({video_id:t}),null==(n=r.value)||n.reload(),e.index.showToast({title:"重试成功",icon:"none",duration:2e3})}catch(s){e.index.showToast({title:s||"重试失败",icon:"none",duration:2e3})}finally{e.index.hideLoading()}}else;}})},f=e=>{t.saveVideoToPhotosAlbum(e)};return(i,t)=>e.e({a:e.p({"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"},title:"我的作品","title-bold":!0}),b:e.t(e.unref(n).length),c:e.unref(n).length>0},e.unref(n).length>0?{d:e.t(e.unref(u)?"取消":"管理"),e:e.o(l),f:e.p({type:"primary","custom-style":{height:"42rpx",fontSize:"24rpx",padding:"0 12rpx"}})}:{},{g:e.f(e.unref(n),((i,t,o)=>e.e(e.unref(u)?e.e({a:i.is_delete},i.is_delete?{b:"37414e16-3-"+o+",37414e16-2",c:e.p({name:"checkmark",color:"#fff",size:20})}:{},{d:i.is_delete?1:"",e:e.o((e=>i.is_delete=!i.is_delete),t)}):{},{f:e.o(v,t),g:e.o(m,t),h:e.o(p,t),i:e.o(f,t),j:"37414e16-4-"+o+",37414e16-2",k:e.p({item:{id:i.id,name:i.name,pic:i.pic,status:i.status,remark:i.remark,video_url:i.result_url,model_version:i.model_version},"show-more":!e.unref(u)}),l:t}))),h:e.unref(u),i:e.sr(r,"37414e16-2",{k:"pagingRef"}),j:e.o(s),k:e.o((i=>e.isRef(n)?n.value=i:null)),l:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(n)}),m:e.unref(u)},e.unref(u)?{n:e.t(e.unref(a).length),o:e.o(m),p:e.p({type:"error",disabled:0===e.unref(a).length,"custom-style":{height:"64rpx",fontSize:"24rpx",padding:"0 24rpx",borderRadius:"16rpx"}})}:{},{q:e.o((e=>c.value=!1)),r:e.o((i=>e.isRef(c)?c.value=i:null)),s:e.p({title:"视频预览","video-url":e.unref(d),show:e.unref(c)})})}}),s=e._export_sfc(r,[["__scopeId","data-v-37414e16"]]);wx.createPage(s);
