"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../api/ladder_player.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+t+n+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+a)();const t=()=>"./analysis.js",n=()=>"./chatlog.js",a=()=>"../../../../components/knb-bind/knb-bind.js",r=e.defineComponent({__name:"report_detail",setup(t){const n=e.reactive({id:""}),a=e.ref(null),r=e.ref(null),s=e.ref(1),u=[{label:"报告",id:1},{label:"对话",id:2}],o=e.ref(),l=()=>{var e;null==(e=o.value)||e.open()},d=async t=>{var a;e.index.showLoading({title:"训练中",mask:!0});try{await i.lpKnbTrain({ids:[n.id],indexid:t}),null==(a=o.value)||a.close(),e.index.showToast({title:"训练成功",icon:"none",duration:2e3})}catch(r){e.index.showToast({title:r||"绑定知识库失败",icon:"none",duration:3e3})}finally{e.index.hideLoading()}},c=async()=>{const e=await i.lpSceneDetail({id:a.value.scene_id});r.value=e},v=e.ref({}),p=e.getCurrentInstance(),b=()=>{p&&e.nextTick$1((()=>{const i=e.index.createSelectorQuery().in(p),t=`#tab-${s.value}`;i.select(t).boundingClientRect(),i.select("#tabs-container").boundingClientRect(),i.exec((e=>{if(e&&e[0]&&e[1]){const i=e[0],t=e[1];if(i&&t){const e=i.left-t.left,n=i.width;v.value={left:`${e}px`,width:`${n}px`}}else console.error("Could not get bounding client rect for tab or container",{activeTabData:i,containerData:t})}else console.error("Query execution failed or returned unexpected result:",e)}))}))};return e.onMounted((()=>{setTimeout((()=>{b()}),500)})),e.onLoad((t=>{n.id=t.id,(async()=>{e.index.showLoading({title:"加载中",mask:!0});try{const e=await i.lpAnalysisDetail({id:n.id});a.value=e,c()}catch(t){e.index.showToast({title:t||"获取报告详情失败",icon:"none",duration:2e3})}finally{e.index.hideLoading()}})()})),(i,t)=>e.e({a:a.value},a.value?e.e({b:e.s(v.value),c:e.f(u,((i,t,n)=>({a:e.t(i.label),b:i.id,c:"tab-"+i.id,d:s.value===i.id?1:"",e:e.o((e=>{return t=i.id,s.value=t,void b();var t}),i.id)}))),d:e.p({"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"}}),e:1===s.value},1===s.value?{f:e.p({detail:a.value})}:{},{g:2===s.value},2===s.value?{h:e.unref(n).id,i:e.p({id:e.unref(n).id,detail:a.value,"scene-detail":r.value})}:{},{j:e.o(l),k:e.p({type:"primary",shape:"circle","custom-style":{width:"500rpx"}})}):{},{l:e.sr(o,"a6e3b426-4",{k:"knbBindRef"}),m:e.o(d)})}}),s=e._export_sfc(r,[["__scopeId","data-v-a6e3b426"]]);wx.createPage(s);
