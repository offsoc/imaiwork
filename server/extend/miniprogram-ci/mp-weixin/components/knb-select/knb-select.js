"use strict";const e=require("../../common/vendor.js"),u=require("../../api/knowledge_base.js"),a=require("../../enums/appEnums.js");if(require("../../utils/request/index.js"),require("../../utils/request/http.js"),require("../../enums/requestEnums.js"),require("../../utils/request/cancel.js"),require("../../utils/auth.js"),require("../../enums/constantEnums.js"),require("../../utils/cache.js"),require("../../stores/user.js"),require("../../api/user.js"),require("../../hooks/useShareMessage.js"),require("../../router/index.js"),require("../../utils/util.js"),require("../../stores/navigationBarTitle.js"),require("../../stores/app.js"),require("../../api/app.js"),require("../../api/chat.js"),require("../../api/voice_chat.js"),require("../../config/index.js"),!Array){(e.resolveComponent("u-tabs")+e.resolveComponent("u-search")+e.resolveComponent("empty")+e.resolveComponent("z-paging")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../uni_modules/vk-uview-ui/components/u-tabs/u-tabs.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-search/u-search.js")+(()=>"../empty/empty.js")+(()=>"../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../popup-bottom/popup-bottom.js"))();const s=e.defineComponent({__name:"knb-select",props:{showVector:{type:Boolean,default:!0},showRag:{type:Boolean,default:!0}},emits:["close","confirm"],setup(s,{expose:o,emit:r}){const n=s,t=e.ref([{id:0,name:"向量知识库",value:a.KnbTypeEnum.VECTOR},{id:1,name:"RAG知识库",value:a.KnbTypeEnum.RAG}]),l=e.computed((()=>n.showVector&&n.showRag?t.value:n.showVector?t.value.filter((e=>e.value==a.KnbTypeEnum.VECTOR)):t.value.filter((e=>e.value==a.KnbTypeEnum.RAG)))),i=e.ref(0),c=e.ref(!1),p=e.ref([]),v=e.ref(),d=e.ref(""),m=async(e,a)=>{var s,o;try{const o={page_no:e,page_size:a,name:d.value},r=l.value[i.value].id,{lists:n}=await(0==r?u.vectorKnowledgeBaseLists:u.knowledgeBaseLists)(o);null==(s=v.value)||s.complete(n)}catch(r){null==(o=v.value)||o.complete([])}},f=e=>0==i.value?b.value.id==e.id:b.value.index_id==e.index_id,h=e=>{var u;i.value=e,p.value=[],null==(u=v.value)||u.reload()},g=()=>{var e;null==(e=v.value)||e.reload()},j=()=>{d.value="",g()},b=e.ref({}),q=e=>{const u=l.value[i.value].id;0==u?b.value.id==e.id?b.value={}:b.value=e:b.value.index_id==e.index_id?b.value={}:b.value=e,c.value=!1,r("confirm",{data:b.value,type:0==u?a.KnbTypeEnum.VECTOR:a.KnbTypeEnum.RAG})},w=e.ref();return o({open:async u=>{var a;c.value=!0,await e.nextTick$1(),await(null==(a=v.value)?void 0:a.reload()),b.value=u,await e.nextTick$1(),w.value.currentIndex=i.value}}),(u,a)=>({a:e.sr(w,"cf82d79c-1,cf82d79c-0",{k:"tabsRef"}),b:e.o(h),c:e.p({list:e.unref(l),current:e.unref(i),"bg-color":"transparent","font-size":"26","active-item-style":{fontWeight:"400"},"show-bar":!1}),d:e.o(g),e:e.o(j),f:e.o((u=>e.isRef(d)?d.value=u:null)),g:e.p({placeholder:"搜索相关知识库",height:"80","bg-color":"#ffffff","search-icon-color":"#0000001a","placeholder-color":"#0000001a","show-action":!1,modelValue:e.unref(d)}),h:e.f(e.unref(p),((u,a,s)=>e.e({a:f(u)},(f(u),{}),{b:e.t(u.name),c:e.t(u.file_count||u.file_counts),d:f(u),e:e.o((e=>q(u)),a),f:a,g:e.n(f(u)?"shadow-_0_0_0_1px_rgba_0b101b251b1__":""),h:e.o((e=>q(u)),a)}))),i:e.sr(v,"cf82d79c-3,cf82d79c-0",{k:"pagingRef"}),j:e.o(m),k:e.o((u=>e.isRef(p)?p.value=u:null)),l:e.p({fixed:!1,auto:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(p)}),m:e.o((u=>e.isRef(c)?c.value=u:null)),n:e.p({height:"85%","is-disabled-touch":!0,"show-close-btn":!0,"custom-class":"bg-_hF9FAFB_",show:e.unref(c)})})}});wx.createComponent(s);
