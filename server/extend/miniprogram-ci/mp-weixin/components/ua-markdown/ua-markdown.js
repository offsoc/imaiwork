"use strict";const e=require("../../common/vendor.js"),t=require("./lib/markdown-it.min.js"),l=require("../../hooks/useCopy.js"),n={__name:"ua-markdown",props:{content:String,showLine:{type:[Boolean,String],default:!0}},setup(n){const r=n,s=[],a=t.mt({html:!0,breaks:!0,typographer:!0,linkify:!0,lineNumbers:!0,highlight:function(t,l){let n="";try{n=e.common.highlightAuto(t).value}catch(p){n=a.utils.escapeHtml(t)}let o=n.split(/\n/).slice(0,-1).map(((e,t)=>""==e?"":'<li style="font-size: 12px;"><span class="line-num" data-line="'+(t+1)+'"></span>'+e+"</li>")).join("");o=r.showLine?'<ol style="padding: 0px 30px;">'+o+"</ol>":'<ol style="padding: 0px 7px;list-style:none;">'+o+"</ol>",s.push(t);let i='<div class="markdown-wrap">';return i+='<div class="copy-line" style="text-align: right;font-size: 12px; margin-bottom: -10px;border-radius: 5px 5px 0 0;">',i+=`${l}<a class="code-copy-btn" code-data-index="${s.length-1}">复制代码</a>`,i+="</div>",i+=`<pre class="hljs" style="padding:10px 8px;margin:5px 0;overflow: auto;display: block;border-radius: 5px;"><code>${o}</code></pre>`,i+="</div>",i}});a.use(e.markdownItKatex);const o=e=>{if(!e)return;let t="";if((e=(e=e.replace(/<br>|<br\/>|<br \/>/g,"\n")).replace(/&nbsp;/g," ")).split("```").length%2){let l=e;"\n"!=l[l.length-1]&&(l+="\n"),t=a.render(l)}else t=a.render(e);return t=t.replace(/<table/g,'<table class="table"'),t=t.replace(/<tr/g,'<tr class="tr"'),t=t.replace(/<th>/g,'<th class="th">'),t=t.replace(/<td/g,'<td class="td"'),t=t.replace(/<hr>|<hr\/>|<hr \/>/g,'<hr class="hr">'),t},i=e=>{var t,n;const{"code-data-index":r,class:a}=null==(n=null==(t=e.detail)?void 0:t.node)?void 0:n.attrs;if("code-copy-btn"==a){const{copy:e}=l.useCopy();e(s[r])}};return(t,l)=>({a:o(n.content),b:e.o(i)})}};wx.createComponent(n);
