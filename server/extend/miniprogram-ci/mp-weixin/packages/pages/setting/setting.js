"use strict";const e=require("../../../common/vendor.js"),u=require("../../../stores/app.js"),o=require("../../../stores/user.js"),r=require("../../../api/app.js"),t=require("../../../api/user.js"),s=require("../../../api/account.js"),n=require("../../../hooks/useCopy.js"),i=require("../../../config/index.js");if(require("../../../api/chat.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../utils/auth.js"),require("../../../enums/constantEnums.js"),require("../../../utils/cache.js"),require("../../../router/index.js"),require("../../../api/voice_chat.js"),require("../../../hooks/useShareMessage.js"),require("../../../utils/util.js"),require("../../../stores/navigationBarTitle.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),!Array){(e.resolveComponent("u-line")+e.resolveComponent("u-button")+e.resolveComponent("u-icon")+e.resolveComponent("mp-html")+e.resolveComponent("u-input")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-line/u-line.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../uni_modules/mp-html/components/mp-html/mp-html.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../components/popup-bottom/popup-bottom.js")+a)();const a=()=>"../../../pages/login/components/update-user-info.js",p=e.defineComponent({__name:"setting",setup(a){const p=u.useAppStore(),l=o.useUserStore(),{userInfo:c,isLogin:f}=e.toRefs(l),m=e.computed((()=>p.config.domain)),v=e.computed((()=>p.getWebsiteConfig)),d=e.computed((()=>p.getCopyRightConfig)),g=e.computed((()=>p.getByName)),h={edit_profile:"编辑资料",service:"用户协议",privacy:"隐私政策",about:"关于我们"},j=e.ref(),q=e.ref(!1),y=e.ref(!1),_=e.ref(),b=u=>{if(j.value=u,q.value=!0,["service","privacy"].includes(u)&&E(u),"edit_profile"==u){if(!f.value)return void e.index.$u.route({url:"/pages/login/login"});_.value=c.value.nickname}},x=async e=>{await s.updateUser(e,{token:c.value.token}),await l.getUser(),_.value=c.value.nickname,y.value=!1},w=async()=>{_.value&&(await t.userEdit({field:"nickname",value:_.value}),l.getUser())},{copy:k}=n.useCopy();e.ref("");const C=e.ref(""),E=async e=>{const{content:u}=await r.getPolicy({type:e});C.value=u};return(u,o)=>e.e({a:e.t(h.edit_profile),b:e.o((e=>b("edit_profile"))),c:e.t(h.service),d:e.o((e=>b("service"))),e:e.t(h.privacy),f:e.o((e=>b("privacy"))),g:e.t(h.about),h:e.o((e=>b("about"))),i:e.o((u=>{e.index.showModal({title:"提示",content:"确定要退出登录吗？",success:async u=>{u.confirm&&(await l.logout(),e.index.$u.route({url:"/pages/user/user",type:"reLaunch"}))}})})),j:e.p({type:"primary",shape:"circle","custom-style":{height:"90rpx","box-shadow":"0px 6px 12px 0px rgba(0,101,251,0.2)"}}),k:"about"==e.unref(j)},"about"==e.unref(j)?{l:e.unref(v).shop_logo,m:e.t(e.unref(v).shop_name),n:e.p({name:"/static/images/icons/right.svg",size:28}),o:e.t(e.unref(m)),p:e.p({name:"/static/images/icons/right.svg",size:28}),q:e.t(e.unref(i.config).version),r:e.f(e.unref(d),((u,o,r)=>({a:e.t(u.key),b:o}))),s:e.t(e.unref(g))}:{},{t:["service","privacy"].includes(e.unref(j))},["service","privacy"].includes(e.unref(j))?{v:e.p({content:e.unref(C)})}:{},{w:"edit_profile"==e.unref(j)},"edit_profile"==e.unref(j)?e.e({x:e.unref(c).avatar,y:e.unref(f)},e.unref(f)?{z:e.o((e=>y.value=!0))}:{},{A:e.o(w),B:e.o((u=>e.isRef(_)?_.value=u:null)),C:e.p({placeholder:"请输入昵称","placeholder-style":"text-align: end; color: rgba(0,0,0,.2);font-size: 26rpx",modelValue:e.unref(_)}),D:e.t(e.unref(c).sn),E:e.o((u=>e.unref(k)(e.unref(c).sn))),F:e.t(e.unref(c).create_time)}):{},{G:e.o((u=>e.isRef(q)?q.value=u:null)),H:e.p({title:h[e.unref(j)],"custom-class":{"bg-_hF9FAFB_":"edit_profile"==e.unref(j)},show:e.unref(q)}),I:e.o(x),J:e.o((u=>e.isRef(y)?y.value=u:null)),K:e.p({logo:e.unref(v).shop_logo,title:e.unref(v).shop_name,userInfo:e.unref(c),show:e.unref(y)})})}}),l=e._export_sfc(p,[["__scopeId","data-v-c03f2e7a"]]);wx.createPage(l);
