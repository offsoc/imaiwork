"use strict";const e=require("../../common/vendor.js"),o=require("../../api/app.js"),r=require("../../enums/appEnums.js"),s=require("./components/hooks.js");if(require("../../utils/request/index.js"),require("../../utils/request/http.js"),require("../../enums/requestEnums.js"),require("../../utils/request/cancel.js"),require("../../utils/auth.js"),require("../../enums/constantEnums.js"),require("../../utils/cache.js"),require("../../stores/user.js"),require("../../api/user.js"),require("../../hooks/useShareMessage.js"),require("../../router/index.js"),require("../../utils/util.js"),require("../../stores/navigationBarTitle.js"),require("../../stores/app.js"),require("../../api/chat.js"),require("../../api/voice_chat.js"),require("../../config/index.js"),require("../../hooks/useLockFn.js"),require("../../api/account.js"),require("../../utils/client.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-input")+e.resolveComponent("u-verification-code")+e.resolveComponent("agreement")+e.resolveComponent("u-button"))()}Math||((()=>"../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-verification-code/u-verification-code.js")+(()=>"../../components/agreement/agreement.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+u+n+t)();const u=()=>"./components/update-user-info.js",n=()=>"./components/bind-mobile.js",t=()=>"./components/update-password.js",i=e.defineComponent({__name:"mobile",setup(u){const{loginWay:n,loginConfig:t,websiteConfig:i,loginData:a,showLoginPopup:c,showBindMobilePopup:l,mobileLoginLock:p,bindMobileSuccess:d,handleUpdateUser:f,removeWxQuery:m}=s.useLoginWay();n.value=s.LoginWayEnum.MOBILE;const v=e.reactive({scene:2,account:"",captcha:"",code:"",password:""}),h=e.reactive({account:{isFocus:!1,isError:!1},code:{isFocus:!1,isError:!1},password:{isFocus:!1,isError:!1}}),g=e.ref(!1),j=e.computed((()=>2===v.scene)),x=e.computed((()=>1===v.scene)),w=e.computed((()=>e.index.$u.test.mobile(v.account))),b=e=>{v.scene=e},q=e.shallowRef(),E=e.ref(""),y=e=>{E.value=e},F=async()=>{var s,u;if(!v.account||!w.value)return h.account.isError=!0,void e.index.$u.toast("请输入手机号码");if(h.account.isError=!1,v.captcha.length||!t.value.is_captcha){if(null==(s=q.value)?void 0:s.canGetCode)try{await o.smsSend({captcha:v.captcha,scene:r.SMSEnum.LOGIN,mobile:v.account}),e.index.$u.toast("发送成功"),null==(u=q.value)||u.start()}catch(n){e.index.$u.toast(n||"发送失败")}}else e.index.$u.toast("请先输入图形验证码")},k=e.shallowRef();e.computed((()=>{var e;return null==(e=k.value)?void 0:e.isActive}));const _=()=>{e.index.$u.route({url:"/pages/login/login",type:"redirect"})};return(o,r)=>e.e({a:e.p({"border-bottom":!1,background:{background:"transparent"},title:"登录","title-bold":!0,"custom-back":_}),b:e.t(e.unref(j)?"验证码登录":"手机号登录"),c:e.o((o=>e.unref(h).account.isFocus=!1)),d:e.o((o=>e.unref(h).account.isFocus=!0)),e:e.o((o=>e.unref(v).account=o)),f:e.p({type:"number",placeholder:"请输入手机号",maxlength:"11","placeholder-style":`color:${e.unref(h).account.isError?"#FB0000":" rgba(0,0,0,.2)"};font-size:26rpx;`,modelValue:e.unref(v).account}),g:e.unref(h).account.isFocus?1:"",h:e.unref(h).account.isError?1:"",i:e.unref(j)},e.unref(j)?{j:e.o((o=>e.unref(h).code.isFocus=!1)),k:e.o((o=>e.unref(h).code.isFocus=!0)),l:e.o((o=>e.unref(v).code=o)),m:e.p({placeholder:"请输入验证码","placeholder-style":`color:${e.unref(h).code.isError?"#FB0000":" rgba(0,0,0,.2)"};font-size:26rpx;`,modelValue:e.unref(v).code}),n:e.sr(q,"0565d6f9-3",{k:"uCodeRef"}),o:e.o(y),p:e.p({"start-text":"发送验证码","change-text":"发送验证码（xs）",seconds:60}),q:e.t(e.unref(E)),r:e.n(e.unref(w)?"text-primary":"text-muted"),s:e.o(F)}:{},{t:e.unref(x)},e.unref(x)?{v:e.o((o=>e.unref(h).password.isFocus=!1)),w:e.o((o=>e.unref(h).password.isFocus=!0)),x:e.o((o=>e.unref(v).password=o)),y:e.p({type:"password",placeholder:"请输入密码","placeholder-style":`color:${e.unref(h).password.isError?"#FB0000":" rgba(0,0,0,.2)"};font-size:26rpx;`,modelValue:e.unref(v).password}),z:e.o((e=>g.value=!0))}:{},{A:e.unref(h).code.isFocus||e.unref(h).password.isFocus?1:"",B:e.unref(h).code.isError||e.unref(h).password.isError?1:"",C:e.sr(k,"0565d6f9-5",{k:"agreementRef"}),D:e.o((o=>(async()=>{var o;if(!v.account)return h.account.isError=!0,void e.index.$u.toast("请输入手机号码");if(h.account.isError=!1,1==v.scene){if(!v.password)return h.password.isError=!0,void e.index.$u.toast("请输入密码");h.password.isError=!1}if(2==v.scene){if(!v.code)return h.code.isError=!0,void e.index.$u.toast("请输入验证码");h.code.isError=!1}(null==(o=k.value)?void 0:o.checkAgreement())&&await p(v)})())),E:e.p({type:"primary",shape:"circle","custom-style":{height:"90rpx","box-shadow":"0px 6px 12px 0px rgba(0,101,251,0.2)"}}),F:e.n(2==e.unref(v).scene?"":"text-_hB2B2B2_"),G:e.o((e=>b(2))),H:e.n(1==e.unref(v).scene?"":"text-_hB2B2B2_"),I:e.o((e=>b(1))),J:e.o(e.unref(f)),K:e.o((o=>e.isRef(c)?c.value=o:null)),L:e.p({logo:e.unref(i).shop_logo,title:e.unref(i).shop_name,userInfo:e.unref(a),show:e.unref(c)}),M:e.o(e.unref(d)),N:e.o(e.unref(m)),O:e.o((o=>e.isRef(l)?l.value=o:null)),P:e.p({userInfo:e.unref(a),show:e.unref(l)}),Q:e.o(e.unref(d)),R:e.o(e.unref(m)),S:e.o((o=>e.isRef(g)?g.value=o:null)),T:e.p({show:e.unref(g)})})}}),a=e._export_sfc(i,[["__scopeId","data-v-0565d6f9"]]);wx.createPage(a);
