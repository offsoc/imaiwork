"use strict";const e=require("../../../common/vendor.js"),u=require("../../../api/app.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../utils/auth.js"),require("../../../enums/constantEnums.js"),require("../../../utils/cache.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../hooks/useShareMessage.js"),require("../../../router/index.js"),require("../../../utils/util.js"),require("../../../stores/navigationBarTitle.js"),require("../../../stores/app.js"),require("../../../api/chat.js"),require("../../../api/voice_chat.js"),require("../../../config/index.js"),!Array){(e.resolveComponent("avatar-upload")+e.resolveComponent("u-form-item")+e.resolveComponent("u-popup"))()}Math||((()=>"../../../components/avatar-upload/avatar-upload.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form-item/u-form-item.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const t=e.defineComponent({__name:"update-user-info",props:{show:{type:Boolean},logo:{type:String},title:{type:String},userInfo:{type:Object}},emits:["update:show","update"],setup(t,{emit:o}){const r=t,a=e.computed({get:()=>r.show,set(e){o("update:show",e)}}),s=e.ref(),i=e.ref(),n=async t=>{var o;e.index.showLoading({title:"正在上传中..."});try{const a=await u.uploadImage(t,{},null==(o=r.userInfo)?void 0:o.token);s.value=a.uri,e.index.hideLoading()}catch(a){console.log(a),e.index.hideLoading(),e.index.$u.toast("上传失败，请重试")}},l=u=>{const{nickname:t}=u.detail.value;return s.value?t?void o("update",{avatar:s.value,nickname:t}):e.index.$u.toast("请输入昵称"):e.index.$u.toast("请添加头像")};return e.watch((()=>r.userInfo),(e=>{e&&(s.value=e.avatar,i.value=e.nickname)})),(u,o)=>({a:t.logo,b:e.t(t.title),c:e.o(n),d:e.o((e=>s.value=e)),e:e.p({modelValue:s.value}),f:e.p({required:!0,label:"头像",labelWidth:120}),g:i.value,h:e.o((e=>i.value=e.detail.value)),i:e.p({required:!0,label:"昵称",labelWidth:120}),j:e.o((e=>a.value=!1)),k:e.o(l),l:e.o((u=>e.isRef(a)?a.value=u:null)),m:e.p({mode:"bottom","border-radius":"14","mask-close-able":!1,modelValue:e.unref(a)})})}});wx.createComponent(t);
