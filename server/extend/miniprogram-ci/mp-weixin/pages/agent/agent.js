"use strict";const e=require("../../common/vendor.js"),a=require("../../api/agent.js"),r=require("../../hooks/useDictOptions.js"),t=require("../../stores/user.js"),u=require("../../stores/app.js");if(require("../../utils/request/index.js"),require("../../utils/request/http.js"),require("../../enums/requestEnums.js"),require("../../utils/request/cancel.js"),require("../../utils/auth.js"),require("../../enums/constantEnums.js"),require("../../utils/cache.js"),require("../../router/index.js"),require("../../config/index.js"),require("../../api/user.js"),require("../../hooks/useShareMessage.js"),require("../../utils/util.js"),require("../../stores/navigationBarTitle.js"),require("../../api/app.js"),require("../../api/chat.js"),require("../../api/voice_chat.js"),!Array){(e.resolveComponent("u-tabs")+e.resolveComponent("u-navbar")+e.resolveComponent("u-search")+e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging")+e.resolveComponent("tabbar"))()}Math||((()=>"../../uni_modules/vk-uview-ui/components/u-tabs/u-tabs.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-search/u-search.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../components/empty/empty.js")+(()=>"../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../components/tabbar/tabbar.js"))();const n=e.defineComponent({__name:"agent",setup(n){const o=u.useAppStore(),s=t.useUserStore(),i=e.computed((()=>o.getIsShowRobot)),l=e.ref([{name:"AI智能体",type:2}]),c=e.ref(0),v=e.ref(l.value[0].type),d=e.reactive({cate_id:""}),p=e.ref(0),f=e.ref(-1),m=e.shallowRef(),g=e.ref([]),b=e.ref(0),_=e.reactive({type:3,scene_id:"",name:""}),h=e.ref(!1),j=e.shallowRef(),y=e.ref([]),q=e.ref(null),w=e.ref(null),C=e.ref([]),{optionsData:x}=r.useDictOptions({robotCate:{api:a.robotCategory,params:{pageSize:9999,pid:0},transformData:e=>{var a;return e.lists.length&&(d.cate_id&&(p.value=e.lists.findIndex((e=>e.id==d.cate_id))),null==(a=m.value)||a.reload()),e.lists}}}),k=e.ref(-1),z=e.ref(),$=e.computed((()=>s.isLogin)),R=async e=>{v.value=l.value[e].type,c.value=e,1==c.value&&setTimeout((()=>{var e;null==(e=m.value)||e.reload()}),300)},A=async()=>{var e;null==(e=m.value)||e.reload()},I=async()=>{var e;null==(e=m.value)||e.reload()},L=async(e,r)=>{var t,u;try{const{lists:u=[],count:n}=await a.robotLists({page_size:r,page_no:e,..._});b.value=n,null==(t=m.value)||t.complete(u),h.value=!1}catch(n){console.error("查询机器人列表失败:",n),h.value=!1,null==(u=m.value)||u.complete(!1)}},S=e=>e.some((e=>e.id==z.value)),D=async(e,r)=>{var t,u;try{const u=1===w.value,n=u?a.getCommonAgentList:a.getCommonCozeAgentList,o={page_no:e,page_size:r,source:0,...u?{cate_id:q.value}:{agent_cate_id:q.value,type:2===w.value?1:2}},s=await n(o);null==(t=j.value)||t.complete(s.lists||[])}catch(n){console.error("查询智能体列表失败:",n),null==(u=j.value)||u.complete(!1)}};return e.watch((()=>i.value),(e=>{const a=l.value.findIndex((e=>1===e.type));a>-1&&l.value.splice(a,1),"1"==e&&l.value.unshift({name:"AI助理",type:1}),c.value=0,v.value=l.value[0].type}),{immediate:!0}),e.onLoad((({id:e})=>{e&&(d.cate_id=e)})),e.onMounted((()=>{(async()=>{try{const{lists:e}=await a.getAgentCategoryList({page_size:25e3});y.value=e||[],y.value.length>0&&(q.value=y.value[0].id,w.value=y.value[0].type)}catch(e){console.error("获取智能体分类失败:",e)}})()})),(a,r)=>e.e({a:e.unref(l).length>1},e.unref(l).length>1?{b:e.o(R),c:e.p({list:e.unref(l),"bg-color":"transparent","is-scroll":!1,current:e.unref(c)})}:{},{d:e.p({"border-bottom":!1,background:{background:"transparent"},"is-back":!1}),e:1==e.unref(v)},1==e.unref(v)?e.e({f:e.o(A),g:e.o(I),h:e.o((a=>e.unref(_).name=a)),i:e.p({"bg-color":"#ffffff","show-action":!1,placeholder:"请输入关键词",modelValue:e.unref(_).name}),j:e.f(e.unref(x).robotCate,((a,r,t)=>e.e({a:e.t(a.name),b:"a3cdd194-3-"+t,c:e.p({name:e.unref(f)==r?"arrow-down":"arrow-right",size:24,color:"#707173"}),d:e.t(a.sub_list.length),e:e.unref(f)==r},e.unref(f)==r?{f:e.f(a.sub_list,((t,u,n)=>({a:e.t(t.name),b:`${r}-${u}`,c:e.unref(z)==t.id?1:"",d:0!=e.unref(k)&&e.unref(k)-1==u&&S(a.sub_list)?1:"",e:e.o((e=>((e,a)=>{var r,t,u;if(e==k.value&&a==z.value)return;z.value=a,k.value=e,h.value=!0;const n=null==(r=x.robotCate[f.value])?void 0:r.sub_list;_.scene_id=null==(t=n[e])?void 0:t.id,null==(u=m.value)||u.reload()})(u,t.id)),`${r}-${u}`)})))}:{},{g:r,h:e.n({"robot-cate-active":e.unref(f)==r}),i:e.n({"robot-cate-brother":e.unref(k)==a.sub_list.length-1&&S(a.sub_list)}),j:e.n({"robot-cate-first":0==e.unref(k)&&S(a.sub_list)}),k:e.o((e=>(e=>{e!=f.value?f.value=e:f.value=-1})(r)),r)}))),k:e.t(e.unref(b)),l:e.unref(h)},(e.unref(h),{}),{m:e.f(e.unref(g),((a,r,t)=>({a:a.logo,b:e.t(a.name),c:e.t(a.description),d:r,e:e.o((r=>{return t=a,void e.index.$u.route({url:"/packages/pages/robot_chat/robot_chat",params:{id:t.id}});var t}),r)}))),n:e.sr(m,"a3cdd194-4",{k:"pagingRobotRef"}),o:e.o(L),p:e.o((a=>e.isRef(g)?g.value=a:null)),q:e.p({auto:!1,fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(g)})}):{},{r:2==e.unref(v)},2==e.unref(v)?{s:e.f(e.unref(y),((a,r,t)=>({a:e.t(a.name),b:e.unref(q)===a.id?1:"",c:a.id,d:e.o((e=>(e=>{var a;q.value=e.id,w.value=e.type,null==(a=j.value)||a.reload()})(a)),a.id)}))),t:e.f(e.unref(C),((a,r,t)=>({a:a.image||a.avatar,b:`url(${a.bg_image})`,c:e.t(a.name),d:e.t(a.intro||a.introduced),e:r,f:e.o((r=>(a=>{$.value?1==w.value?e.index.$u.route({url:"/pages/index/index",params:{agent_name:a.name,agent_id:a.id,agent_logo:a.image}}):e.index.$u.route({url:"/packages/pages/coze_chat/coze_chat",params:{id:a.id,type:a.type}}):e.index.$u.route({url:"/pages/login/login"})})(a)),r)}))),v:e.sr(j,"a3cdd194-6",{k:"pagingCozeRef"}),w:e.o(D),x:e.o((a=>e.isRef(C)?C.value=a:null)),y:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(C)})}:{})}}),o=e._export_sfc(n,[["__scopeId","data-v-a3cdd194"]]);wx.createPage(o);
