"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../api/sph.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){e.resolveComponent("u-icon")()}Math;const i=e.defineComponent({__name:"task-card",props:{item:{type:Object,default:()=>({id:"",name:"",status:"",number_of_implemented_keywords:0,implementation_keywords_number:0,implementation_total_number:0,create_time:""})}},emits:["changeStatus","detail","retry","edit"],setup(i,{emit:s}){const n={0:"未执行",1:"执行中",2:"已暂停",3:"已完成",4:"已结束"},r=e=>{const{number_of_implemented_keywords:t,implementation_keywords_number:i}=e;return t/i*100+"%"};return(a,o)=>{return e.e({a:e.t(i.item.name),b:e.p({name:"edit-pen",size:"24",color:"#00000080"}),c:e.o((e=>s("edit",i.item))),d:e.t(n[i.item.status]),e:[1,2].includes(parseInt(i.item.status))},[1,2].includes(parseInt(i.item.status))?{f:e.p({name:2==i.item.status?"play-right":"pause",size:22})}:{},{g:e.n((u=i.item.status,1==u?"bg-_hFFF0E5_ text-_hFB6500_":2==u||0==u?"bg-_hF6F6F6_ text-_h00000080_":3==u?"bg-_hEAF8E5_ text-_h2DBC00_":4==u?"bg-_hF6F6F6_ text-_h00000080_":void 0)),h:e.o((n=>(async i=>{const{status:n}=i;1!=n&&2!=n||e.index.showModal({title:`确定${1==n?"暂停":"继续"}任务吗？`,success:async r=>{if(r.confirm){e.index.showLoading({title:"操作中..."});try{await t.changeTaskStatus({status:1==n?2:3,id:i.id}),e.index.hideLoading(),e.index.showToast({title:"操作成功",icon:"none",duration:3e3}),s("changeStatus",i)}catch(a){e.index.hideLoading(),e.index.showToast({title:a,icon:"none",duration:3e3})}}}})})(i.item))),i:e.t(i.item.number_of_implemented_keywords||0),j:e.t(i.item.implementation_keywords_number||0),k:r(i.item),l:e.t(i.item.crawl_number||0),m:e.t(i.item.create_time),n:1==i.item.status},1==i.item.status?{o:e.o((n=>{return r=i.item,void e.index.showModal({title:"任务异常情况",content:"提醒：重新启动只会启动异常设备\n\n1. 设备启动未执行任务\n2. 设备断开重连\n",confirmText:"重新启动",success:async i=>{if(i.confirm){e.index.showLoading({title:"操作中...",mask:!0});try{await t.retryTask({id:r.id}),e.index.hideLoading(),e.index.showToast({title:"操作成功",icon:"none",duration:3e3}),s("retry",r)}catch(n){e.index.hideLoading(),e.index.showToast({title:n,icon:"none",duration:3e3})}}}});var r}))}:{},{p:e.o((e=>s("detail",i.item.id)))});var u}}});wx.createComponent(i);
