"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../common/assets.js"),n=require("../../../../api/sph.js"),t=require("../../../../stores/user.js"),r=require("../../../../enums/appEnums.js"),s=require("../../enums/index.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-input")+e.resolveComponent("u-icon"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js"))();const a=e.defineComponent({__name:"task_ai_clue",setup(a){const i=t.useUserStore(),{userTokens:o}=e.toRefs(i),l=e.ref(),c=e.ref(""),v=e.ref(150),p=e.ref([]),f=[10,20,30,40,50],d=e.ref(f[0]),m=e.ref(!1),j=e.computed((()=>p.value.every((e=>"success"===e.status)))),q=e.computed((()=>{var e;return(null==(e=i.getTokenByScene(r.TokensSceneEnum.SPH_AI_CLUE))?void 0:e.score)*d.value})),g=async u=>{if(u.trim()){if(!(o.value<=q.value||m.value))try{m.value=!0,p.value=Array.from({length:d.value},(()=>({title:"",content:"",status:"pending"})));const e=await n.getAiKeywords({keyword:c.value,targetCount:d.value,channelVersion:l.value});p.value=e.filter((e=>-1==e.indexOf("="))).map((e=>({content:e.trim(),status:"success"})))}catch(t){m.value=!1,e.index.showToast({title:t||"生成失败，请重试",icon:"none",duration:3e3})}}else e.index.$u.toast("请输入文案")},b=()=>{if(m.value){if(!j.value)return void e.index.$u.toast("正在生成中，请稍后再试");m.value=!1}p.value=[],m.value=!1,g(c.value)},h=()=>{j.value?(e.index.$emit("confirm",{type:s.ListenerTypeEnum.TASK_AI_CLUE,data:p.value.map((e=>e.content))}),p.value=[],e.index.navigateBack()):e.index.$u.toast("文案在生成中...")},_=()=>{p.value.length>0?(p.value=[],m.value=!1):e.index.navigateBack()};return e.onLoad((e=>{v.value=e.limit,l.value=e.type})),(n,t)=>e.e({a:e.p({title:"线索词AI生成","title-bold":!0,"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"},"custom-back":_}),b:!e.unref(m)},e.unref(m)?{i:e.f(e.unref(p),((n,t,r)=>e.e({a:"pending"===n.status},"pending"===n.status?{b:u._imports_0$31,c:e.t(t+1)}:{d:"01b2b096-1-"+r,e:e.o((e=>n.content=e),t),f:e.p({"placeholder-style":"color: #7C7E80; ",maxlength:"100",modelValue:n.content}),g:"01b2b096-2-"+r,h:e.p({name:"close",color:"#ffffff",size:"16"}),i:e.o((e=>(e=>{p.value.splice(e,1),0===p.value.length&&(m.value=!1)})(t)),t)},{j:t})))}:{c:500,d:e.unref(c),e:e.o((u=>e.isRef(c)?c.value=u.detail.value:null)),f:e.t(e.unref(c).length),g:e.t(500),h:e.f(f,((u,n,t)=>({a:e.t(u),b:u,c:e.unref(d)===u?1:"",d:e.o((e=>d.value=u),u)})))},{j:!e.unref(m)},e.unref(m)?{n:e.o(b),o:e.n(e.unref(j)?"bg-black":"bg-_h787878CC_"),p:e.o(h)}:{k:e.t(e.unref(q)),l:e.n(e.unref(c).length>0?"bg-black":"bg-_h787878CC_"),m:e.o((u=>g(e.unref(c))))})}}),i=e._export_sfc(a,[["__scopeId","data-v-01b2b096"]]);wx.createPage(i);
