"use strict";const e=require("../../../../common/vendor.js"),a=require("../../../../api/sph.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+s+t+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+r)();const s=()=>"../../components/task-card/task-card.js",t=()=>"../../components/clue-card/clue-card.js",r=()=>"../../components/task-edit/task-edit.js",u=e.defineComponent({__name:"task_detail",setup(s){const t=e.ref({}),r=e.ref(!0),u=e.ref(!1),i=e.ref([]),n=e.ref(),o=async(e,s)=>{var r;try{const{lists:u}=await a.getTaskClue({task_id:t.value.id,page_no:e,page_size:s});null==(r=n.value)||r.complete(u)}catch(u){console.log(u)}},l=async e=>{var a;await f(t.value.id),null==(a=n.value)||a.reload()},c=e.ref(!1),p=e.shallowRef(),d=async a=>{c.value=!0,await e.nextTick$1(),setTimeout((()=>{var e,s;null==(e=p.value)||e.open(),null==(s=p.value)||s.setFormData(a)}),100)},m=()=>{u.value?e.index.$u.route({url:"/ai_modules/sph/pages/index/index",type:"reLaunch"}):e.index.navigateBack()},v=()=>{clearTimeout(j),g(t.value.id)},f=async s=>{try{const r=await a.getTaskDetail({id:s});t.value=r,await e.nextTick$1()}finally{r.value=!1}};let j;const g=async e=>{await f(e);(1==t.value.status||0==t.value.status)&&(j=setTimeout((()=>{g(e)}),3e3))};return e.onLoad((({task_id:e,is_create:a})=>{u.value=1==a,clearTimeout(j),g(e)})),e.onHide((()=>{clearTimeout(j)})),e.onBeforeUnmount((()=>{clearTimeout(j)})),(a,s)=>e.e({a:!e.unref(r)},e.unref(r)?{}:{b:e.p({title:"获客详情",background:{backgroundColor:"#f6f6f6"},"custom-back":m}),c:e.o(l),d:e.o(d),e:e.p({item:e.unref(t)}),f:`/ai_modules/sph/pages/clue_list/clue_list?task_id=${e.unref(t).id}`,g:e.f(e.unref(i),((a,s,t)=>({a:"10131db5-3-"+t+",10131db5-2",b:e.p({item:a}),c:s}))),h:e.sr(n,"10131db5-2",{k:"pagingRef"}),i:e.o(o),j:e.o(v),k:e.o((a=>e.isRef(i)?i.value=a:null)),l:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(i)})},{m:e.unref(c)},e.unref(c)?{n:e.sr(p,"10131db5-5",{k:"taskEditRef"}),o:e.o((e=>c.value=!1)),p:e.o((e=>v()))}:{})}});wx.createPage(u);
