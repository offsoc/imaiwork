"use strict";const e=require("../../../../common/vendor.js"),t=e.defineComponent({__name:"calendar",props:{modelValue:null,multiSelect:{type:Boolean,default:!1},disabledDates:{default:()=>[]},disabledDateMethod:{type:Function,default:()=>!1},isToday:{type:Boolean,default:!0}},emits:["selectDate","update:modelValue"],setup(t,{expose:a,emit:l}){const u=t,n=e.computed((()=>new Set(u.disabledDates))),o=["日","一","二","三","四","五","六"],s=e.ref([]),d=e.ref((new Date).getFullYear()),i=e.ref((new Date).getMonth()+1),v=e.ref([]);e.watch((()=>u.modelValue),(e=>{let t=[];Array.isArray(e)?t=[...e]:"string"==typeof e&&e&&(t=[e]),JSON.stringify(v.value)!==JSON.stringify(t)&&(v.value=t)}),{deep:!0,immediate:!0});const r=e.computed((()=>{const e=[],t=s.value;for(let a=0;a<t.length;a+=7)e.push(t.slice(a,a+7));return e})),c=(e,t)=>{const a=new Date;a.setHours(0,0,0,0);const l=`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`,o=new Date(e,t-1,1).getDay(),d=new Date(e,t,0).getDate(),i=[],v=new Date(e,t-1,0),r=v.getDate(),c=v.getFullYear(),g=v.getMonth()+1;for(let s=o;s>0;s--){const e=r-s+1,t=`${c}-${g}-${e}`,a=new Date(c,g-1,e),l=u.disabledDateMethod(a);i.push({date:t,day:e,isCurrentMonth:!1,isToday:!1,isDisabled:n.value.has(t)||l})}for(let s=1;s<=d;s++){const a=`${e}-${t}-${s}`,o=a===l,d=new Date(e,t-1,s),v=u.disabledDateMethod(d);i.push({date:a,day:s,isCurrentMonth:!0,isToday:o,isDisabled:n.value.has(a)||v})}if(i.length<35){const a=new Date(e,t,1),l=a.getFullYear(),o=a.getMonth()+1;let s=1;for(;i.length<35;){const e=`${l}-${o}-${s}`,t=new Date(l,o-1,s),a=u.disabledDateMethod(t);i.push({date:e,day:s,isCurrentMonth:!1,isToday:!1,isDisabled:n.value.has(e)||a}),s++}}s.value=i},g=()=>{i.value--,i.value<1&&(i.value=12,d.value--),c(d.value,i.value)},D=()=>{i.value++,i.value>12&&(i.value=1,d.value++),c(d.value,i.value)};return a({locateToDate:e=>{const t=new Date(e);if(isNaN(t.getTime()))return;d.value=t.getFullYear(),i.value=t.getMonth()+1;const a=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`;if(u.multiSelect){-1===v.value.indexOf(a)&&v.value.push(a),l("update:modelValue",v.value)}else v.value=[a],l("update:modelValue",a);c(d.value,i.value),l("selectDate",u.multiSelect?v.value:a)},clearSelectedDates:()=>{v.value=[],u.multiSelect?l("update:modelValue",[]):l("update:modelValue",""),l("selectDate",u.multiSelect?v.value:"")},clearSingleSelectedDate:e=>{if(!u.multiSelect)return;const t=v.value.indexOf(e);t>-1&&(v.value.splice(t,1),l("update:modelValue",v.value),l("selectDate",v.value))}}),e.onMounted((()=>{const e=new Date;if(v.value.length>0){const e=new Date(v.value[0]);d.value=e.getFullYear(),i.value=e.getMonth()+1}else d.value=e.getFullYear(),i.value=e.getMonth()+1;if(0===v.value.length&&u.isToday){const t=`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`;v.value=[t],u.multiSelect?l("update:modelValue",[t]):l("update:modelValue",t)}c(d.value,i.value)})),(t,a)=>({a:e.t(e.unref(d)),b:e.t(e.unref(i)),c:e.o((e=>(e=>{const t=new Date;if(d.value=t.getFullYear(),i.value=t.getMonth()+1,e){const e=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`;u.multiSelect?(v.value.includes(e)||v.value.push(e),l("update:modelValue",v.value)):(v.value=[e],l("update:modelValue",e)),l("selectDate",u.multiSelect?v.value:e)}c(d.value,i.value)})(!0))),d:e.o(g),e:e.o(D),f:e.f(o,((t,a,l)=>({a:e.t(t),b:t}))),g:e.f(e.unref(r),((t,a,n)=>({a:e.f(t,((t,a,n)=>({a:e.t(t.day),b:t.isCurrentMonth?"":1,c:e.unref(v).includes(t.date)?1:"",d:t.isToday?1:"",e:t.isDisabled?1:"",f:a,g:e.o((e=>(e=>{if(e.isDisabled)return;const t=e.date;if(u.multiSelect){const e=v.value.indexOf(t);e>-1?v.value.splice(e,1):v.value.push(t),l("update:modelValue",v.value)}else v.value=[t],l("update:modelValue",t);if(!e.isCurrentMonth){const[e,a]=t.split("-").map(Number);d.value=e,i.value=a,c(d.value,i.value)}l("selectDate",u.multiSelect?v.value:t)})(t)),a)}))),b:a})))})}}),a=e._export_sfc(t,[["__scopeId","data-v-be8132ac"]]);wx.createComponent(a);
