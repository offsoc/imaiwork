"use strict";const e=require("../../../../common/vendor.js");if(!Array){(e.resolveComponent("u-input")+e.resolveComponent("u-icon")+e.resolveComponent("u-notice-bar"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-notice-bar/u-notice-bar.js"))();const t=e.defineComponent({__name:"bast-setting",props:{modelValue:null},emits:["update:modelValue"],setup(t,{expose:n,emit:i}){const o=t,r=e.computed({get:()=>o.modelValue,set(e){i("update:modelValue",e)}}),a=e.ref({});function u(e){const t=e=>{if(!e)return NaN;const[t,n]=(e||"").split(":").map(Number);return 60*t+n},n=e.map((e=>({start_time:e.start_time,end_time:e.end_time,s:t(e.start_time),e:t(e.end_time)}))).reduce(((e,t,n,i)=>{const o=(t,n)=>{e[t]||(e[t]={start_time:!1,end_time:!1}),e[t][n]=!0};if(null!=t.start_time&&""!==t.start_time||o(n,"start_time"),null!=t.end_time&&""!==t.end_time||o(n,"end_time"),isNaN(t.s)||isNaN(t.e))return e;if(t.s>=t.e&&(o(n,"start_time"),o(n,"end_time")),n>0){const e=i[n-1];!isNaN(e.e)&&t.s<e.e&&(o(n-1,"end_time"),o(n,"start_time"))}return e}),{});return{valid:0===Object.keys(n).length,errors:n}}return n({validateForm:()=>Object.keys(a.value).some((e=>a.value[e].start_time||a.value[e].end_time))}),(t,n)=>e.e({a:e.o((t=>e.unref(r).name=t)),b:e.p({"placeholder-style":"font-size: 24rpx;",placeholder:"请输入任务名称",maxlength:"30","custom-style":{fontSize:"26rpx"},modelValue:e.unref(r).name}),c:e.t(e.unref(r).accounts.length?`${e.unref(r).accounts.length}个账号`:"选择账号"),d:e.n(e.unref(r).accounts.length?"text-primary font-bold":"text-_h00000033_"),e:e.p({name:"arrow-right",size:"24",color:"#00000033"}),f:`/ai_modules/device/pages/account_choose/account_choose?account=${JSON.stringify(e.unref(r).accounts)}`,g:e.f([1,2,3,5,10],((t,n,i)=>({a:e.t(t),b:t,c:e.unref(r).publish_frep===t?1:"",d:e.o((n=>(t=>{t!=r.value.publish_frep&&(r.value.publish_frep=t,r.value.time_config=Array.from({length:t},((t,n)=>{const i=new Date;i.setHours(9,0,0);const o=new Date(i.getTime()+30*n*60*1e3),r=new Date(o.getTime()+18e5);return{start_time:e.index.$u.timeFormat(o,"hh:MM"),end_time:e.index.$u.timeFormat(r,"hh:MM")}})),a.value={})})(t)),t)}))),h:e.p({mode:"vertical",padding:"20rpx 0","border-radius":"8","font-size":"24rpx",autoplay:!1,"volume-icon":!1,list:["发布的间隔时间必须大于30分钟"]}),i:e.f(e.unref(r).time_config,((t,n,i)=>{var o,s;return{a:e.t(n+1),b:e.t(t.start_time||"开始时间"),c:e.n((null==(o=e.unref(a)[n])?void 0:o.start_time)?"text-_hFF3C26_ font-bold":t.start_time?"text-primary font-bold":"text-_h00000033_"),d:"e09c4f47-3-"+i,e:t.start_time,f:e.o((t=>((t,n)=>{const{value:i}=t.detail,o=r.value.time_config[n],s=new Date(`2000/01/01 ${(new Date).toLocaleTimeString()}`),m=new Date(`2000/01/01 ${i}`);if(m.getTime()<s.getTime())return void e.index.$u.toast("开始时间不能小于当前时间");o.start_time=i,m.setMinutes(m.getMinutes()+30),o.end_time=e.index.$u.timeFormat(m,"hh:MM");const{errors:l}=u(r.value.time_config);a.value=l})(t,n)),n),g:e.t(t.end_time||"结束时间"),h:e.n((null==(s=e.unref(a)[n])?void 0:s.end_time)?"text-_hFF3C26_ font-bold":t.end_time?"text-primary font-bold":"text-_h00000033_"),i:"e09c4f47-4-"+i,j:t.end_time,k:!t.end_time,l:e.o((t=>(t=>{r.value.time_config[t].start_time||e.index.$u.toast("请先选择开始时间")})(n)),n),m:e.o((t=>((t,n)=>{const{value:i}=t.detail,o=r.value.time_config[n];if(i<=o.start_time)return void e.index.$u.toast("结束时间不能小于开始时间");const s=new Date(`2000/01/01 ${o.start_time}`);if(new Date(`2000/01/01 ${i}`).getTime()-s.getTime()<18e5)return void e.index.$u.toast("结束时间不能小于开始时间30分钟");o.end_time=i;const{errors:m}=u(r.value.time_config);a.value=m})(t,n)),n),n:n}})),j:e.p({name:"arrow-right",size:"24",color:"#00000033"}),k:e.p({name:"arrow-right",size:"24",color:"#00000033"}),l:Object.keys(e.unref(a)).length>0},(Object.keys(e.unref(a)).length,{}))}}),n=e._export_sfc(t,[["__scopeId","data-v-e09c4f47"]]);wx.createComponent(n);
