"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../api/device.js"),a=require("../../../../utils/util.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+t+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+n+s+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+u+i)();const t=()=>"../../components/calendar-simple/calendar-simple.js",n=()=>"../../components/semi-circle-progress/semi-circle-progress.js",s=()=>"../../components/task-list/task-list.js",u=()=>"../../components/task-detail-pop/task-detail-pop.js",i=()=>"../../components/task-edit-name/task-edit-name.js",l=e.defineComponent({__name:"task_calendar",setup(t){const n=e.reactive({all:0,all_completed:0,completed:0,failure:0,interrupt:0,execution:0,waiting:0}),s=e.ref(e.index.$u.timeFormat(new Date,"yyyy-mm-dd")),u=e.ref(null),i=e.ref([]),l=e.shallowRef(null),o=e.shallowRef(null),c=e.ref(!1),p=e.ref(!1),m=e.computed((()=>0===n.all?0:Math.round((n.completed+n.failure)/n.all*100))),d=async(e,a)=>{var t;try{const{lists:t}=await r.getDeviceTaskCalendarList({page_no:e,page_size:a,day:s.value});u.value.complete(t)}catch(n){null==(t=u.value)||t.complete([])}},f=e=>{q()},v=async r=>{var a;c.value=!0,await e.nextTick$1(),null==(a=l.value)||a.getDetail(r)},g=async r=>{var a;p.value=!0,await e.nextTick$1(),null==(a=o.value)||a.setFormData(r)},j=e=>{i.value.forEach((r=>{r.id==e.id&&(r.name=e.name)}))},q=()=>{var e;(async()=>{const e=await r.getDeviceTaskCalendarStatistics({day:s.value});n.all=e.all,n.all_completed=e.all_completed,n.completed=e.completed,n.failure=e.failure,n.interrupt=e.interrupt,n.execution=e.execution,n.waiting=e.waiting})(),null==(e=u.value)||e.reload()};return e.onShow((()=>{q()})),(r,t)=>({a:e.p({title:"任务日历","title-bold":!0,"border-bottom":!1,background:{background:"transparent"}}),b:e.o(f),c:e.o((r=>e.isRef(s)?s.value=r:null)),d:e.p({modelValue:e.unref(s)}),e:e.t(e.unref(n).completed+e.unref(n).failure),f:e.t(e.unref(n).all),g:e.p({name:"plus",size:"24"}),h:e.t(e.unref(m)),i:e.p({progress:e.unref(m),size:120,strokeWidth:8}),j:e.t(e.unref(a.formatNumberToWanOrYi)(e.unref(n).all)),k:e.t(e.unref(a.formatNumberToWanOrYi)(e.unref(n).completed)),l:e.t(e.unref(a.formatNumberToWanOrYi)(e.unref(n).waiting)),m:e.t(e.unref(a.formatNumberToWanOrYi)(e.unref(n).failure)),n:e.t(e.unref(i).length),o:e.o(v),p:e.o(g),q:e.p({list:e.unref(i)}),r:e.sr(u,"384627c6-4",{k:"pagingRef"}),s:e.o(d),t:e.o((r=>e.isRef(i)?i.value=r:null)),v:e.p({fixed:!1,modelValue:e.unref(i)}),w:e.sr(l,"384627c6-7",{k:"taskDetailRef"}),x:e.o(q),y:e.o((r=>e.isRef(c)?c.value=r:null)),z:e.p({modelValue:e.unref(c)}),A:e.sr(o,"384627c6-8",{k:"taskEditNameRef"}),B:e.o(j),C:e.o((r=>e.isRef(p)?p.value=r:null)),D:e.p({modelValue:e.unref(p)})})}});wx.createPage(l);
