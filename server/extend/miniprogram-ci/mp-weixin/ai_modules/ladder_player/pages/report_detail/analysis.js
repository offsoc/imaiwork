"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../common/assets.js"),r=require("../../../../utils/util.js"),s=require("../../../../stores/app.js");if(require("../../../../stores/navigationBarTitle.js"),require("../../../../router/index.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../config/index.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-sticky")+e.resolveComponent("u-line"))()}Math||(i+(()=>"../../../../uni_modules/vk-uview-ui/components/u-sticky/u-sticky.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-line/u-line.js"))();const i=()=>"../../components/pie-chat/pie-chat.js",n=e.defineComponent({__name:"analysis",props:{detail:{type:Object,default:()=>({})}},setup(i){const n=i,o=s.useAppStore(),a=e.ref(0),u=e.ref(0),c=e.ref([{id:"sfl",name:"说服力",top:0,height:0,score:0,max:20,content:""},{id:"lld",name:"流利度",top:0,height:0,score:0,max:20,content:""},{id:"yybd",name:"语言表达",top:0,height:0,score:0,max:20,content:""},{id:"zqx",name:"准确性",top:0,height:0,score:0,max:20,content:""},{id:"yyzz",name:"语言组织能力",top:0,height:0,score:0,max:20,content:""}]),{proxy:l}=e.getCurrentInstance(),p=e.ref(0),d=e.ref(0),m=e.ref(!1),h=e=>{if(e>0){return`${Math.floor(e/60)}"${e%60}'`}return"0"},f=e=>e/20*5;return e.watch((()=>n.detail),(t=>{t&&(t.model_response.forEach(((e,t)=>{c.value[t].score=e.score,c.value[t].content=e.improvement_suggestions})),(async()=>{await e.nextTick$1();const t=await r.getRect(".column",!0,l);if(t){t.forEach(((e,t)=>{c.value[t].top=e.top,c.value[t].height=e.height}));const{screenHeight:r}=e.index.$u.sys();e.index.createIntersectionObserver(l,{observeAll:!0,thresholds:[1],initialRatio:.5}).relativeTo(".scroll-view",{top:-r/2}).observe(".column",(e=>{if(e&&1==e.intersectionRatio){const t=c.value.findIndex((t=>t.id===e.id));-1===t||m.value||(p.value=t)}}))}})())}),{immediate:!0}),e.watch((()=>o.getLadderConfig.directions),(e=>{c.value.forEach(((t,r)=>{e[r]&&(t.name=e[r])}))})),e.onMounted((()=>{a.value=190,u.value=e.index.$u.sys().statusBarHeight})),(r,s)=>({a:e.t(i.detail.total_score||0),b:e.p({indicator:e.unref(c)}),c:t._imports_0$41,d:e.t(h(i.detail.duration)),e:t._imports_1$25,f:e.t(i.detail.total_response),g:e.f(e.unref(c),((t,r,s)=>({a:e.t(t.name),b:r,c:e.unref(p)===r?1:"",d:e.o((t=>(async t=>{await e.nextTick$1(),p.value=t;const{top:r,height:s}=c.value[t];d.value=r-s/2-u.value+20,m.value=!0,setTimeout((()=>{m.value=!1}),50)})(r)),r)}))),h:e.p({"offset-top":e.unref(a),"bg-color":"transparent"}),i:e.f(e.unref(c),((r,s,i)=>({a:e.t(r.name),b:"7b944e84-2-"+i,c:e.t(r.score||0),d:e.f(5,((s,i,n)=>e.e({a:f(r.score)>=s},f(r.score)>=s?{b:t.StartFillIcon}:{c:t.StartIcon},{d:s}))),e:e.t(r.content),f:r.id,g:r.id}))),j:t._imports_2$10,k:e.unref(d)})}});wx.createComponent(n);
