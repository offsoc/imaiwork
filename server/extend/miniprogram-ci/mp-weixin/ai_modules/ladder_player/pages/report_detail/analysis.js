"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../common/assets.js"),r=require("../../../../utils/util.js");if(require("../../../../stores/navigationBarTitle.js"),require("../../../../router/index.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../config/index.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-sticky")+e.resolveComponent("u-line"))()}Math||(s+(()=>"../../../../uni_modules/vk-uview-ui/components/u-sticky/u-sticky.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-line/u-line.js"))();const s=()=>"../../components/pie-chat/pie-chat.js",i=e.defineComponent({__name:"analysis",props:{detail:{type:Object,default:()=>({})}},setup(s){const i=s,n=e.ref(0),o=e.ref(0),a=e.ref([{id:"sfl",name:"说服力",top:0,height:0,score:0,max:20,content:""},{id:"lld",name:"流利度",top:0,height:0,score:0,max:20,content:""},{id:"yybd",name:"语言表达",top:0,height:0,score:0,max:20,content:""},{id:"zqx",name:"准确性",top:0,height:0,score:0,max:20,content:""},{id:"yyzz",name:"语言组织能力",top:0,height:0,score:0,max:20,content:""}]),{proxy:u}=e.getCurrentInstance(),c=e.ref(0),l=e.ref(0),p=e.ref(!1),m=e=>{if(e>0){return`${Math.floor(e/60)}"${e%60}'`}return"0"},d=e=>e/20*5;return e.watch((()=>i.detail),(t=>{t&&(t.model_response.forEach(((e,t)=>{a.value[t].score=e.score,a.value[t].content=e.improvement_suggestions})),(async()=>{await e.nextTick$1();const t=await r.getRect(".column",!0,u);if(t){t.forEach(((e,t)=>{a.value[t].top=e.top,a.value[t].height=e.height}));const{screenHeight:r}=e.index.$u.sys();e.index.createIntersectionObserver(u,{observeAll:!0,thresholds:[1],initialRatio:.5}).relativeTo(".scroll-view",{top:-r/2}).observe(".column",(e=>{if(e&&1==e.intersectionRatio){const t=a.value.findIndex((t=>t.id===e.id));-1===t||p.value||(c.value=t)}}))}})())}),{immediate:!0}),e.onMounted((()=>{n.value=190,o.value=e.index.$u.sys().statusBarHeight})),(r,i)=>({a:e.t(s.detail.total_score||0),b:e.p({indicator:e.unref(a)}),c:t._imports_0$34,d:e.t(m(s.detail.duration)),e:t._imports_1$22,f:e.t(s.detail.total_response),g:e.f(e.unref(a),((t,r,s)=>({a:e.t(t.name),b:r,c:e.unref(c)===r?1:"",d:e.o((t=>(async t=>{await e.nextTick$1(),c.value=t;const{top:r,height:s}=a.value[t];l.value=r-s/2-o.value+20,p.value=!0,setTimeout((()=>{p.value=!1}),50)})(r)),r)}))),h:e.p({"offset-top":e.unref(n),"bg-color":"transparent"}),i:e.f(e.unref(a),((r,s,i)=>({a:e.t(r.name),b:"7b944e84-2-"+i,c:e.t(r.score||0),d:e.f(5,((s,i,n)=>e.e({a:d(r.score)>=s},d(r.score)>=s?{b:t.StartFillIcon}:{c:t.StartIcon},{d:s}))),e:e.t(r.content),f:r.id,g:r.id}))),j:t._imports_2$10,k:e.unref(l)})}});wx.createComponent(i);
