"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../api/ladder_player.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+n+t+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+r)();const n=()=>"./analysis.js",t=()=>"./chatlog.js",r=()=>"../../../../components/knb-bind/knb-bind.js",a=e.defineComponent({__name:"report_detail",setup(n){const t=e.reactive({id:""}),r=e.ref(null),a=e.ref(null),s=e.ref(1),u=[{label:"报告",id:1},{label:"对话",id:2}],o=e.ref(),l=()=>{var e;null==(e=o.value)||e.open()},d=async n=>{var r;e.index.showLoading({title:"训练中",mask:!0});try{await i.lpKnbTrain({ids:[t.id],indexid:n}),null==(r=o.value)||r.close(),e.index.hideLoading(),e.index.showToast({title:"训练成功",icon:"none",duration:3e3})}catch(a){e.index.hideLoading(),e.index.showToast({title:a||"绑定知识库失败",icon:"none",duration:3e3})}},c=async()=>{const e=await i.lpSceneDetail({id:r.value.scene_id});a.value=e},v=e.ref({}),p=e.getCurrentInstance(),b=()=>{p&&e.nextTick$1((()=>{const i=e.index.createSelectorQuery().in(p),n=`#tab-${s.value}`;i.select(n).boundingClientRect(),i.select("#tabs-container").boundingClientRect(),i.exec((e=>{if(e&&e[0]&&e[1]){const i=e[0],n=e[1];if(i&&n){const e=i.left-n.left,t=i.width;v.value={left:`${e}px`,width:`${t}px`}}else console.error("Could not get bounding client rect for tab or container",{activeTabData:i,containerData:n})}else console.error("Query execution failed or returned unexpected result:",e)}))}))};return e.onMounted((()=>{setTimeout((()=>{b()}),500)})),e.onLoad((n=>{t.id=n.id,(async()=>{e.index.showLoading({title:"加载中",mask:!0});try{const n=await i.lpAnalysisDetail({id:t.id});r.value=n,c(),e.index.hideLoading()}catch(n){e.index.hideLoading(),e.index.showToast({title:n||"获取报告详情失败",icon:"none",duration:2e3})}})()})),(i,n)=>e.e({a:r.value},r.value?e.e({b:e.s(v.value),c:e.f(u,((i,n,t)=>({a:e.t(i.label),b:i.id,c:"tab-"+i.id,d:s.value===i.id?1:"",e:e.o((e=>{return n=i.id,s.value=n,void b();var n}),i.id)}))),d:e.p({"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"}}),e:1===s.value},1===s.value?{f:e.p({detail:r.value})}:{},{g:2===s.value},2===s.value?{h:e.unref(t).id,i:e.p({id:e.unref(t).id,detail:r.value,"scene-detail":a.value})}:{},{j:e.o(l),k:e.p({type:"primary",shape:"circle","custom-style":{width:"500rpx"}})}):{},{l:e.sr(o,"1eb86244-4",{k:"knbBindRef"}),m:e.o(d)})}}),s=e._export_sfc(a,[["__scopeId","data-v-1eb86244"]]);wx.createPage(s);
