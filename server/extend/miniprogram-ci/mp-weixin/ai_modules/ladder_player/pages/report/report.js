"use strict";const e=require("../../../../common/vendor.js"),n=require("../../../../common/assets.js"),t=require("../../../../api/ladder_player.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js"))();const s=e.defineComponent({__name:"report",setup(s){const o=e.reactive({average_score:0,pending_scene_count:0,practice_scene_count:0,scene_count:0,total_scene_count:0,scene_logos:[]}),i=e.ref([]),a=e.shallowRef(),r=async(e,n)=>{var s,o;try{const{lists:o}=await t.lpAnalysisLists({page_no:e,page_size:n});null==(s=a.value)||s.complete(o)}catch(i){null==(o=a.value)||o.complete([])}},u=async n=>{e.index.showModal({title:"删除",content:"确定要删除吗？",success:async s=>{var o;if(s.confirm){e.index.showLoading({title:"删除中",mask:!0});try{await t.lpAnalysisDelete({id:n}),e.index.hideLoading(),e.index.showToast({title:"删除成功",icon:"none",duration:3e3}),null==(o=a.value)||o.reload()}catch(i){e.index.hideLoading(),e.index.showToast({title:i||"删除失败",icon:"none",duration:3e3})}}}})},c=e=>{if(e>0){return`${Math.floor(e/60)}"${e%60}'`}return"0"},l=n=>{const t=new Date(n);return e.index.$u.timeFormat(t,"yyyy-mm-dd hh:MM")};return e.onShow((()=>{(async()=>{const e=await t.lpAnalysisData();o.average_score=(null==e?void 0:e.average_score)||0,o.pending_scene_count=(null==e?void 0:e.pending_scene_count)||0,o.practice_scene_count=(null==e?void 0:e.practice_scene_count)||0,o.scene_count=(null==e?void 0:e.scene_count)||0,o.total_scene_count=(null==e?void 0:e.total_scene_count)||0,o.scene_logos=(null==e?void 0:e.scene_logos)||[]})()})),(s,d)=>e.e({a:e.p({"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"},title:"我的练习报告","title-bold":!0}),b:e.unref(o).pending_scene_count>0},e.unref(o).pending_scene_count>0?{c:e.f(e.unref(o).scene_logos,((e,n,t)=>({a:e,b:n}))),d:e.t(e.unref(o).pending_scene_count)}:{},{e:n._imports_0$22,f:e.t(e.unref(o).scene_count),g:e.t(e.unref(o).practice_scene_count),h:e.t(e.unref(o).scene_count),i:e.t(e.unref(o).average_score),j:e.f(e.unref(i),((s,o,i)=>e.e({a:e.t(s.scene_name),b:e.t(c(s.duration)),c:e.t(l(s.start_time)),d:2==s.status},2==s.status?{e:e.t(s.total_score||0),f:"254fd8ab-2-"+i+",254fd8ab-1",g:e.p({name:"arrow-right",color:"#ffffff"})}:3==s.status?{i:"254fd8ab-3-"+i+",254fd8ab-1",j:e.p({name:"reload",color:"#ffffff"}),k:e.o((n=>(async n=>{e.index.showModal({title:"重新分析",content:"确定要重新分析吗？",success:async s=>{var o;if(s.confirm){e.index.showLoading({title:"重新分析中",mask:!0});try{await t.lpAnalysisRetry({id:n}),e.index.hideLoading(),e.index.showToast({title:"重新分析成功",icon:"none",duration:3e3}),null==(o=a.value)||o.reload()}catch(i){e.index.hideLoading(),e.index.showToast({title:i||"重新分析失败",icon:"none",duration:3e3})}}}})})(s.id)),o)}:{l:n._imports_1$14},{h:3==s.status,m:2==s.status},2==s.status?{n:n._imports_3$7,o:e.o((n=>{return t=s.id,void e.index.showActionSheet({itemList:["删除"],success:e=>{0==e.tapIndex&&u(t)}});var t}),o)}:{},{p:o,q:e.o((n=>(n=>{2==n.status?e.index.$u.route({url:"/ai_modules/ladder_player/pages/report_detail/report_detail",params:{id:n.id}}):3==n.status?e.index.$u.toast("数据分析失败，不可查看"):e.index.$u.toast("数据分析中，请稍后再试")})(s)),o)}))),k:n._imports_2$5,l:e.p({text:"暂无场景"}),m:e.sr(a,"254fd8ab-1",{k:"pagingRef"}),n:e.o(r),o:e.o((n=>e.isRef(i)?i.value=n:null)),p:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(i)})})}}),o=e._export_sfc(s,[["__scopeId","data-v-254fd8ab"]]);wx.createPage(o);
