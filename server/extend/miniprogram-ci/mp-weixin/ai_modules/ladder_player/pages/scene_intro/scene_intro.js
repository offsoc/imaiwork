"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../common/assets.js"),i=require("../../../../api/ladder_player.js"),s=require("../../../../stores/user.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button")+e.resolveComponent("u-popup")+e.resolveComponent("recharge-popup"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js")+(()=>"../../../../components/recharge-popup/recharge-popup.js"))();const u=e.defineComponent({__name:"scene_intro",setup(u){const t=s.useUserStore(),{userTokens:n}=e.toRefs(t),o=e.reactive({id:""}),a=e.ref(null),d=e.ref(!1),l=e.shallowRef(),p=()=>{const{is_draft:r}=a.value;if(n.value<=0)return e.index.$u.toast("算力不足，请充值！"),void l.value.open();r?d.value=!0:e.index.$u.route({url:"/ai_modules/ladder_player/pages/chat/chat",params:{id:o.id}})},c=async()=>{try{e.index.showLoading({title:"生成中...",mask:!0}),await i.lpSceneChatEnd({scene_id:o.id,analysis_id:a.value.analysis_id}),e.index.showToast({icon:"none",title:"提交成功，3秒跳转到报告页面~",duration:3e3}),setTimeout((()=>{e.index.$u.route({url:"/ai_modules/ladder_player/pages/report/report",type:"redirect"})}),3e3)}catch(r){e.index.showToast({icon:"none",title:r||"生成失败",duration:5e3})}finally{e.index.hideLoading()}},m=()=>{e.index.$u.route({url:"/ai_modules/ladder_player/pages/chat/chat",params:{id:o.id,is_draft:!0,analysis_id:a.value.analysis_id}}),d.value=!1};return e.onLoad((e=>{o.id=e.id})),e.onShow((async()=>{await(async()=>{e.index.showLoading({title:"加载中...",mask:!0});try{const e=await i.lpSceneDetail({id:o.id});a.value=e}catch(r){e.index.showToast({title:r||"获取场景详情失败",icon:"none",duration:2e3})}finally{e.index.hideLoading()}})()})),(i,s)=>{var u,t,n,_,v,f,h;return e.e({a:e.unref(a)},e.unref(a)?e.e({b:e.p({"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"},title:"场景选择","title-bold":!0}),c:null==(u=e.unref(a))?void 0:u.logo,d:e.t(null==(t=e.unref(a))?void 0:t.name),e:e.t(null==(n=e.unref(a))?void 0:n.description),f:0!=(null==(_=e.unref(a))?void 0:_.user_id)},0!=(null==(v=e.unref(a))?void 0:v.user_id)?{g:r._imports_0$18}:{h:r._imports_1$14,i:e.f(e.unref(a).training_target,((r,i,s)=>({a:e.t(r),b:i}))),j:r._imports_0$19,k:e.f(e.unref(a).tips,((r,i,s)=>({a:e.t(r),b:i})))},{l:e.o(p),m:e.p({type:"primary","custom-style":{fontWeight:"bold",height:"92rpx"}}),n:0!=(null==(f=e.unref(a))?void 0:f.user_id)},0!=(null==(h=e.unref(a))?void 0:h.user_id)?{o:`/ai_modules/ladder_player/pages/scene_create/scene_create?id=${e.unref(o).id}`}:{}):{},{p:r._imports_3$6,q:e.o(c),r:e.o(m),s:e.o((r=>e.isRef(d)?d.value=r:null)),t:e.p({mode:"bottom","border-radius":"40",height:"35%",closeable:!0,modelValue:e.unref(d)}),v:e.sr(l,"3f97c1ab-3",{k:"rechargeRef"})})}}}),t=e._export_sfc(u,[["__scopeId","data-v-3f97c1ab"]]);wx.createPage(t);
