"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../common/assets.js"),n=require("../../../../api/digital_human.js"),u=require("../../../../stores/user.js"),r=require("../../../../enums/appEnums.js"),a=require("../../enums/index.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-input")+e.resolveComponent("u-icon"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js"))();const i=e.defineComponent({__name:"montage_ai_copywriter",setup(i){const s=u.useUserStore(),{userTokens:o}=e.toRefs(s),l=e.ref(""),c=e.ref(150),d=e.ref([]),m=[{id:1,name:"长",length:500},{id:2,name:"中",length:300},{id:3,name:"短",length:150}],p=e.computed((()=>m)),v=[1,3,5,10,20],f=e.ref(1),g=e.ref(p.value[0]),h=e.ref(!1),j=e.computed((()=>d.value.every((e=>"success"===e.status)))),q=e.computed((()=>{var e;return(null==(e=s.getTokenByScene(r.TokensSceneEnum.SHANJIAN_COPYWRITING_CREATE))?void 0:e.score)*f.value})),b=async t=>{if(t.trim()){if(!(o.value<=q.value)&&j.value)try{h.value=!0,d.value=Array.from({length:f.value},(()=>({title:"",content:"",status:"pending"})));const e=[];for(let r=0;r<f.value;r++)e.push(n.generateShanjianPrompt({keywords:t,number:g.value.length}));const u=await Promise.all(e);d.value=u.map((e=>({title:e.title,content:e.content,status:"success"})))}catch(u){h.value=!1,e.index.showToast({title:u||"生成失败，请重试",icon:"none",duration:3e3})}}else e.index.$u.toast("请输入文案")},_=()=>{j.value?(e.index.$emit("confirm",{type:a.ListenerTypeEnum.AI_COPYWRITER,data:{copywriterList:d.value.filter((e=>e.title)).map((e=>({title:e.title,content:e.content})))}}),d.value=[],e.index.navigateBack()):e.index.$u.toast("文案在生成中...")},k=()=>{d.value.length>0?(d.value=[],h.value=!1):e.index.navigateBack()};return e.onLoad((e=>{c.value=e.limit})),(n,u)=>e.e({a:e.p({title:"AI文案生成","title-bold":!0,"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"},"custom-back":k}),b:!e.unref(h)},e.unref(h)?{j:e.f(e.unref(d),((n,u,r)=>e.e({a:"pending"===n.status},"pending"===n.status?{b:t._imports_0$16,c:e.t(u+1)}:{d:"ad200fc8-1-"+r,e:e.o((e=>n.title=e),u),f:e.p({"placeholder-style":"color: #7C7E80; ",maxlength:"30",modelValue:n.title}),g:"ad200fc8-2-"+r,h:e.o((e=>n.content=e),u),i:e.p({type:"textarea","placeholder-style":"color: #7C7E80; ",maxlength:"500","auto-height":!1,modelValue:n.content}),j:e.t(n.content.length),k:"ad200fc8-3-"+r,l:e.p({name:"close",color:"#ffffff",size:"16"}),m:e.o((e=>(e=>{d.value.splice(e,1),0===d.value.length&&(h.value=!1)})(u)),u)},{n:u})))}:{c:500,d:e.unref(l),e:e.o((t=>e.isRef(l)?l.value=t.detail.value:null)),f:e.t(e.unref(l).length),g:e.t(500),h:e.f(e.unref(p),((t,n,u)=>{var r;return{a:e.t(t.name),b:t.id,c:(null==(r=e.unref(g))?void 0:r.id)===t.id?1:"",d:e.o((e=>g.value=t),t.id)}})),i:e.f(v,((t,n,u)=>({a:e.t(t),b:t,c:e.unref(f)===t?1:"",d:e.o((e=>f.value=t),t)})))},{k:!e.unref(h)},e.unref(h)?{o:e.o((t=>b(e.unref(l)))),p:e.n(e.unref(j)?"bg-black":"bg-_h787878CC_"),q:e.o(_)}:{l:e.t(e.unref(q)),m:e.n(e.unref(l).length>0?"bg-black":"bg-_h787878CC_"),n:e.o((t=>b(e.unref(l))))})}}),s=e._export_sfc(i,[["__scopeId","data-v-ad200fc8"]]);wx.createPage(s);
