"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../common/assets.js"),s=require("../../../../api/digital_human.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-search")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-search/u-search.js")+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+a)();const a=()=>"../../components/video-preview-v2/video-preview-v2.js",i=e.defineComponent({__name:"montage_works",setup(a){const i=e.ref([]),t=e.ref(0),n=e.ref(""),u=e.ref(!1),o=e.ref([]),l=e=>{var r;null==(r=c.value)||r.reload()},c=e.shallowRef(),d=async(e,r)=>{var a,i;try{const{lists:i,count:u}=await s.getShanjianTaskRecord({page_no:e,page_size:r,name:n.value});t.value=u,i.forEach((e=>{e.is_delete=!1})),null==(a=c.value)||a.complete(i)}catch(u){null==(i=c.value)||i.complete([])}},p=e.ref(!1),m=e.reactive({url:"",pic:""}),v=e=>o.value.some((r=>r.id==e.id)),f=()=>{u.value=!0},g=()=>{e.index.$u.route({url:"/ai_modules/digital_human/pages/montage_publish/montage_publish",params:{task_id:JSON.stringify(o.value.map((e=>e.id))),scene:2}}),u.value=!1,o.value=[]};return(a,t)=>e.e({a:e.p({"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"},title:"我的创作库","title-bold":!0}),b:e.o(l),c:e.o(l),d:e.o((r=>e.isRef(n)?n.value=r:null)),e:e.p({"bg-color":"#FFFFFF",height:"72","search-icon-color":"#ABB1B3","placeholder-color":"#ABB1B3","show-action":!1,modelValue:e.unref(n)}),f:e.f(e.unref(i),((a,i,t)=>e.e(e.unref(u)?{a:e.o((r=>(r=>{const{task:s}=r;s.every((e=>3!=e.status))?e.index.$u.toast("只有生成成功的视频才能去发布"):u.value&&(v(r)?o.value=o.value.filter((e=>e.id!=e.id)):o.value.push(r))})(a)),i)}:{},{b:e.t(a.name),c:e.t(a.create_time)},e.unref(u)?e.e({f:v(a)},v(a)?{g:r._imports_1$7}:{h:r._imports_2$3}):{d:r._imports_0$5,e:e.o((r=>(async r=>{e.index.showModal({title:"您真的要删除吗？",content:"删除后将无法找回，且该操作不可逆！",success:async a=>{var i;if(a.confirm){e.index.showLoading({title:"删除中...",mask:!0});try{return await s.deleteShanjianTaskRecord({id:r}),null==(i=c.value)||i.reload(),e.index.hideLoading(),void e.index.showToast({title:"删除成功",icon:"none",duration:3e3})}catch(t){e.index.hideLoading(),e.index.showToast({title:t||"删除失败",icon:"none",duration:3e3})}}}})})(a.id)),i)},{i:e.f(a.task,((s,a,i)=>e.e({a:s.pic,b:e.t(s.name),c:3==s.status},3==s.status?{d:r._imports_0$6,e:e.o((e=>(e=>{const{video_result_url:r,pic:s}=e;m.url=r,m.pic=s,p.value=!0})(s)),a)}:e.e({f:2==s.status},2==s.status?{g:r._imports_1$2,h:e.t(s.remark||"生成失败")}:{}),{i:e.t(s.create_time),j:a}))),j:i}))),g:e.unref(u),h:!e.unref(u),i:e.sr(c,"67cd05c4-2",{k:"pagingRef"}),j:e.o(d),k:e.o((r=>e.isRef(i)?i.value=r:null)),l:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(i)}),m:!e.unref(u)},e.unref(u)?{o:e.t(e.unref(o).length),p:e.n(e.unref(o).length>0?"bg-black":"bg-_h787878CC_"),q:e.o((e=>{u.value=!1,o.value=[]})),r:e.n(e.unref(o).length>0?"bg-black":"bg-_h787878CC_"),s:e.o(g)}:{n:e.o(f)},{t:e.unref(u)?1:"",v:e.o((e=>p.value=!1)),w:e.o((r=>e.isRef(p)?p.value=r:null)),x:e.p({"video-url":e.unref(m).url,poster:e.unref(m).pic,show:e.unref(p)})})}}),t=e._export_sfc(i,[["__scopeId","data-v-67cd05c4"]]);wx.createPage(t);
