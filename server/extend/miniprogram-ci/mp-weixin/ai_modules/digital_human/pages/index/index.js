"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../common/assets.js"),o=require("../../../../api/digital_human.js"),t=require("../../../../hooks/usePaging.js"),n=require("../../enums/index.js"),a=require("../../../../utils/cache.js"),s=require("../../../../config/index.js"),u=require("../../../../utils/file.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button")+e.resolveComponent("u-icon")+e.resolveComponent("empty"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+r+(()=>"../../../../components/empty/empty.js")+l+d)();const r=()=>"../../components/video-item/video-item.js",l=()=>"../../components/video-preview/video-preview.js",d=()=>"../../components/choose-model/choose-model.js",m=e.defineComponent({__name:"index",setup(r){const l=e.ref([{icon:i.ImageMenu1,title:"形象克隆",key:"anchor_clone",url:`/ai_modules/digital_human/pages/video_upload/video_upload?type=${n.ModeTypeEnum.ANCHOR}`},{icon:i.ImageMenu2,title:"声音克隆",key:"tone_clone",url:"/ai_modules/digital_human/pages/tone_clone/tone_clone"},{icon:i.ImageMenu3,title:"我的模特",key:"model_manage",url:"/ai_modules/digital_human/pages/model_manage/model_manage"},{icon:i.ImageMenu4,title:"音色管理",key:"tone_manage",url:"/ai_modules/digital_human/pages/tone_manage/tone_manage"}]),{pager:d,getLists:m,resetPage:c}=t.usePaging({fetchFun:o.digitalHumanLists,params:{page_size:10}}),p=e.ref(!1),_="dh_example",v=()=>{p.value=!1,e.index.$u.route({url:"/ai_modules/digital_human/pages/video_create/video_create"})},g=async i=>{e.index.showLoading({title:"重试中...",mask:!0});try{await o.retryVideo({video_id:i}),c(),e.index.hideLoading(),e.index.showToast({title:"重试成功",icon:"none",duration:3e3})}catch(t){e.index.hideLoading(),e.index.showToast({title:t||"重试失败",icon:"none",duration:3e3})}},h=async i=>{e.index.showLoading({title:"删除中...",mask:!0});try{await o.deleteDigitalHuman({id:i}),c(),e.index.hideLoading(),e.index.showToast({title:"删除成功",icon:"none",duration:3e3})}catch(t){e.index.hideLoading(),e.index.showToast({title:t||"删除失败",icon:"none",duration:3e3})}},f=e.ref(""),j=e.ref(!1),q=e=>{f.value=e,j.value=!0},x=e.ref(!1),y=i=>{x.value=!1,e.index.$u.route({url:`/ai_modules/digital_human/pages/video_upload/video_upload?type=${n.ModeTypeEnum.ANCHOR}&model_version=${i}`})},w=e.ref(),k=async()=>{w.value=setTimeout((()=>{d.lists.some((e=>1!=e.status&&2!=e.status))?(m(),k()):clearTimeout(w.value)}),2e3)};return e.onShow((async()=>{await m(),k(),a.cache.get(_)||(a.cache.set(_,!0),p.value=!0)})),e.onHide((()=>{clearTimeout(w.value)})),e.onUnload((()=>{clearTimeout(w.value)})),(o,t)=>e.e({a:e.p({"is-fixed":!1,"border-bottom":!1,background:{background:"transparent"}}),b:i._imports_0$3,c:i._imports_0$4,d:e.p({type:"primary",shape:"circle","custom-style":{width:"460rpx",height:"104rpx"}}),e:e.f(e.unref(l),((i,o,t)=>({a:i.icon,b:o,c:e.o((o=>(i=>{const{key:o}=i;"anchor_clone"!==o?e.index.navigateTo({url:i.url}):x.value=!0})(i)),o)}))),f:e.p({name:"arrow-right",color:"#A7A7A7",size:"28"}),g:e.unref(d).lists.length},e.unref(d).lists.length?{h:e.f(e.unref(d).lists,((i,o,t)=>({a:e.o(g,o),b:e.o(q,o),c:e.o(h,o),d:e.o((i=>e.unref(u.saveVideoToPhotosAlbum)(i)),o),e:"5ce523d3-3-"+t,f:e.p({"show-more":!0,item:{id:i.id,name:i.name,pic:i.pic,video_url:i.result_url,clip_video_url:i.clip_result_url,status:i.status,remark:i.remark,model_version:i.model_version,automatic_clip:i.automatic_clip,clip_status:i.clip_status}}),g:o})))}:{},{i:e.o((e=>j.value=!1)),j:e.o((i=>e.isRef(j)?j.value=i:null)),k:e.p({title:"视频预览","video-url":e.unref(f),show:e.unref(j)}),l:e.o((e=>p.value=!1)),m:e.o(v),n:e.o((i=>e.isRef(p)?p.value=i:null)),o:e.p({title:"新手教程","confirm-btn-text":"立即定制","video-url":`${e.unref(s.config).baseUrl}static/videos/dh_example1.mp4`,show:e.unref(p)}),p:e.o(y),q:e.o((i=>e.isRef(x)?x.value=i:null)),r:e.p({show:e.unref(x)})})}}),c=e._export_sfc(m,[["__scopeId","data-v-5ce523d3"]]);wx.createPage(c);
