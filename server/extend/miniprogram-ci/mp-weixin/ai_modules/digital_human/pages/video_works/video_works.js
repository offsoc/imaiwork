"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../common/assets.js"),i=require("../../../../api/digital_human.js"),u=require("../../../../utils/file.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-search")+e.resolveComponent("empty")+e.resolveComponent("z-paging")+e.resolveComponent("u-input")+e.resolveComponent("u-popup"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-search/u-search.js")+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+o+(()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const o=()=>"../../components/video-preview-v2/video-preview-v2.js",s=e.defineComponent({__name:"video_works",setup(o){const s=e.ref([]),a=e.ref(0),r=e.ref(""),n=e=>{var t;null==(t=l.value)||t.reload()},l=e.shallowRef(),c=async(e,t)=>{var u,o;try{const{lists:o,count:s}=await i.digitalHumanLists({page_no:e,page_size:t,name:r.value});a.value=s,o.forEach((e=>{e.is_delete=!1})),null==(u=l.value)||u.complete(o)}catch(s){null==(o=l.value)||o.complete([])}},p=e.ref(-1),d=e.ref(""),m=e.ref(!1),v=async()=>{if(d.value){m.value=!1,e.index.showLoading({title:"修改中...",mask:!0});try{await i.updateDigitalHuman({id:s.value[p.value].id,name:d.value}),e.index.hideLoading(),e.index.showToast({title:"修改成功",icon:"none",duration:3e3}),s.value[p.value].name=d.value}catch(t){e.index.showToast({title:t||"修改失败",icon:"none",duration:3e3})}}else e.index.$u.toast("请输入名称")};e.ref("");const f=e.ref(!1),_=e.ref(1),h=e.reactive({url:"",pic:""}),g=(e,t)=>{const{result_url:i,clip_result_url:u,automatic_clip:o}=e;h.url=1==t?i:1==o?u:i,h.pic=e.pic,f.value=!0,t&&(_.value=t)};return(o,a)=>({a:e.p({"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"},title:"我的创作库","title-bold":!0}),b:e.o(n),c:e.o(n),d:e.o((t=>e.isRef(r)?r.value=t:null)),e:e.p({"bg-color":"#FFFFFF",height:"72","search-icon-color":"#ABB1B3","placeholder-color":"#ABB1B3","show-action":!1,modelValue:e.unref(r)}),f:e.f(e.unref(s),((o,a,r)=>e.e({a:e.t(o.name),b:e.o((e=>(e=>{p.value=e,d.value=s.value[e].name,m.value=!0})(a)),a),c:e.o((t=>(async t=>{e.index.showModal({title:"您真的要删除吗？",content:"删除后将无法找回，且该操作不可逆！",success:async u=>{var o;if(u.confirm){e.index.showLoading({title:"删除中...",mask:!0});try{return await i.deleteDigitalHuman({id:t}),null==(o=l.value)||o.reload(),e.index.hideLoading(),void e.index.showToast({title:"删除成功",icon:"none",duration:3e3})}catch(s){e.index.hideLoading(),e.index.showToast({title:s||"删除失败",icon:"none",duration:3e3})}}}})})(o.id)),a),d:o.pic,e:1==o.automatic_clip},(o.automatic_clip,{}),{f:1==o.status},1==o.status?e.e({g:e.o((e=>g(o)),a),h:1==o.automatic_clip},1==o.automatic_clip?e.e({i:1==o.clip_status||2==o.clip_status},(1==o.clip_status||o.clip_status,{}),{j:3==o.clip_status},(o.clip_status,{}),{k:4==o.clip_status},(o.clip_status,{})):{}):e.e({l:2==o.status},2==o.status?{m:t._imports_0$7,n:e.t(o.remark||"生成失败")}:{}),{o:e.t(o.create_time),p:1==o.status},1==o.status?e.e({q:e.o((e=>g(o,1)),a),r:e.o((t=>e.unref(u.saveVideoToPhotosAlbum)(o.result_url)),a),s:1==o.automatic_clip},1==o.automatic_clip?{t:e.o((t=>e.unref(u.saveVideoToPhotosAlbum)(o.clip_result_url)),a)}:{}):{},{v:a}))),g:t._imports_0$6,h:e.sr(l,"edf27ba4-2",{k:"pagingRef"}),i:e.o(c),j:e.o((t=>e.isRef(s)?s.value=t:null)),k:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(s)}),l:e.o((e=>f.value=!1)),m:e.o((t=>e.isRef(f)?f.value=t:null)),n:e.p({"video-url":e.unref(h).url,poster:e.unref(h).pic,show:e.unref(f)}),o:e.o((t=>e.isRef(d)?d.value=t:null)),p:e.p({placeholder:"请输入名称",maxlength:"30",clearable:!0,"placeholder-style":"color: #0000004d; font-size: 26rpx;",modelValue:e.unref(d)}),q:e.o((e=>m.value=!1)),r:e.o(v),s:e.o((t=>e.isRef(m)?m.value=t:null)),t:e.p({mode:"center",width:"90%","border-radius":20,modelValue:e.unref(m)})})}}),a=e._export_sfc(s,[["__scopeId","data-v-edf27ba4"]]);wx.createPage(a);
