"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../api/digital_human.js"),t=require("../../../../utils/file.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button")+e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+o+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+r)();const o=()=>"../../components/video-item/video-item.js",r=()=>"../../components/video-preview/video-preview.js",n=e.defineComponent({__name:"video_works",setup(o){const r=e.ref([]),n=e.ref(0),s=e.shallowRef(),u=async(e,t)=>{var o,r;try{const{lists:r,count:u}=await i.digitalHumanLists({page_no:e,page_size:t});n.value=u,r.forEach((e=>{e.is_delete=!1})),null==(o=s.value)||o.complete(r)}catch(u){null==(r=s.value)||r.complete(!1)}},a=e.ref(!1),l=e.computed((()=>r.value.filter((e=>e.is_delete)).map((e=>e.id)))),d=()=>{a.value=!a.value},c=e.ref(""),p=e.ref(!1),m=e=>{c.value=e,p.value=!0},v=async t=>{var o;e.index.showLoading({title:"删除中...",mask:!0});try{return await i.deleteDigitalHuman({id:l.value.length>0?l.value:t}),null==(o=s.value)||o.reload(),e.index.hideLoading(),void e.index.showToast({title:"删除成功",icon:"none",duration:2e3})}catch(n){e.index.hideLoading(),e.index.showToast({title:n||"删除失败",icon:"none",duration:2e3})}a.value=!1,r.value.forEach((e=>{e.is_delete=!1}))},f=async t=>{var o;e.index.showLoading({title:"重试中...",mask:!0});try{await i.retryVideo({video_id:t}),null==(o=s.value)||o.reload(),e.index.hideLoading(),e.index.showToast({title:"重试成功",icon:"none",duration:3e3})}catch(r){e.index.hideLoading(),e.index.showToast({title:r||"重试失败",icon:"none",duration:3e3})}};return(i,o)=>e.e({a:e.p({"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"},title:"我的作品","title-bold":!0}),b:e.t(e.unref(n)),c:e.unref(r).length>0},e.unref(r).length>0?{d:e.t(e.unref(a)?"取消":"管理"),e:e.o(d),f:e.p({type:"primary","custom-style":{height:"42rpx",fontSize:"24rpx",padding:"0 12rpx"}})}:{},{g:e.f(e.unref(r),((i,o,r)=>e.e(e.unref(a)?e.e({a:i.is_delete},i.is_delete?{b:"5a7c3870-3-"+r+",5a7c3870-2",c:e.p({name:"checkmark",color:"#fff",size:20})}:{},{d:i.is_delete?1:"",e:e.o((e=>i.is_delete=!i.is_delete),o)}):{},{f:e.o(f,o),g:e.o(v,o),h:e.o(m,o),i:e.o((i=>e.unref(t.saveVideoToPhotosAlbum)(i)),o),j:"5a7c3870-4-"+r+",5a7c3870-2",k:e.p({item:{id:i.id,name:i.name,pic:i.pic,status:i.status,remark:i.remark,video_url:i.result_url,clip_video_url:i.clip_result_url,model_version:i.model_version,automatic_clip:i.automatic_clip,clip_status:i.clip_status},"show-more":!e.unref(a)}),l:o}))),h:e.unref(a),i:e.sr(s,"5a7c3870-2",{k:"pagingRef"}),j:e.o(u),k:e.o((i=>e.isRef(r)?r.value=i:null)),l:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(r)}),m:e.unref(a)},e.unref(a)?{n:e.t(e.unref(l).length),o:e.o(v),p:e.p({type:"error",disabled:0===e.unref(l).length,"custom-style":{height:"64rpx",fontSize:"24rpx",padding:"0 24rpx",borderRadius:"16rpx"}})}:{},{q:e.o((e=>p.value=!1)),r:e.o((i=>e.isRef(p)?p.value=i:null)),s:e.p({title:"视频预览","video-url":e.unref(c),show:e.unref(p)})})}}),s=e._export_sfc(n,[["__scopeId","data-v-5a7c3870"]]);wx.createPage(s);
