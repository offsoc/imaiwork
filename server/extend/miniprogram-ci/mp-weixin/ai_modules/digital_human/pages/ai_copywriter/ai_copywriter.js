"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../utils/util.js"),r=require("../../../../api/digital_human.js"),i=require("../../../../stores/user.js"),n=require("../../config/copywriter.js"),u=require("../../enums/index.js"),s=require("../../../../enums/appEnums.js");if(require("../../../../stores/navigationBarTitle.js"),require("../../../../router/index.js"),require("../../../../utils/cache.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-line")+e.resolveComponent("u-input")+e.resolveComponent("u-button"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-line/u-line.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const o=e.defineComponent({__name:"ai_copywriter",setup(o){const a=i.useUserStore(),{userTokens:l}=e.toRefs(a),p=()=>{c.value=n.aiTemplateCopywriter[0%n.aiTemplateCopywriter.length]},c=e.ref(""),d=e.ref(150),m=e.ref([]),h=[{id:1,name:"短",length:150},{id:2,name:"中",length:300},{id:3,name:"长",length:1e3}],f=e.computed((()=>h)),v=e.computed((()=>{var e;const t=null==(e=a.getTokenByScene(s.TokensSceneEnum.HUMAN_COPYWRITING_CREATE))?void 0:e.score;return parseFloat(t)})),g=e.ref(f.value[0]),x=e.ref(0),{proxy:j}=e.getCurrentInstance(),q=async()=>{await e.nextTick$1(),t.getRect(".content-box",!1,j).then((e=>{x.value=e.height}))};return e.onLoad((e=>{d.value=e.limit})),(t,i)=>({a:e.o(p),b:e.p({color:"#e5e5e5"}),c:e.o((t=>e.isRef(c)?c.value=t:null)),d:e.p({type:"textarea",focus:!0,height:"160",placeholder:"请输入或粘贴您的文案 ...","placeholder-style":"color: #00000033; font-size: 26rpx;",maxlength:500,modelValue:e.unref(c)}),e:e.t(e.unref(c).length),f:e.t(500),g:e.f(e.unref(f),((t,r,i)=>{var n;return{a:e.t(t.name),b:t.id,c:e.n((null==(n=e.unref(g))?void 0:n.id)===t.id?"bg-primary-light-9 text-primary":"bg-_hF3F3F3_ text-_h323232_"),d:e.o((e=>g.value=t),t.id)}})),h:e.f(e.unref(m),((t,r,i)=>({a:e.t(t),b:e.o((r=>{return i=t,e.index.$emit("confirm",{type:u.ListenerTypeEnum.AI_COPYWRITER,data:{content:i}}),m.value=[],void e.index.navigateBack();var i}),t.id),c:"63f3eb15-2-"+i,d:t.id}))),i:e.p({type:"primary",size:"mini"}),j:e.unref(x),k:e.t(e.unref(v)),l:e.o((t=>(async t=>{if(t.trim())if(l.value<v.value)e.index.$u.toast("算力不足，请充值！");else{e.index.showLoading({title:"生成中...",mask:!0});try{const{content:i}=await r.generatePrompt({keywords:t,number:g.value.length});m.value.push(i),e.index.hideLoading()}catch(i){e.index.hideLoading(),e.index.showToast({title:i||"生成失败，请重试",icon:"none",duration:3e3})}finally{setTimeout((()=>{q()}),500)}}else e.index.$u.toast("请输入文案")})(e.unref(c)))),m:e.p({type:"primary",shape:"circle","custom-style":{height:"90rpx",boxShadow:"0px 6px 12px 0px rgba(0, 101, 251, 0.20)",fontSize:"26rpx"}})})}}),a=e._export_sfc(o,[["__scopeId","data-v-63f3eb15"]]);wx.createPage(a);
