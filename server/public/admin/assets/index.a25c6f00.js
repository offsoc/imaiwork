import{X as z,a4 as N,J as T,K as M,w as j,L as O,I as q,M as G}from"./element-plus.e618cff3.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang.2d767870.js";import{g as J,u as K}from"./update.184c8bb1.js";import{u as P}from"./useLockFn.b1b43a93.js";import{u as Q}from"./usePaging.74092dd4.js";import{u as R,f as x}from"./index.976d8a45.js";import{d as W,b as X,Y,i as Z,aq as uu,o as a,c,Q as o,H as s,I as C,u as i,G as E,a as e,O as V,M as r,L as v,v as eu}from"./@vue.fa3e2f74.js";import"./@vueuse.57305db2.js";import"./@element-plus.8edeb311.js";import"./lodash-es.72862127.js";import"./dayjs.33f9e030.js";import"./@vscode.6c9cb547.js";import"./katex.234fd046.js";import"./@popperjs.36402333.js";import"./@ctrl.b082b0c1.js";import"./async-validator.fb49d0f5.js";import"./normalize-wheel-es.8aeb3683.js";import"./lodash.0bb3a698.js";import"./axios.e67d1c3e.js";import"./vue-router.24cf2b30.js";import"./pinia.d2a105b3.js";import"./vue-demi.b3a9cad9.js";import"./css-color-function.9d260b6b.js";import"./color.4290e22e.js";import"./clone.10c3af82.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.35afef70.js";import"./ms.a9ae1d6d.js";import"./nprogress.d9597aae.js";import"./vue-clipboard3.6701dfcc.js";import"./clipboard.a993786e.js";import"./sortablejs.fb59ed0f.js";import"./echarts.8535e5a6.js";import"./zrender.3eba8991.js";import"./tslib.60310f1a.js";import"./highlight.js.4f6161a5.js";import"./@highlightjs.fc60ff58.js";const tu=e("div",{class:"py-[3px]"},"\u6E29\u99A8\u63D0\u793A\uFF1A",-1),su=e("div",{class:"py-[3px]"},[r(" 1.\u7248\u672C\u66F4\u65B0\u9700\u8981\u9010\u4E2A\u7248\u672C\u66F4\u65B0\uFF0C "),e("span",{class:"text-[#f56c6c]"}," \u66F4\u65B0\u524D\u8BF7\u5907\u4EFD\u597D\u7CFB\u7EDF\u548C\u6570\u636E\u5E93\uFF0C\u66F4\u65B0\u6210\u529F\u540E\u9700\u8981\u5F3A\u5236\u5237\u65B0\u7AD9\u70B9\uFF1B ")],-1),iu=e("div",{class:"py-[3px]"},"2.\u7CFB\u7EDF\u6CA1\u6709\u505A\u4E8C\u6B21\u5F00\u53D1\uFF0C\u53EF\u4EE5\u76F4\u63A5\u9009\u62E9\u5728\u7EBF\u66F4\u65B0\u529F\u80FD\uFF1B",-1),ou=e("div",{class:"py-[3px]"}," 3.\u7CFB\u7EDF\u5DF2\u505A\u4E8C\u6B21\u5F00\u53D1\uFF0C\u8FDB\u884C\u4E86\u529F\u80FD\u4FEE\u6539\uFF0C\u8BF7\u8C28\u614E\u9009\u62E9\u5728\u7EBF\u66F4\u65B0\u529F\u80FD\uFF0C\u63A8\u8350\u4EE5\u66F4\u65B0\u5305\u7684\u5F62\u5F0F\u624B\u52A8\u66F4\u65B0\uFF1B ",-1),nu=e("div",{class:"py-[3px]"}," 4.\u68C0\u67E5\u670D\u52A1\u5668\u6587\u4EF6\u6743\u9650\u662F\u5426\u90FD\u662F777\uFF0C\u5982\u679C\u6743\u9650\u4E0D\u662F777\uFF0C\u8BF7\u624B\u52A8\u8BBE\u7F6E\u6743\u9650\u4E3A777\uFF1B\u5426\u5219\u4F1A\u5BFC\u81F4\u66F4\u65B0\u5931\u8D25\uFF1B ",-1),lu={class:"flex items-center"},au={class:"mr-2"},ru={key:0,class:""},Fu={key:1,class:""},du={class:"whitespace-pre-line"},pu={class:"operation flex flex-wrap"},cu={class:"flex mt-4 justify-end"},mu={class:"flex flex-col justify-between items-center"},_u={class:"flex flex-col pb-8"},Eu={class:"mt-2.5"},Bu={class:"mt-2.5"},fu={key:0,style:{"text-align":"center"}},Cu={key:1,style:{"text-align":"center"}},vu=e("div",null,"\u4E8C\u6B21\u5F00\u53D1\u540E\u8BF7\u8C28\u614E\u4F7F\u7528\u4E00\u952E\u66F4\u65B0\u529F\u80FD\uFF01",-1),Du=e("div",null,"\u4E8C\u6B21\u5F00\u53D1\u540E\u4E00\u952E\u66F4\u65B0\u5BFC\u81F4\u7684\u7CFB\u7EDF\u95EE\u9898\uFF0C\u5B98\u65B9\u65E0\u6CD5\u5904\u7406\uFF0C\u8BF7\u505A\u597D\u7CFB\u7EDF\u5907\u4EFD\uFF01",-1),bu=[vu,Du],yu={class:"pt-10",style:{height:"200px","text-align":"center"}},gu={"element-loading-text":"\u7CFB\u7EDF\u66F4\u65B0\u4E2D\uFF0C\u66F4\u65B0\u5B8C\u6BD5\u540E\u4F1A\u81EA\u884C\u5237\u65B0\u9875\u9762 \u5207\u52FF\u5173\u95ED\u7A97\u53E3\u6216\u5237\u65B0\u9875\u9762"},pe=W({__name:"index",setup(xu){const m=X(()=>{var l;return((l=R().config)==null?void 0:l.version)||{}}),u=Y({version:"",outerVisible:!1,loading:!1,isSecondaryDev:!1,threeVisible:!1,innerVisible:!1}),{pager:F,getLists:D}=Q({fetchFun:J}),h=l=>{const n=F.lists.findIndex(p=>p.version===l);if(F.lists.findIndex(p=>p.version==m.value.version_number)-n!==1){x.msgWarning("\u5F53\u524D\u7248\u672C\u843D\u540E\u51E0\u4E2A\u7248\u672C\uFF0C\u53EA\u53EF\u4EE5\u5411\u4E0A\u4F9D\u6B21\u66F4\u65B0\u7248\u672C");return}u.outerVisible=!0,u.version=l},A=l=>{window.open(`https://update.imai.work/update/version/${l}.zip`,"_blank")},k=()=>{u.innerVisible=!1,u.threeVisible=!0,S()},w=()=>{u.outerVisible=!1,u.isSecondaryDev=!1,u.innerVisible=!0},U=()=>{u.outerVisible=!1,u.isSecondaryDev=!0,u.innerVisible=!0},{lockFn:S}=P(async()=>{try{u.loading=!0,await K({version:u.version}),window.location.reload()}catch(l){x.msgError(l||"\u66F4\u65B0\u5931\u8D25!")}u.threeVisible=!1,u.innerVisible=!1,u.outerVisible=!1});return Z(()=>{D()}),(l,n)=>{const b=z,p=T,_=M,y=N,d=j,I=O,L=H,B=q,$=uu("perms"),g=G;return a(),c("div",null,[o(p,{class:"!border-none",shadow:"never"},{default:s(()=>[o(b,{class:"text-xxl",type:"warning",closable:!1,"show-icon":""},{title:s(()=>[tu,su,iu,ou,nu]),_:1})]),_:1}),C((a(),E(p,{class:"!border-none mt-4",shadow:"never"},{default:s(()=>[e("div",null,[o(I,{data:i(F).lists,size:"large",border:""},{default:s(()=>[o(_,{prop:"date",label:"\u53D1\u5E03\u65E5\u671F","min-width":"180px"}),o(_,{label:"\u7248\u672C\u53F7","min-width":"160px"},{default:s(({row:t,$index:f})=>[e("div",lu,[e("div",au,V(t.name),1),f==0&&i(F).page==1?(a(),E(y,{key:0,size:"small",type:"primary"},{default:s(()=>[r(" \u6700\u65B0 ")]),_:1})):i(m).version_number==t.version?(a(),E(y,{key:1,size:"small",type:"warning"},{default:s(()=>[r(" \u5F53\u524D ")]),_:1})):v("",!0)]),i(m).version_number==t.version?(a(),c("div",ru,"\u60A8\u7684\u7CFB\u7EDF\u5F53\u524D\u5904\u4E8E\u6B64\u7248\u672C")):i(m).version_number<t.version?(a(),c("div",Fu,"\u7CFB\u7EDF\u53EF\u66F4\u65B0\u81F3\u6B64\u7248\u672C")):v("",!0)]),_:1}),o(_,{prop:"",label:"\u7248\u672C\u5185\u5BB9","min-width":"220px"},{default:s(({row:t})=>[e("div",du,V(t.content),1)]),_:1}),o(_,{label:"\u64CD\u4F5C",width:"160px",fixed:"right"},{default:s(({row:t})=>[e("div",pu,[C((a(),c("div",null,[t.version>i(m).version_number?(a(),E(d,{key:0,type:"primary",link:"",onClick:f=>h(t.version)},{default:s(()=>[r(" \u4E00\u952E\u66F4\u65B0 ")]),_:2},1032,["onClick"])):v("",!0)])),[[$,["setting.system.upgrade/upgrade"]]]),o(d,{type:"primary",link:"",onClick:f=>A(t.version)},{default:s(()=>[r(" \u4E0B\u8F7D\u66F4\u65B0\u5305 ")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),e("div",cu,[o(L,{modelValue:i(F),"onUpdate:modelValue":n[0]||(n[0]=t=>eu(F)?F.value=t:null),onChange:i(D)},null,8,["modelValue","onChange"])])]),_:1})),[[g,i(F).loading]]),o(B,{modelValue:i(u).outerVisible,"onUpdate:modelValue":n[2]||(n[2]=t=>i(u).outerVisible=t),width:"400px",title:"\u7CFB\u7EDF\u662F\u5426\u8FDB\u884C\u4E8C\u6B21\u5F00\u53D1",center:""},{default:s(()=>[e("div",mu,[e("div",_u,[e("div",null,[o(d,{class:"w-full",type:"primary",onClick:w},{default:s(()=>[r(" \u672A\u505A\u4E8C\u6B21\u5F00\u53D1\uFF0C\u76F4\u63A5\u66F4\u65B0 ")]),_:1})]),e("div",Eu,[o(d,{class:"w-full",onClick:U},{default:s(()=>[r("\u5DF2\u505A\u4E8C\u6B21\u5F00\u53D1")]),_:1})]),e("div",Bu,[o(d,{class:"w-full",onClick:n[1]||(n[1]=t=>i(u).outerVisible=!1)},{default:s(()=>[r(" \u53D6\u6D88\u66F4\u65B0 ")]),_:1})])])])]),_:1},8,["modelValue"]),o(B,{width:"400px",modelValue:i(u).innerVisible,"onUpdate:modelValue":n[4]||(n[4]=t=>i(u).innerVisible=t),"append-to-body":"",center:""},{footer:s(()=>[e("div",null,[o(d,{type:"primary",onClick:k},{default:s(()=>[r(" \u786E\u5B9A\u66F4\u65B0 ")]),_:1}),o(d,{onClick:n[3]||(n[3]=t=>i(u).innerVisible=!1)},{default:s(()=>[r(" \u53D6\u6D88\u66F4\u65B0 ")]),_:1})])]),default:s(()=>[e("div",null,[i(u).isSecondaryDev==!1?(a(),c("div",fu," \u4E00\u952E\u66F4\u65B0\u5BFC\u81F4\u7684\u7CFB\u7EDF\u95EE\u9898\uFF0C\u8BF7\u505A\u597D\u7CFB\u7EDF\u5907\u4EFD\uFF01 ")):(a(),c("div",Cu,bu))])]),_:1},8,["modelValue"]),o(B,{width:"300px",modelValue:i(u).threeVisible,"onUpdate:modelValue":n[5]||(n[5]=t=>i(u).threeVisible=t),"append-to-body":"",title:"\u66F4\u65B0\u4E2D",center:"","close-on-click-modal":!1,"close-on-press-escape":!1},{default:s(()=>[e("div",yu,[C(e("div",gu,null,512),[[g,i(u).loading]])])]),_:1},8,["modelValue"])])}}});export{pe as default};
