import{_ as x}from"./index.3d067310.js";import{_ as R,x as S,y as T,J as z,w as M}from"./element-plus.e618cff3.js";import{u as q}from"./vue-router.24cf2b30.js";import{b as K,c as L,e as $}from"./index.9e14bb2b.js";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang.2159a3b7.js";import H from"./index.5a2d7e68.js";import P from"./index.3ebc5ff7.js";import U from"./index.8ace2e4f.js";import I from"./index.a155c725.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_lang.4c86c6b0.js";import{u as J}from"./useLockFn.b1b43a93.js";import{s as O,K as k}from"./index.976d8a45.js";import{M as Q}from"./enums.fbb460c1.js";import{d as Y,r as _,s as n,b as W,Y as X,i as Z,o as i,c as y,Q as s,H as p,a as g,u as r,v,P as ee,a5 as te,G as c,K as oe,M as ae,L as re}from"./@vue.fa3e2f74.js";import"./@vueuse.57305db2.js";import"./@element-plus.8edeb311.js";import"./lodash-es.72862127.js";import"./dayjs.33f9e030.js";import"./@vscode.6c9cb547.js";import"./katex.234fd046.js";import"./@popperjs.36402333.js";import"./@ctrl.b082b0c1.js";import"./async-validator.fb49d0f5.js";import"./normalize-wheel-es.8aeb3683.js";import"./index.vue_vue_type_script_setup_true_lang.ae4ea884.js";import"./cate.8ac08a42.js";import"./agent-logo.3894d09b.js";import"./lodash.0bb3a698.js";import"./axios.e67d1c3e.js";import"./pinia.d2a105b3.js";import"./vue-demi.b3a9cad9.js";import"./css-color-function.9d260b6b.js";import"./color.4290e22e.js";import"./clone.10c3af82.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.35afef70.js";import"./ms.a9ae1d6d.js";import"./nprogress.d9597aae.js";import"./vue-clipboard3.6701dfcc.js";import"./clipboard.a993786e.js";import"./sortablejs.fb59ed0f.js";import"./echarts.8535e5a6.js";import"./zrender.3eba8991.js";import"./tslib.60310f1a.js";import"./highlight.js.4f6161a5.js";import"./@highlightjs.fc60ff58.js";import"./lists.44bc4aa8.js";import"./menu-edit.22ff7d1c.js";import"./index.6c1a317f.js";import"./index.vue_vue_type_script_setup_true_lang.a07e65a2.js";import"./index.vue_vue_type_script_setup_true_lang.2d767870.js";import"./keywords-edit.vue_vue_type_script_setup_true_lang.4cd257ad.js";import"./add-content.c8eccb78.js";import"./workflow-edit.vue_vue_type_script_setup_true_lang.aa6e2757.js";import"./usePaging.74092dd4.js";const ne={class:"flex justify-between items-center"},ut=Y({__name:"edit",setup(me){const E=q(),l=_(E.query.id),m=_("base"),d=_([{label:"\u4EBA\u8BBE",name:"base",component:n(G)},{label:"\u77E5\u8BC6\u5E93",name:"knb",component:n(H)},{label:"\u62DF\u4EBA\u5316",name:"humanize",component:n(P)},{label:"\u754C\u9762\u914D\u7F6E",name:"interface",component:n(U)},{label:"\u6280\u80FD",name:"skill",component:n(I)},{label:"\u8C03\u7528\u8BBE\u7F6E",name:"call",component:n(j)}]),B=W(()=>{var t;return(t=d.value.find(o=>o.name===m.value))==null?void 0:t.component}),e=X({id:l.value,cate_id:"",kb_type:1,kb_ids:"",icons:"",image:"",bg_image:"",name:"",intro:"",model_id:"",model_sub_id:"",roles_prompt:"",search_mode:"similar",search_tokens:3e3,search_similar:.4,ranking_status:0,ranking_score:.5,context_num:3,is_public:0,is_enable:1,optimize_ask:0,optimize_m_id:"",optimize_s_id:"",search_empty_type:1,search_empty_text:"",top_p:.5,temperature:1,presence_penalty:.1,frequency_penalty:2,top_logprobs:10,logprobs:0,welcome_introducer:"",copyright:"",menus:[],flow_status:0,flow_config:{workflow_id:"",bot_id:"",app_id:"",api_token:""},threshold:.5,mode_type:Q.CUSTOM}),b=_(),w=async()=>{if(!!l.value)try{const t=await K({id:l.value});O(t,e),e.kb_type==k.RAG&&t.kb_ids.length>0&&(e.kb_ids=t.kb_ids[0]),e.presence_penalty=Number(e.presence_penalty),e.frequency_penalty=Number(e.frequency_penalty),e.top_p=Number(e.top_p),e.temperature=Number(e.temperature)}catch(t){console.error("\u83B7\u53D6\u667A\u80FD\u4F53\u8BE6\u60C5\u5931\u8D25:",t)}},h=async()=>{var o,u;await((u=(o=b.value)==null?void 0:o.validate)==null?void 0:u.call(o));const t={...e,kb_ids:e.kb_type==k.RAG&&typeof e.kb_ids=="string"?[e.kb_ids]:e.kb_ids};e.id?await L(t):await $(t)},{lockFn:C,isLock:D}=J(()=>h());return Z(()=>{w()}),(t,o)=>{const u=R,f=z,F=S,V=T,A=M,N=x;return i(),y("div",null,[s(f,{class:"!border-none",shadow:"never"},{default:p(()=>[g("div",ne,[s(u,{onBack:o[0]||(o[0]=a=>t.$router.back())})])]),_:1}),s(f,{class:"!border-none mt-4",shadow:"never"},{default:p(()=>[s(V,{modelValue:r(m),"onUpdate:modelValue":o[1]||(o[1]=a=>v(m)?m.value=a:null)},{default:p(()=>[(i(!0),y(ee,null,te(r(d),a=>(i(),c(F,{key:a.name,label:a.label,name:a.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),g("div",null,[(i(),c(oe(r(B)),{ref_key:"formRef",ref:b,modelValue:r(e),"onUpdate:modelValue":o[2]||(o[2]=a=>v(e)?e.value=a:null),"agent-id":r(l)},null,8,["modelValue","agent-id"]))])]),_:1}),["skill","publish","call"].includes(r(m))?re("",!0):(i(),c(N,{key:0},{default:p(()=>[s(A,{type:"primary",loading:r(D),onClick:r(C)},{default:p(()=>[ae("\u4FDD\u5B58")]),_:1},8,["loading","onClick"])]),_:1}))])}}});export{ut as default};
