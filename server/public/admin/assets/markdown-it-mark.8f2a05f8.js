function u(l){function m(n,t){const s=n.pos,i=n.src.charCodeAt(s);if(t||i!==61)return!1;const o=n.scanDelims(n.pos,!0);let e=o.length;const c=String.fromCharCode(i);if(e<2)return!1;if(e%2){const r=n.push("text","",0);r.content=c,e--}for(let r=0;r<e;r+=2){const k=n.push("text","",0);k.content=c+c,!(!o.can_open&&!o.can_close)&&n.delimiters.push({marker:i,length:0,jump:r/2,token:n.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return n.pos+=o.length,!0}function p(n,t){const s=[],i=t.length;for(let o=0;o<i;o++){const e=t[o];if(e.marker!==61||e.end===-1)continue;const c=t[e.end],r=n.tokens[e.token];r.type="mark_open",r.tag="mark",r.nesting=1,r.markup="==",r.content="";const k=n.tokens[c.token];k.type="mark_close",k.tag="mark",k.nesting=-1,k.markup="==",k.content="",n.tokens[c.token-1].type==="text"&&n.tokens[c.token-1].content==="="&&s.push(c.token-1)}for(;s.length;){const o=s.pop();let e=o+1;for(;e<n.tokens.length&&n.tokens[e].type==="mark_close";)e++;if(e--,o!==e){const c=n.tokens[e];n.tokens[e]=n.tokens[o],n.tokens[o]=c}}}l.inline.ruler.before("emphasis","mark",m),l.inline.ruler2.before("emphasis","mark",function(n){let t;const s=n.tokens_meta,i=(n.tokens_meta||[]).length;for(p(n,n.delimiters),t=0;t<i;t++)s[t]&&s[t].delimiters&&p(n,s[t].delimiters)})}export{u as i};
