import{R as z,S as L,V as H,a as $,t as M,C as G,B as O,W as J,w as P,E as Q}from"./element-plus.b694a2f4.js";import{s as Y,_ as q,f as E}from"./index.f10dd425.js";import{g as K,s as X}from"./index.54f4714e.js";import{u as Z}from"./useLockFn.b1b43a93.js";import{d as ee}from"./dayjs.0a835391.js";import{d as ue,Y as te,r as A,i as le,o as f,c as v,a as e,Q as l,H as i,u as n,M as c,L as h,v as oe,P as ne,a5 as ae,J as se}from"./@vue.fa3e2f74.js";const ie={class:"h-full flex flex-col py-6"},re={class:"grow min-h-0"},de={class:"px-[30px] flex flex-col gap-4"},_e={class:"flex flex-col"},ce=e("div",null,"\u77ED\u65F6\u95F4\u5185\u591A\u6761\u4FE1\u606F\u56DE\u590D\u7B56\u7565",-1),me={class:"mt-2"},pe={class:"flex items-center gap-2"},Fe=e("span",null,"\u5408\u5E76\u56DE\u590D",-1),Ee={class:"flex items-center gap-2"},fe=e("span",null," \u53EA\u56DE\u590D\u6700\u540E\u4E00\u6761 ",-1),ve={class:"flex flex-col"},Be=e("div",null,"\u8BED\u97F3\u6D88\u606F\u56DE\u590D\u7B56\u7565\uFF08\u76EE\u524D\u53EA\u652F\u6301\u5FAE\u4FE1\uFF09",-1),De={class:"mt-2"},ge={class:"flex flex-col"},xe=e("div",null,"\u667A\u80FD\u4F53\u88AB\u8C03\u7528\u65F6\uFF0C\u63A5\u6536\u5230\u56FE\u7247\u8FDB\u884C\u56FA\u5B9A\u56DE\u590D",-1),Ae={class:"mt-2"},he={key:0,class:"mt-2"},ke={class:"flex flex-col"},be=e("div",{class:""},"\u667A\u80FD\u4F53\u88AB\u8C03\u7528\u65F6\uFF0C\u63A5\u6536\u5230\u67D0\u4E9B\u4FE1\u606F\u540E\u505C\u6B62\u5BF9\u8BE5\u6761\u4FE1\u606F\u8FDB\u884C\u56DE\u590D",-1),ye={class:"mt-2"},Ve={key:0,class:"mt-2"},we={class:"flex flex-col"},Ce=e("div",null,[e("div",null,"\u5206\u6BB5\u56DE\u590D")],-1),Ue={class:"flex items-center justify-between gap-2"},Te=e("div",{class:"text-xs"}," \u7528\u6237\u5728\u804A\u5929\u754C\u9762\u770B\u5230\u7684 AI \u56DE\u590D \u4E0D\u662F\u4E00\u6B21\u6027\u7684\u5927\u6BB5\u8BDD\uFF0C\u800C\u662F\u6309\u6BB5\u843D\u9010\u6761\u5C55\u793A ",-1),Se={class:"flex flex-col"},Ie=e("div",null,"\u63A5\u7BA1\u65F6\u95F4(AI\u56DE\u590D)",-1),We={class:"flex items-center justify-between gap-2"},je=e("div",{class:"text-xs text-error"},[c(" \u7528\u6237\u53EF\u4EE5\u8BBE\u7F6E AI \u5728\u6307\u5B9A\u7684\u65F6\u95F4\u6BB5\u5185\u63A5\u7BA1\u5BF9\u8BDD\uFF0C\u8D85\u51FA\u63A5\u7BA1\u65F6\u95F4\u7684\u6D88\u606F\uFF0C\u5219\u4F1A\u81EA\u52A8\u53D1\u9001\u7528\u6237\u9884\u5148\u8BBE\u5B9A\u7684\u56FA\u5B9A\u56DE\u590D\u3002"),e("span",{class:"font-bold"},"\uFF08\u4E00\u5C0F\u65F6\u5185\u4EC5\u5269\u751F\u6548\u4E00\u6B21\uFF09")],-1),Ne={key:0,class:"mt-2"},Re={class:"flex flex-wrap items-center gap-3 mt-3"},ze=e("div",{class:""},"\u81F3",-1),Le=["onClick"],He={class:"mt-3"},$e=e("div",{class:"mb-3"},"\u56FA\u5B9A\u56DE\u590D\u5185\u5BB9",-1),Me={class:"flex items-center justify-center mt-4"},Ke=ue({__name:"index",props:{agentId:{}},emits:["close"],setup(w,{emit:Ge}){const k=w,t=te({multiple_type:0,number_chat_rounds:3,voice_enable:0,image_enable:0,image_reply:"",stop_enable:0,stop_keywords:"",paragraph_enable:0,working_enable:0,non_working_reply:"",working_time:{1:[],2:[],3:[],4:[],5:[],6:[],7:[]}}),F=A([]),_=A([]),b=A([]),C=()=>{var a,u;_.value.length===0?_.value.push({start_time:"09:00",end_time:"09:15"}):_.value.push({start_time:((a=_.value.at(-1))==null?void 0:a.end_time)||"09:00",end_time:ee(((u=_.value.at(-1))==null?void 0:u.end_time)||"09:00","HH:mm").add(15,"minute").format("HH:mm")})},U=a=>{_.value.splice(a,1)},T=async()=>{if(t.image_enable==1&&!t.image_reply){E.msgError("\u8BF7\u8F93\u5165\u56FE\u7247\u6D88\u606F\u56DE\u590D\u5185\u5BB9");return}if(t.stop_enable==1&&!t.stop_keywords){E.msgError("\u8BF7\u8F93\u5165\u505C\u6B62\u56DE\u590D\u5173\u952E\u8BCD");return}if(t.working_enable==1){if(F.value.length===0){E.msgWarning("\u8BF7\u9009\u62E9\u63A5\u7BA1\u65E5\u671F");return}if(_.value.length===0){E.msgWarning("\u8BF7\u8BBE\u7F6E\u63A5\u7BA1\u65F6\u95F4");return}const{valid:a,indexes:u,errorType:s}=j(_.value);if(!a){b.value=u,E.msgWarning(s||"");return}if(!t.non_working_reply){E.msgWarning("\u8BF7\u8F93\u5165\u5728\u63A5\u7BA1\u65F6\u95F4\u5916\u7684\u81EA\u52A8\u56DE\u590D\u5185\u5BB9");return}const r=_.value.map(d=>`${d.start_time}-${d.end_time}`);Object.keys(t.working_time).forEach(d=>{F.value.includes(Number(d))?t.working_time[d]=r:t.working_time[d]=[]})}await X({...t,robot_id:k.agentId})},{lockFn:S,isLock:I}=Z(T),W=async()=>{try{const a=await K({id:k.agentId});a&&Y(a,t),a.working_time&&Object.keys(a.working_time).forEach(u=>{a.working_time[u].length>0&&(F.value.push(Number(u)),_.value=a.working_time[u].map(s=>({start_time:s.split("-")[0],end_time:s.split("-")[1]})))})}catch(a){console.error("\u83B7\u53D6\u56DE\u590D\u7B56\u7565\u5931\u8D25:",a)}};function j(a){const u=s=>{const[r,d]=(s||"").split(":").map(Number);return r*60+d};for(let s=0;s<a.length;s++){const r=a[s];if(!r||r.start_time==null||r.start_time===""||r.end_time==null||r.end_time==="")return{valid:!1,errorType:"\u9009\u62E9\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",indexes:[s]};const d=u(r.start_time),g=u(r.end_time);if(d>=g)return{valid:!1,errorType:"\u9009\u62E9\u65F6\u95F4\u51B2\u7A81",indexes:[s]};if(s>0){const m=a[s-1],B=u(m.end_time);if(d<B)return{valid:!1,errorType:"\u9009\u62E9\u65F6\u95F4\u51B2\u7A81",indexes:[s-1,s]}}}return{valid:!0,indexes:[]}}return le(()=>{W()}),(a,u)=>{const s=z,r=q,d=$,g=L,m=M,B=G,p=O,N=J,y=H,V=P,R=Q;return f(),v("div",ie,[e("div",re,[l(R,null,{default:i(()=>[e("div",de,[e("div",_e,[ce,e("div",me,[l(g,{modelValue:n(t).multiple_type,"onUpdate:modelValue":u[0]||(u[0]=o=>n(t).multiple_type=o)},{default:i(()=>[l(s,{value:0},{default:i(()=>[c("\u9010\u6761\u56DE\u590D")]),_:1}),l(s,{value:1},{default:i(()=>[l(d,{content:"\u5F53\u7528\u6237\u5728\u4E24\u5206\u949F\u4EE5\u5916\uFF0C\u6CA1\u6709\u7EE7\u7EED\u53D1\u9001\u6D88\u606F\uFF0C\u5219\u5C06\u591A\u6761\u4FE1\u606F\u5408\u5E76\u56DE\u590D"},{default:i(()=>[e("div",pe,[Fe,l(r,{name:"el-icon-WarningFilled",color:"#9E9E9E"})])]),_:1})]),_:1}),l(s,{value:2},{default:i(()=>[l(d,{content:"\u5F53\u7528\u6237\u5728\u4E24\u5206\u949F\u4EE5\u5916\uFF0C\u6CA1\u6709\u7EE7\u7EED\u53D1\u9001\u6D88\u606F\uFF0C\u53EA\u56DE\u590D\u6700\u540E\u4E00\u6761\u4FE1\u606F"},{default:i(()=>[e("div",Ee,[fe,l(r,{name:"el-icon-WarningFilled",color:"#9E9E9E"})])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),e("div",ve,[Be,e("div",De,[l(m,{modelValue:n(t).voice_enable,"onUpdate:modelValue":u[1]||(u[1]=o=>n(t).voice_enable=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])])]),e("div",ge,[xe,e("div",Ae,[l(m,{modelValue:n(t).image_enable,"onUpdate:modelValue":u[2]||(u[2]=o=>n(t).image_enable=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),n(t).image_enable==1?(f(),v("div",he,[l(B,{modelValue:n(t).image_reply,"onUpdate:modelValue":u[3]||(u[3]=o=>n(t).image_reply=o),type:"textarea",placeholder:"\u70B9\u51FB\u8F93\u5165\u60A8\u8981\u56DE\u590D\u7684\u5185\u5BB9",resize:"none",rows:4},null,8,["modelValue"])])):h("",!0)]),e("div",ke,[be,e("div",ye,[l(m,{modelValue:n(t).stop_enable,"onUpdate:modelValue":u[4]||(u[4]=o=>n(t).stop_enable=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),n(t).stop_enable==1?(f(),v("div",Ve,[l(B,{modelValue:n(t).stop_keywords,"onUpdate:modelValue":u[5]||(u[5]=o=>n(t).stop_keywords=o),type:"textarea",placeholder:"\u70B9\u51FB\u8F93\u5165\u60A8\u8981\u68C0\u6D4B\u7684\u8BCD\u8BED",resize:"none",rows:4},null,8,["modelValue"])])):h("",!0)]),e("div",we,[Ce,e("div",Ue,[Te,l(m,{modelValue:n(t).paragraph_enable,"onUpdate:modelValue":u[6]||(u[6]=o=>n(t).paragraph_enable=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])])]),e("div",Se,[Ie,e("div",We,[je,l(m,{modelValue:n(t).working_enable,"onUpdate:modelValue":u[7]||(u[7]=o=>n(t).working_enable=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),n(t).working_enable==1?(f(),v("div",Ne,[l(N,{modelValue:n(F),"onUpdate:modelValue":u[8]||(u[8]=o=>oe(F)?F.value=o:null)},{default:i(()=>[l(p,{value:1},{default:i(()=>[c("\u5468\u4E00")]),_:1}),l(p,{value:2},{default:i(()=>[c("\u5468\u4E8C")]),_:1}),l(p,{value:3},{default:i(()=>[c("\u5468\u4E09")]),_:1}),l(p,{value:4},{default:i(()=>[c("\u5468\u56DB")]),_:1}),l(p,{value:5},{default:i(()=>[c("\u5468\u4E94")]),_:1}),l(p,{value:6},{default:i(()=>[c("\u5468\u516D")]),_:1}),l(p,{value:7},{default:i(()=>[c("\u5468\u65E5")]),_:1})]),_:1},8,["modelValue"]),e("div",Re,[(f(!0),v(ne,null,ae(n(_),(o,x)=>(f(),v("div",{key:x},[e("div",{class:se(["flex items-center gap-2",{"!border-error":n(b).includes(x)}])},[l(y,{modelValue:o.start_time,"onUpdate:modelValue":D=>o.start_time=D,class:"!w-[100px]","prefix-icon":"",start:"00:00",step:"00:15",end:"23:59","max-time":o.end_time},null,8,["modelValue","onUpdate:modelValue","max-time"]),ze,l(y,{modelValue:o.end_time,"onUpdate:modelValue":D=>o.end_time=D,class:"!w-[100px]","prefix-icon":"",start:"00:00",step:"00:15",end:"23:59","min-time":o.start_time},null,8,["modelValue","onUpdate:modelValue","min-time"]),e("div",{class:"w-4 h-4 flex-shrink-0 bg-app-bg-1 rounded-full flex items-center justify-center cursor-pointer",onClick:D=>U(x)},[l(r,{name:"el-icon-Close",color:"#ffffff",size:10})],8,Le)],2)]))),128)),l(V,{type:"primary",size:"small",onClick:C},{default:i(()=>[c("\u65B0\u589E\u65F6\u95F4\u6BB5")]),_:1})]),e("div",He,[$e,l(B,{modelValue:n(t).non_working_reply,"onUpdate:modelValue":u[9]||(u[9]=o=>n(t).non_working_reply=o),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5728\u63A5\u7BA1\u65F6\u95F4\u5916\u7684\u81EA\u52A8\u56DE\u590D\u5185\u5BB9",resize:"none",rows:5},null,8,["modelValue"])])])):h("",!0)])])]),_:1})]),e("div",Me,[l(V,{type:"primary",class:"w-[318px] !rounded-full !h-[50px]",loading:n(I),onClick:n(S)},{default:i(()=>[c(" \u4FDD\u5B58 ")]),_:1},8,["loading","onClick"])])])}}});export{Ke as _};
