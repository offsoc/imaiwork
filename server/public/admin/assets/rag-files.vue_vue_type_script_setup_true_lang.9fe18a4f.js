import{a4 as L,G as K,H as G,D as q,C as z,w as M,F as H,J as O,K as j,L as J,M as Q}from"./element-plus.e618cff3.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang.2d767870.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang.b9a0ee41.js";import{u as X}from"./vue-router.24cf2b30.js";import{d as Z,Y as ee,r as C,i as te,aq as ae,o as s,c as le,a as w,Q as e,H as a,u as l,a6 as oe,M as u,I as y,G as r,O as ne,L as h,v as ue,P as se,n as ie}from"./@vue.fa3e2f74.js";import{d as re,g as de}from"./files.293da36a.js";import{o as me,f as pe}from"./index.03099c94.js";import{u as _e}from"./usePaging.74092dd4.js";import{_ as fe}from"./rag-data.vue_vue_type_script_setup_true_lang.3dc1f1a8.js";const ce={class:"mb-4"},Ee={class:"flex justify-end mt-4"},Be=Z({__name:"rag-files",setup(Fe){const B=X(),n=ee({id:"",status:"",name:"",start_time:"",end_time:""}),{pager:p,getLists:d,resetPage:ve,resetParams:T}=_e({fetchFun:de,params:n}),F=C([]),V=m=>{F.value=m},b=async m=>{await pe.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F"),await re({id:m}),d()},k=C(null),v=C(!1),x=async m=>{v.value=!0,await ie(),k.value.open({id:m})};return te(async()=>{n.id=B.query.id,d()}),(m,o)=>{const f=K,R=G,c=q,P=z,I=W,_=M,$=H,D=O,i=j,E=L,A=J,N=Y,S=ae("perms"),U=Q;return s(),le(se,null,[w("div",null,[e(D,{class:"!border-none",shadow:"never"},{default:a(()=>[e($,{ref:"formRef",class:"mb-[-16px]",model:l(n),inline:!0},{default:a(()=>[e(c,{label:"\u72B6\u6001"},{default:a(()=>[e(R,{class:"!w-[120px]",modelValue:l(n).status,"onUpdate:modelValue":o[0]||(o[0]=t=>l(n).status=t),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001","empty-values":[null,void 0],clearable:"",onChange:o[1]||(o[1]=t=>l(d)())},{default:a(()=>[e(f,{label:"\u5168\u90E8",value:""}),e(f,{label:"\u89E3\u6790\u4E2D",value:"PARSING"}),e(f,{label:"\u89E3\u6790\u6210\u529F",value:"PARSE_SUCCESS"}),e(f,{label:"\u89E3\u6790\u5931\u8D25",value:"PARSE_FAILED"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"\u6587\u4EF6\u540D\u79F0"},{default:a(()=>[e(P,{class:"w-[280px]",modelValue:l(n).name,"onUpdate:modelValue":o[2]||(o[2]=t=>l(n).name=t),placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0",clearable:"",onKeyup:o[3]||(o[3]=oe(t=>l(d)(),["enter"]))},null,8,["modelValue"])]),_:1}),e(c,{label:"\u5BFC\u5165\u65F6\u95F4"},{default:a(()=>[e(I,{startTime:l(n).start_time,"onUpdate:startTime":o[4]||(o[4]=t=>l(n).start_time=t),endTime:l(n).end_time,"onUpdate:endTime":o[5]||(o[5]=t=>l(n).end_time=t)},null,8,["startTime","endTime"])]),_:1}),e(c,null,{default:a(()=>[e(_,{type:"primary",onClick:o[6]||(o[6]=t=>l(d)())},{default:a(()=>[u("\u67E5\u8BE2")]),_:1}),e(_,{onClick:l(T)},{default:a(()=>[u("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),e(D,{class:"!border-none mt-4",shadow:"never"},{default:a(()=>[w("div",ce,[y((s(),r(_,{type:"default",plain:!0,disabled:!l(F).length,onClick:o[7]||(o[7]=t=>b(l(F).map(g=>g.id)))},{default:a(()=>[u(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"])),[[S,["ai_application.kn.files/del"]]])]),y((s(),r(A,{size:"large",data:l(p).lists,"row-key":"id",onSelectionChange:V},{default:a(()=>[e(i,{type:"selection",width:"55",fixed:"left","reserve-selection":""}),e(i,{label:"ID",prop:"id","min-width":"80"}),e(i,{prop:"name",label:"\u6587\u4EF6\u540D\u79F0","min-width":"140","show-overflow-tooltip":""}),e(i,{prop:"type",label:"\u6587\u4EF6\u683C\u5F0F","min-width":"100","show-overflow-tooltip":""}),e(i,{label:"\u6587\u4EF6\u5927\u5C0F","min-width":"80","show-overflow-tooltip":""},{default:a(({row:t})=>[u(ne(l(me)(t.size)),1)]),_:1}),e(i,{label:"\u89E3\u6790\u72B6\u6001",prop:"status_text",width:"120","show-overflow-tooltip":""},{default:a(({row:t})=>[t.status=="INIT"?(s(),r(E,{key:0,type:"info"},{default:a(()=>[u("\u5F85\u89E3\u6790")]),_:1})):t.status=="PARSING"?(s(),r(E,{key:1,type:"warning"},{default:a(()=>[u("\u89E3\u6790\u4E2D")]),_:1})):t.status=="PARSE_SUCCESS"?(s(),r(E,{key:2,type:"success"},{default:a(()=>[u("\u89E3\u6790\u5B8C\u6210")]),_:1})):t.status=="PARSE_FAILED"?(s(),r(E,{key:3,type:"danger"},{default:a(()=>[u("\u89E3\u6790\u5931\u8D25")]),_:1})):h("",!0)]),_:1}),e(i,{label:"\u5BFC\u5165\u65F6\u95F4",prop:"create_time",width:"180","show-overflow-tooltip":""}),e(i,{label:"\u64CD\u4F5C",width:"140",fixed:"right"},{default:a(({row:t})=>[e(_,{type:"primary",link:"",onClick:g=>x(t.id)},{default:a(()=>[u(" \u67E5\u770B\u5207\u7247 ")]),_:2},1032,["onClick"]),y((s(),r(_,{type:"danger",link:"",onClick:g=>b([t.id])},{default:a(()=>[u(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[S,["ai_application.kn.files/del"]]])]),_:1})]),_:1},8,["data"])),[[U,l(p).loading]]),w("div",Ee,[e(N,{modelValue:l(p),"onUpdate:modelValue":o[8]||(o[8]=t=>ue(p)?p.value=t:null),onChange:l(d)},null,8,["modelValue","onChange"])])]),_:1})]),l(v)?(s(),r(fe,{key:0,ref_key:"ragDataRef",ref:k,onClose:o[9]||(o[9]=t=>v.value=!1)},null,512)):h("",!0)],64)}}});export{Be as _};
