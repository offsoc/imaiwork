import{_ as G}from"./index.81ef9c88.js";import{R as j,S as H,C as P,D as M,G as O,H as Q,v as W,F as Y,w as J}from"./element-plus.e618cff3.js";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang.dbd208c7.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang.4d6306c3.js";import{g as Z}from"./cate.a9c1ceac.js";import{g as ee,c as oe,a as te}from"./coze.005f5805.js";import{s as b,g as ue,f as ae,e as se,d as le}from"./index.03099c94.js";import{C as v}from"./coze_bg.f0117346.js";import ne from"./agent-logo.ae6ed4c7.js";import{u as de}from"./useLockFn.b1b43a93.js";import{d as ie,s as E,Y as re,r as ce,ai as me,o as c,G as x,H as l,a as n,Q as t,W as pe,u,c as _e,P as Fe,a5 as fe,M as m,n as ge}from"./@vue.fa3e2f74.js";const De={class:""},Be={class:"mt-10"},be={class:"mt-[25px]"},ve=n("div",{class:"w-[72px] h-[29px] flex items-center justify-center rounded-[32px] bg-[#00000066] text-white"}," \u66F4\u6362\u80CC\u666F ",-1),Ee={class:"p-8"},xe=n("div",{class:"text-lg font-bold"},"\u65B0\u589ECoze\u667A\u80FD\u4F53",-1),Ce=n("div",{class:"text-xs text-[#0000004d] mt-2"},"\u5FEB\u901F\u642D\u5EFA\u5BF9\u8BDD\u5F0F\u667A\u80FD\u4F53",-1),Ve={class:"flex justify-center"},Te=ie({__name:"coze-edit",emits:["close","success"],setup(Ae,{expose:C,emit:V}){const p=V,_=E(),e=re({id:"",name:"",type:1,introduced:"",bg_image:"",coze_id:"",stream:1,deduction:1,avatar:"",permissions:0,agent_cate_id:"",tokens:0}),A={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u667A\u80FD\u4F53\u540D\u79F0"}],introduced:[{required:!0,message:"\u8BF7\u8F93\u5165\u667A\u80FD\u4F53\u4ECB\u7ECD"}],coze_id:[{required:!0,message:"\u8BF7\u8F93\u5165Coze\u667A\u80FD\u4F53ID"}],agent_cate_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u76EE"}]},F=E(),f=ce([]),g=async s=>{const{lists:o}=await Z({name:s,type:2,page_size:25e3});f.value=o},y=s=>{const{uri:o}=s;e.bg_image=o},k=async()=>{try{const s=await se(v,"coze_bg.png"),{uri:o}=await le("image",{file:s});e.bg_image=o}catch(s){console.error("\u4E0A\u4F20\u9ED8\u8BA4\u80CC\u666F\u5931\u8D25:",s)}},{lockFn:w,isLock:z}=de(async()=>{var s;if(!e.avatar){ae.msgError("\u8BF7\u4E0A\u4F20\u667A\u80FD\u4F53\u5934\u50CF");return}await((s=F.value)==null?void 0:s.validate()),await ge(),e.bg_image||await k(),e.id?await oe(e):await te(e),D(),p("success")}),h=async()=>{_.value.open(),g()},D=()=>{p("close")};return C({open:h,setFormData:s=>b(s,e),getDetail:async s=>{const o=await ee({id:s});b(o,e)}}),(s,o)=>{const R=X,U=K,r=P,d=M,I=O,L=Q,S=me("router-link"),i=j,B=H,q=W,N=Y,T=J,$=G;return c(),x($,{ref_key:"popupRef",ref:_,async:"",width:"415px","confirm-button-text":"","cancel-button-text":"","header-class":"!p-0","footer-class":"!p-0","body-class":"coze-edit-body !p-0 ",style:{padding:"0"},"show-close":!1},{default:l(()=>[n("div",De,[n("div",{class:"absolute w-6 h-6 right-4 top-4 cursor-pointer",onClick:D},[t(R)]),n("div",{class:"top",style:pe({backgroundImage:`url(${u(e).bg_image||u(v)})`})},[n("div",Be,[t(ne,{modelValue:u(e).avatar,"onUpdate:modelValue":o[0]||(o[0]=a=>u(e).avatar=a)},null,8,["modelValue"])]),n("div",be,[t(U,{limit:1,"show-progress":"","show-file-list":!1,onSuccess:y},{default:l(()=>[ve]),_:1})])],4),n("div",Ee,[xe,Ce,t(N,{ref_key:"formRef",ref:F,model:u(e),rules:A,"label-position":"top",class:"mt-6"},{default:l(()=>[t(d,{label:"\u667A\u80FD\u4F53\u540D\u79F0",prop:"name"},{default:l(()=>[t(r,{modelValue:u(e).name,"onUpdate:modelValue":o[1]||(o[1]=a=>u(e).name=a),class:"!h-10",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u667A\u80FD\u4F53\u4ECB\u7ECD",prop:"introduced"},{default:l(()=>[t(r,{modelValue:u(e).introduced,"onUpdate:modelValue":o[2]||(o[2]=a=>u(e).introduced=a),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u667A\u80FD\u4F53\u7684\u8BF4\u660E",resize:"none",rows:6},null,8,["modelValue"])]),_:1}),t(d,{label:"\u667A\u80FD\u4F53\u5206\u7C7B",prop:"agent_cate_id"},{default:l(()=>[t(L,{modelValue:u(e).agent_cate_id,"onUpdate:modelValue":o[3]||(o[3]=a=>u(e).agent_cate_id=a),class:"!h-10",placeholder:"\u8BF7\u9009\u62E9\u667A\u80FD\u4F53\u5206\u7C7B","filter-method":"",remote:"","remote-method":g},{default:l(()=>[(c(!0),_e(Fe,null,fe(u(f),a=>(c(),x(I,{label:a.name,value:a.id,key:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(S,{class:"text-primary",to:u(ue)("ai_application.agent/cate"),target:"_blank"},{default:l(()=>[m(" \u53BB\u521B\u5EFA\u5206\u7C7B ")]),_:1},8,["to"])]),_:1}),t(d,{label:"Coze\u667A\u80FD\u4F53ID",prop:"coze_id"},{default:l(()=>[t(r,{modelValue:u(e).coze_id,"onUpdate:modelValue":o[4]||(o[4]=a=>u(e).coze_id=a),class:"!h-10",placeholder:"\u8BF7\u8F93\u5165Coze\u667A\u80FD\u4F53ID"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u8F93\u51FA\u65B9\u5F0F"},{default:l(()=>[t(B,{modelValue:u(e).stream,"onUpdate:modelValue":o[5]||(o[5]=a=>u(e).stream=a)},{default:l(()=>[t(i,{label:"\u6D41\u5F0F\u8F93\u51FA",value:1}),t(i,{label:"\u76F4\u63A5\u8FD4\u56DE",value:0})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u6263\u8D39\u65B9\u5F0F"},{default:l(()=>[t(B,{modelValue:u(e).deduction,"onUpdate:modelValue":o[6]||(o[6]=a=>u(e).deduction=a)},{default:l(()=>[t(i,{label:"Token\u6263\u8D39",value:0,disabled:""}),t(i,{label:"\u6309\u6B21\u6570\u6263\u8D39",value:1})]),_:1},8,["modelValue"]),t(q,{modelValue:u(e).tokens,"onUpdate:modelValue":o[7]||(o[7]=a=>u(e).tokens=a),min:0,"controls-position":"right","disabled-scientific":""},{append:l(()=>[m("\u7B97\u529B/\u6B21")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),n("div",Ve,[t(T,{color:"#000000",class:"!rounded-full !h-[50px] w-[310px] shadow-[0_6px_12px_0px_#0065FB33]",loading:u(z),onClick:o[8]||(o[8]=a=>u(w)())},{default:l(()=>[m("\u4FDD\u5B58")]),_:1},8,["loading"])])])])]),_:1},512)}}});export{Te as _};
