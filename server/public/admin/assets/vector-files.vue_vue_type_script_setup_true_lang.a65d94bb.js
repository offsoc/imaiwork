import{C as R,D as S,w as N,F as T,J as q,K as z,L as I,M}from"./element-plus.09e738c5.js";import{_ as U}from"./index.vue_vue_type_script_setup_true_lang.0af97da2.js";import{u as j}from"./vue-router.f608815d.js";import{d as A,Y as G,r as v,i as H,ap as J,o as c,c as O,a as k,P as e,G as o,u as t,a6 as Y,L as u,H as w,F as p,M as Q,v as W,K as X,O as Z,n as ee}from"./@vue.b0c8b5fa.js";import{b as te,c as oe}from"./files.59f62a04.js";import{n as ae,f as le}from"./index.1bd46af0.js";import{u as ne}from"./usePaging.3fa68fd5.js";import{_ as se}from"./vector-data.vue_vue_type_script_setup_true_lang.955e3acd.js";const ie={class:"mb-4"},ue={class:"flex justify-end mt-4"},we=A({__name:"vector-files",setup(re){const b=j(),n=G({kb_id:b.query.id,name:""}),{pager:r,getLists:d,resetPage:de,resetParams:D}=ne({fetchFun:oe,params:n}),_=v([]),V=i=>{_.value=i},C=async i=>{await le.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F"),await te({fids:i}),d()},g=v(null),f=v(!1),B=async i=>{f.value=!0,await ee(),g.value.open({kb_id:n.kb_id,id:i.id})};return H(async()=>{n.kb_id=b.query.id,d(),console.log(n.kb_id)}),(i,a)=>{const x=R,y=S,m=N,$=T,h=q,s=z,K=I,L=U,E=J("perms"),P=M;return c(),O(Z,null,[k("div",null,[e(h,{class:"!border-none",shadow:"never"},{default:o(()=>[e($,{ref:"formRef",class:"mb-[-16px]",model:t(n),inline:!0},{default:o(()=>[e(y,{label:"\u6587\u4EF6\u540D\u79F0"},{default:o(()=>[e(x,{class:"w-[280px]",modelValue:t(n).name,"onUpdate:modelValue":a[0]||(a[0]=l=>t(n).name=l),placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0",clearable:"",onKeyup:a[1]||(a[1]=Y(l=>t(d)(),["enter"]))},null,8,["modelValue"])]),_:1}),e(y,null,{default:o(()=>[e(m,{type:"primary",onClick:a[2]||(a[2]=l=>t(d)())},{default:o(()=>[u("\u67E5\u8BE2")]),_:1}),e(m,{onClick:t(D)},{default:o(()=>[u("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),e(h,{class:"!border-none mt-4",shadow:"never"},{default:o(()=>[k("div",ie,[w((c(),p(m,{type:"default",plain:!0,disabled:!t(_).length,onClick:a[3]||(a[3]=l=>C(t(_).map(F=>F.id)))},{default:o(()=>[u(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"])),[[E,["ai_application.kn.files/del"]]])]),w((c(),p(K,{size:"large",data:t(r).lists,"row-key":"id",onSelectionChange:V},{default:o(()=>[e(s,{type:"selection",width:"55",fixed:"left","reserve-selection":""}),e(s,{label:"ID",prop:"id","min-width":"80"}),e(s,{prop:"name",label:"\u6587\u4EF6\u540D\u79F0","min-width":"140","show-overflow-tooltip":""}),e(s,{prop:"type",label:"\u6587\u4EF6\u683C\u5F0F","min-width":"100","show-overflow-tooltip":""}),e(s,{label:"\u6587\u4EF6\u5927\u5C0F","min-width":"80","show-overflow-tooltip":""},{default:o(({row:l})=>[u(Q(t(ae)(l.size||0)),1)]),_:1}),e(s,{label:"\u6700\u8FD1\u66F4\u65B0\u65F6\u95F4",prop:"update_time","min-width":"180"}),e(s,{label:"\u64CD\u4F5C",width:"140",fixed:"right"},{default:o(({row:l})=>[e(m,{type:"primary",link:"",onClick:F=>B(l)},{default:o(()=>[u(" \u67E5\u770B\u5206\u6BB5 ")]),_:2},1032,["onClick"]),w((c(),p(m,{type:"danger",link:"",onClick:F=>C([l.id])},{default:o(()=>[u(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[E,["ai_application.kn.files/del"]]])]),_:1})]),_:1},8,["data"])),[[P,t(r).loading]]),k("div",ue,[e(L,{modelValue:t(r),"onUpdate:modelValue":a[4]||(a[4]=l=>W(r)?r.value=l:null),onChange:t(d)},null,8,["modelValue","onChange"])])]),_:1})]),t(f)?(c(),p(se,{key:0,ref_key:"vectorDataRef",ref:g,onClose:a[5]||(a[5]=l=>f.value=!1)},null,512)):X("",!0)],64)}}});export{we as _};
