import{R as h,S as D,w as v,D as R,C as S,F as k}from"./element-plus.e618cff3.js";import{f as i}from"./index.03099c94.js";import{_ as N}from"./index.81ef9c88.js";import{d as q,s as E,Y as x,o as y,c as O,Q as a,H as o,M as _,a as f,u as t,O as m,G as U,L}from"./@vue.fa3e2f74.js";const M={class:"export-data"},j={class:"flex"},G=f("span",{class:"flex-none ml-2 mr-2"},"\u9875\uFF0C\u81F3",-1),Y=q({__name:"index",props:{params:{type:Object,default:()=>({})},pageSize:{type:Number,default:25},fetchFun:{type:Function,required:!0},exportFun:{type:Function,default:!1}},setup(A){const c=E(),n=A,g=E(),e=x({page_type:0,page_start:1,page_end:200,file_name:""}),b={page_start:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D77\u59CB\u9875\u7801"},{type:"number",message:"\u9875\u7801\u5FC5\u987B\u662F\u6574\u6570"},{validator:(r,u,l)=>{if(u<=0)return l(new Error("\u9875\u7801\u5FC5\u987B\u5927\u4E8E0"));l()}}],page_end:[{required:!0,message:"\u8BF7\u8F93\u5165\u7ED3\u675F\u9875\u7801"},{type:"number",message:"\u9875\u7801\u5FC5\u987B\u662F\u6574\u6570"},{validator:(r,u,l)=>{if(u<=0)return l(new Error("\u9875\u7801\u5FC5\u987B\u5927\u4E8E0"));l()}}]},d=x({count:0,sum_page:0,page_size:0,max_page:0,all_max_size:0}),B=async()=>{const r=await n.fetchFun({...n.params,page_size:n.pageSize,export:1});Object.assign(d,r),e.file_name=r.file_name,e.page_end=r.page_end,e.page_start=r.page_start},V=async()=>{var r,u;await((r=c.value)==null?void 0:r.validate()),i.loading("\u6B63\u5728\u5BFC\u51FA\u4E2D...");try{const l=n.exportFun?await n.exportFun({...n.params,...e,page_size:n.pageSize,export:2}):await n.fetchFun({...n.params,...e,page_size:n.pageSize,export:2});(u=g.value)==null||u.close(),i.closeLoading(),l!=null&&l.url&&window.open(l.url)}catch{i.closeLoading()}};return B(),(r,u)=>{const l=v,p=R,C=h,w=D,F=S,z=k;return y(),O("div",M,[a(N,{ref_key:"popupRef",ref:g,title:"\u5BFC\u51FA\u8BBE\u7F6E",width:"500px","confirm-button-text":"\u786E\u8BA4\u5BFC\u51FA",async:!0,onOpen:B,onConfirm:V},{trigger:o(()=>[a(l,null,{default:o(()=>[_("\u5BFC\u51FA")]),_:1})]),default:o(()=>[f("div",null,[a(z,{ref_key:"formRef",ref:c,model:t(e),"label-width":"120px",rules:b},{default:o(()=>[a(p,{label:"\u6570\u636E\u91CF\uFF1A"},{default:o(()=>[_(" \u9884\u8BA1\u5BFC\u51FA"+m(t(d).count)+"\u6761\u6570\u636E\uFF0C \u5171"+m(t(d).sum_page)+"\u9875\uFF0C\u6BCF\u9875"+m(t(d).page_size)+"\u6761\u6570\u636E ",1)]),_:1}),a(p,{label:"\u5BFC\u51FA\u9650\u5236\uFF1A"},{default:o(()=>[_(" \u6BCF\u6B21\u5BFC\u51FA\u6700\u5927\u5141\u8BB8"+m(t(d).max_page)+"\u9875\uFF0C\u5171"+m(t(d).all_max_size)+"\u6761\u6570\u636E ",1)]),_:1}),a(p,{prop:"page_type",label:"\u5BFC\u51FA\u8303\u56F4\uFF1A",required:""},{default:o(()=>[a(w,{modelValue:t(e).page_type,"onUpdate:modelValue":u[0]||(u[0]=s=>t(e).page_type=s)},{default:o(()=>[a(C,{label:0},{default:o(()=>[_("\u5168\u90E8\u5BFC\u51FA")]),_:1}),a(C,{label:1},{default:o(()=>[_("\u5206\u9875\u5BFC\u51FA")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(e).page_type==1?(y(),U(p,{key:0,label:"\u5206\u9875\u8303\u56F4\uFF1A"},{default:o(()=>[f("div",j,[a(p,{prop:"page_start"},{default:o(()=>[a(F,{style:{width:"140px"},modelValue:t(e).page_start,"onUpdate:modelValue":u[1]||(u[1]=s=>t(e).page_start=s),modelModifiers:{number:!0},placeholder:""},null,8,["modelValue"])]),_:1}),G,a(p,{prop:"page_end"},{default:o(()=>[a(F,{style:{width:"140px"},modelValue:t(e).page_end,"onUpdate:modelValue":u[2]||(u[2]=s=>t(e).page_end=s),modelModifiers:{number:!0},placeholder:""},null,8,["modelValue"])]),_:1})])]),_:1})):L("",!0),a(p,{label:"\u5BFC\u51FA\u6587\u4EF6\u540D\u79F0\uFF1A",prop:"file_name"},{default:o(()=>[a(F,{modelValue:t(e).file_name,"onUpdate:modelValue":u[3]||(u[3]=s=>t(e).file_name=s),placeholder:"\u8BF7\u8F93\u5165\u5BFC\u51FA\u6587\u4EF6\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},512)])}}});export{Y as _};
