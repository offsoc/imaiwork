import{_ as x}from"./index.307da2ba.js";import{_ as R,x as S,y as z,J as T,w as q}from"./element-plus.09e738c5.js";import{u as K}from"./vue-router.f608815d.js";import{b as L,c as $,e as G}from"./index.3d75321d.js";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang.25d4622f.js";import H from"./index.7d321732.js";import I from"./index.a545f959.js";import J from"./index.156fdeb9.js";import U from"./index.1c148106.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_lang.2252fbe0.js";import{u as M}from"./useLockFn.cf82402d.js";import{s as O,K as k}from"./index.39a36e30.js";import{d as Y,r as _,s as n,b as Q,Y as W,i as X,o as m,c as y,P as s,G as p,a as g,u as r,v,O as Z,a5 as ee,F as c,J as te,L as oe,K as ae}from"./@vue.b0c8b5fa.js";import"./@vueuse.20a2efa8.js";import"./@element-plus.ca3f8b8b.js";import"./lodash-es.2cd559e9.js";import"./dayjs.33f9e030.js";import"./@vscode.6c9cb547.js";import"./katex.234fd046.js";import"./@popperjs.36402333.js";import"./async-validator.fb49d0f5.js";import"./@ctrl.b082b0c1.js";import"./normalize-wheel-es.8aeb3683.js";import"./index.vue_vue_type_script_setup_true_lang.0ec046c0.js";import"./cate.7a621659.js";import"./agent-logo.4a18554c.js";import"./lodash.0bb3a698.js";import"./axios.e67d1c3e.js";import"./pinia.173cb91f.js";import"./vue-demi.b3a9cad9.js";import"./css-color-function.9d260b6b.js";import"./color.4290e22e.js";import"./clone.10c3af82.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.35afef70.js";import"./ms.a9ae1d6d.js";import"./nprogress.d9597aae.js";import"./vue-clipboard3.6701dfcc.js";import"./clipboard.a993786e.js";import"./sortablejs.fb59ed0f.js";import"./echarts.8535e5a6.js";import"./zrender.3eba8991.js";import"./tslib.60310f1a.js";import"./highlight.js.4f6161a5.js";import"./@highlightjs.39ed541d.js";import"./lists.f7e04253.js";import"./menu-edit.beb71d90.js";import"./index.e57d7385.js";import"./index.vue_vue_type_script_setup_true_lang.1a8c56fb.js";import"./index.vue_vue_type_script_setup_true_lang.0af97da2.js";import"./keywords-edit.vue_vue_type_script_setup_true_lang.6c8a6132.js";import"./add-content.ba7bbf13.js";import"./workflow-edit.vue_vue_type_script_setup_true_lang.f0f61b6e.js";import"./usePaging.3fa68fd5.js";const re={class:"flex justify-between items-center"},pt=Y({__name:"edit",setup(ne){const B=K(),l=_(B.query.id),i=_("base"),d=_([{label:"\u4EBA\u8BBE",name:"base",component:n(P)},{label:"\u77E5\u8BC6\u5E93",name:"knb",component:n(H)},{label:"\u62DF\u4EBA\u5316",name:"humanize",component:n(I)},{label:"\u754C\u9762\u914D\u7F6E",name:"interface",component:n(J)},{label:"\u6280\u80FD",name:"skill",component:n(U)},{label:"\u8C03\u7528\u8BBE\u7F6E",name:"call",component:n(j)}]),E=Q(()=>{var t;return(t=d.value.find(o=>o.name===i.value))==null?void 0:t.component}),e=W({id:l.value,cate_id:"",kb_type:1,kb_ids:"",icons:"",image:"",bg_image:"",name:"",intro:"",model_id:"",model_sub_id:"",roles_prompt:"",search_mode:"similar",search_tokens:3e3,search_similar:.4,ranking_status:0,ranking_score:.5,context_num:3,is_public:0,is_enable:1,optimize_ask:0,optimize_m_id:"",optimize_s_id:"",search_empty_type:1,search_empty_text:"",top_p:.5,temperature:1,presence_penalty:.1,frequency_penalty:2,top_logprobs:10,logprobs:0,welcome_introducer:"",copyright:"",menus:[],flow_status:0,flow_config:{workflow_id:"",bot_id:"",app_id:"",api_token:""},threshold:.5}),b=_(),w=async()=>{if(!!l.value)try{const t=await L({id:l.value});O(t,e),e.kb_type==k.RAG&&t.kb_ids.length>0&&(e.kb_ids=t.kb_ids[0]),e.presence_penalty=Number(e.presence_penalty),e.frequency_penalty=Number(e.frequency_penalty),e.top_p=Number(e.top_p),e.temperature=Number(e.temperature)}catch(t){console.error("\u83B7\u53D6\u667A\u80FD\u4F53\u8BE6\u60C5\u5931\u8D25:",t)}},h=async()=>{var o,u;await((u=(o=b.value)==null?void 0:o.validate)==null?void 0:u.call(o));const t={...e,kb_ids:e.kb_type==k.RAG&&typeof e.kb_ids=="string"?[e.kb_ids]:e.kb_ids};e.id?await $(t):await G(t)},{lockFn:D,isLock:C}=M(()=>h());return X(()=>{w()}),(t,o)=>{const u=R,f=T,F=S,V=z,A=q,N=x;return m(),y("div",null,[s(f,{class:"!border-none",shadow:"never"},{default:p(()=>[g("div",re,[s(u,{onBack:o[0]||(o[0]=a=>t.$router.back())})])]),_:1}),s(f,{class:"!border-none mt-4",shadow:"never"},{default:p(()=>[s(V,{modelValue:r(i),"onUpdate:modelValue":o[1]||(o[1]=a=>v(i)?i.value=a:null)},{default:p(()=>[(m(!0),y(Z,null,ee(r(d),a=>(m(),c(F,{key:a.name,label:a.label,name:a.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),g("div",null,[(m(),c(te(r(E)),{ref_key:"formRef",ref:b,modelValue:r(e),"onUpdate:modelValue":o[2]||(o[2]=a=>v(e)?e.value=a:null),"agent-id":r(l)},null,8,["modelValue","agent-id"]))])]),_:1}),["skill","publish","call"].includes(r(i))?ae("",!0):(m(),c(N,{key:0},{default:p(()=>[s(A,{type:"primary",loading:r(C),onClick:r(D)},{default:p(()=>[oe("\u4FDD\u5B58")]),_:1},8,["loading","onClick"])]),_:1}))])}}});export{pt as default};
