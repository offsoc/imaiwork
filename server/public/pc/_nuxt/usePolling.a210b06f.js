import{r as p}from"./entry.2beb4577.js";let l={};function v(T,D){const{key:e,time:g=2e3,totalTime:a,count:s,callback:c=()=>!1}=D;let n=null,u=null,o=0,r=!1;const f=p(null),m=p(null);function d(){if(!r){if(u&&u<=Date.now()){t(),c();return}if(s&&o>=s){t(),c();return}o++,n=setTimeout(()=>{T().then(i=>{f.value=i,d()}).catch(i=>{m.value=i})},g)}}const h=()=>{r=!1,t(),e&&l[e]&&(l[e].end(),delete l[e]),u=a?Date.now()+a:null,d(),e&&(l[e]={end:t})},t=()=>{n&&(clearTimeout(n),n=null,u=null,o=0,r=!0,e&&delete l[e])};return{start:h,end:t,error:m,result:f}}export{v as u};
