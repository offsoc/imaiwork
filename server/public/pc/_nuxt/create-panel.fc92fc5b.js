import{E as J,a as M}from"./el-breadcrumb.77636383.js";import{d as Y,r as p,o as Z,k as n,l as c,m as o,q as f,s as d,Y as O,Z as a,t as g,I as y,L as m,ck as G,v as R,aI as X,J as S,K as tt,bQ as P,aH as B,ef as et,ax as st,y as ot,cQ as at,u as it,_ as nt}from"./entry.46557796.js";import{ak as rt,an as lt,ao as pt}from"./person_wechat.8bcf26fc.js";import{_ as ct}from"./send-name.vue.f45b1918.js";import{_ as mt}from"./send-way.vue.9e5c0e7a.js";import{_ as ut}from"./send-container.vue.29ca4e1c.js";import dt from"./useTask.59be508d.js";import{PushTypeEnum as L}from"./index.a1206616.js";import"./index.52e544f1.js";import"./index.304400de.js";import"./index.c76cd001.js";import"./strings.1c189114.js";import"./debounce.22e3311f.js";import"./_baseIteratee.6084bee0.js";import"./index.1d76ef55.js";import"./el-date-picker.9a9f22f5.js";import"./customParseFormat.df9b4c29.js";import"./panel-time-pick.003e480c.js";import"./index.08e202f9.js";/* empty css                  *//* empty css               *//* empty css                     */import"./el-empty.db5857ba.js";import"./7_day.257301c1.js";import"./material-edit.e95b77d8.js";import"./el-input-number.2848ce7e.js";import"./el-time-picker.715c6813.js";import"./index.f7064e65.js";/* empty css                  */import"./add-content.34d91834.js";import"./el-tabs.0dd2047f.js";import"./index.6e98cf6f.js";import"./el-alert.ec09dd2d.js";import"./index.816355b6.js";import"./index.vue.4fd7b3ea.js";import"./index.c84588fb.js";import"./index.fdfb054e.js";import"./index.6c2ab172.js";import"./cloneDeep.18da6720.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./el-image.663be0a1.js";import"./el-image-viewer.4c392e93.js";import"./throttle.f2fe0ca7.js";import"./position.bb07cf08.js";import"./index.vue.7b7084b3.js";/* empty css                   */import"./arrow_down.70a5466c.js";import"./dom.7f5b5a10.js";import"./index.cf59f1a8.js";import"./emoji.vue.a9dcd8db.js";import"./useHandle.beb30b0b.js";import"./mini-program-card.vue.7cccd646.js";import"./material-picker.vue.dbd2148f.js";import"./index.vue.94992955.js";import"./sidebar.22f9e609.js";import"./useMaterial.f57939ae.js";import"./usePaging.3ef28349.js";import"./container.79644375.js";import"./index.vue.383c1815.js";import"./upload.cf61b504.js";import"./preview.vue.ec784ac8.js";import"./link-card.vue.fa6a35e1.js";import"./file-card.vue.6c632466.js";import"./send-date.vue.e97a47b8.js";import"./file-item.vue.fb44d661.js";import"./send-date-preview.vue.0e5d95ce.js";import"./send-container-item.86f96eb6.js";import"./date.95a59cef.js";const _t={class:"h-full flex flex-col"},ft={class:"flex items-center justify-between bg-white p-4 rounded-lg flex-shrink-0"},yt={class:"flex justify-center"},vt={class:"grow min-h-0 bg-white rounded-xl mt-4 p-6"},xt={key:0,class:"step-container h-full flex flex-col"},kt={class:"grow min-h-0 w-[680px] flex flex-col gap-10"},ht={class:"px-8 mt-8 flex gap-4"},gt=["src"],wt={class:"flex flex-col gap-2"},Ct={class:"font-bold text-[20px]"},bt={class:"text-lg text-[#8A8C99]"},Et={class:"flex justify-end px-3 mt-4"},St={key:0,class:"flex items-center gap-2"},Pt=["onClick"],Bt={class:"h-full"},Dt=Y({__name:"create-panel",emits:["back"],setup(It,{expose:j,emit:Q}){const V=Q,U=it(),r=p("name"),{resource:w}=dt(),_=p([{img:w.CreateImg,title:"给您的SOP起个名字",desc:"请输入一个独特的名称，以便更好的管理和识别",status:0,key:"name"},{img:w.PostImg,title:"您希望以什么方式推送",desc:"请选择推送渠道，确保信息传递符合您的偏好",status:0,key:"type"},{img:w.ContentImg,title:"设置您需要推送的内容",desc:"选择并配置您希望目标对象接收的推送信息和推送类型",status:0,key:"content"}]),i=p(null),C=p(),x=p(!1),D=p(),b=p(),z=async e=>{x.value=!1,await v((e==null?void 0:e.id)||i.value.id),P({id:(e==null?void 0:e.id)||i.value.id})},K=async()=>{await v(i.value.id),rt({id:i.value.id,type:i.value.type,flow_id:i.value.flow_id,stage_id:i.value.stage_id,push_type:i.value.push_type,status:2})},W=async e=>{var s,h;r.value=e.key;const{key:t}=e;t=="name"?(x.value=!0,await B(),(s=C.value)==null||s.open(),i.value&&((h=C.value)==null||h.setFormData(i.value))):t=="type"?await $():t=="content"&&T(),P({step:r.value})},I=()=>{V("back")},q=async()=>{await U.$confirm({message:"确定取消吗？",onConfirm:async()=>{I()}})},E=()=>{r.value="name",P({step:"name"})},k=p(!1),v=async e=>{if(e){k.value=!0;try{const t=await lt({id:e});i.value=t,t.push_name&&_.value.forEach(s=>{s.key=="name"&&(s.status=1)}),t.flow_id&&_.value.forEach(s=>{s.key=="type"&&(s.status=1)}),r.value=="type"&&$(),t.push_time_list&&t.push_time_list.length&&(T(),_.value.forEach(s=>{s.key=="content"&&(s.status=1)}))}finally{k.value=!1}}},T=async()=>{var t,s;await B(),(t=b.value)==null||t.setFormData(i.value);const e=await pt({push_id:i.value.id});(s=b.value)==null||s.setDateList(e)},$=async()=>{var e;await B(),(e=D.value)==null||e.setFormData(i.value)};return Z(async()=>{const{id:e,step:t}=et();t&&_.value.some(s=>s.key==t)?r.value=t:r.value="name",e&&v(e)}),j({getDetail:v}),(e,t)=>{var N;const s=J,h=M,F=st,A=ot,H=at;return n(),c(S,null,[o("div",_t,[o("div",ft,[o("div",null,[f(h,{"separator-icon":a(G)},{default:d(()=>[f(s,null,{default:d(()=>[o("span",{class:"cursor-pointer text-[#8A8C99] hover:text-primary",onClick:I}," 任务管理 ")]),_:1}),f(s,null,{default:d(()=>[o("span",{class:O({"cursor-pointer text-[#8A8C99] hover:text-primary":["type","content"].includes(a(r))}),onClick:E},g(a(i)?a(i).push_name:"新建SOP"),3)]),_:1}),a(r)=="type"?(n(),y(s,{key:0},{default:d(()=>t[2]||(t[2]=[o("span",null," 设置推送方式 ",-1)])),_:1,__:[2]})):m("",!0),a(r)=="content"?(n(),y(s,{key:1},{default:d(()=>t[3]||(t[3]=[o("span",null," 设置推送内容 ",-1)])),_:1,__:[3]})):m("",!0)]),_:1},8,["separator-icon"])]),o("div",yt,[f(F,{type:"primary",class:"!h-10 w-[100px] !rounded-full",onClick:q},{default:d(()=>t[4]||(t[4]=[R("取消",-1)])),_:1,__:[4]}),a(r)!="name"?(n(),y(F,{key:0,class:"!h-10 w-[100px] !rounded-full",onClick:E},{default:d(()=>t[5]||(t[5]=[R("返回",-1)])),_:1,__:[5]})):m("",!0)])]),X((n(),c("div",vt,[a(k)?m("",!0):(n(),c(S,{key:0},[a(r)=="name"?(n(),c("div",xt,[o("div",kt,[(n(!0),c(S,null,tt(a(_),(l,u)=>(n(),c("div",{key:u,class:"h-[149px] rounded-2xl border border-solid border-primary-light-8 relative"},[o("div",{class:O(["absolute top-0 right-0 rounded-tr-2xl rounded-bl-2xl w-[100px] p-2 text-center text-white text-lg font-bold",[l.status==1?"bg-success":"bg-primary"]])},g(l.status==1?"已设置":`第${u+1}步`),3),o("div",ht,[o("img",{src:l.img,alt:"",class:"w-[56px] h-[56px]"},null,8,gt),o("div",wt,[o("div",Ct,g(l.title),1),o("div",bt,g(l.desc),1)])]),o("div",Et,[u!=0&&l.status==0&&a(_)[u-1].status==0?(n(),c("div",St,[t[6]||(t[6]=o("span",{class:"opacity-50 text-primary"}," 您还未完成上一步",-1)),f(A,{name:"el-icon-QuestionFilled",color:"#5580F9"})])):(n(),c("div",{key:1,class:"cursor-pointer flex items-center gap-2",onClick:$t=>W(l)},[t[7]||(t[7]=o("span",{class:"hover:underline text-primary"},"前往设置",-1)),f(A,{name:"el-icon-Right",size:16,color:"var(--color-primary)"})],8,Pt))])]))),128))])])):m("",!0),o("div",Bt,[a(r)=="content"?(n(),y(ut,{key:0,ref_key:"sendContainerRef",ref:b,type:a(L).AUTO_SOP,"task-id":(N=a(i))==null?void 0:N.id,onBack:E,onSuccess:K},null,8,["type","task-id"])):m("",!0),a(r)=="type"?(n(),y(mt,{key:1,ref_key:"sendWayRef",ref:D,onSuccess:t[0]||(t[0]=l=>{var u;return v((u=a(i))==null?void 0:u.id)})},null,512)):m("",!0)])],64))])),[[H,a(k)]])]),a(x)?(n(),y(ct,{key:0,ref_key:"nameEditRef",ref:C,type:a(L).AUTO_SOP,onSuccess:z,onClose:t[1]||(t[1]=l=>x.value=!1)},null,8,["type"])):m("",!0)],64)}}});const Me=nt(Dt,[["__scopeId","data-v-0aa0d9ff"]]);export{Me as default};
