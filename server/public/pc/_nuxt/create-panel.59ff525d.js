import{d as H,z as q,c as I,r as u,dI as K,aF as D,o as X,bb as Y,k as m,l as b,m as n,q as l,s as f,v as h,Z as s,J as A,L as k,I as z,aI as J,t as M,dw as Q,G as c,dP as B,aH as Z,y as ee,ax as te,au as oe,cV as se,_ as ne}from"./entry.2beb4577.js";import{_ as ae}from"./index.vue.478e85a5.js";import{f as re,u as le,h as ie,i as ce}from"./redbook.418b34fe.js";import{_ as C}from"./copywriting-card.vue.2c0b1e4e.js";import"./index.47b30189.js";/* empty css                     */const de={class:"h-full bg-app-bg-2 rounded-[20px] overflow-y-auto dynamic-scroller"},pe={class:"h-full flex flex-col min-w-[1000px]"},ue={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},me={class:"flex items-center gap-1"},fe={class:"grow min-h-0 flex flex-col mx-auto p-5"},_e={class:"flex justify-end items-center gap-x-2 flex-shrink-0"},ye={class:"grow min-h-0 flex justify-center gap-x-[18px] mt-5"},ge={class:"content-item"},ve={class:"content-item"},xe={key:1,class:"content-item"},we={class:"-my-2"},be={class:"mt-[18px]"},he={class:"mt-[18px]"},ke=H({__name:"create-panel",props:{type:{}},emits:["back"],setup(U,{emit:L}){const N=U,V=L,_=q(),P=I(()=>{var t;return i.total_num*((t=_.getTokenByScene(Q.KEYWORD_TO_COPYWRITING))==null?void 0:t.score)}),y=u(!1),g=u(!1),S=K(),e=D({id:S.id||"",title:[],oral_copy:[],described:[],copywriting_type:N.type||Number(S.copywriting_type)}),i=D({keyword:"",total_num:1}),T=I(()=>{const t=o=>o.some(d=>{var a;return(a=d.content)==null?void 0:a.trim()});return e.copywriting_type===1?!t(e.title)||!t(e.described):e.copywriting_type===2?!t(e.oral_copy):!0}),W=async()=>{if(!e.id)return;const t=await re({id:e.id});e.title=t.title||[],e.described=t.described||[],e.oral_copy=t.oral_copy||[]},j=async()=>{if(T.value){c.msgWarning("请确保所有必填项都已填写内容");return}y.value=!0;try{const t=d=>{var a;return(a=d.content)==null?void 0:a.trim()},o={...e,type:B.XHS,title:e.title.filter(t),oral_copy:e.oral_copy.filter(t),described:e.described.filter(t)};e.id?await le(o):await ie(o),c.msgSuccess("操作成功"),V("back")}catch(t){c.msgError(t)}finally{y.value=!1}},v=u(),x=u(!1),G=async()=>{var t;x.value=!0,await Z(),(t=v.value)==null||t.open()},E=()=>{var t;(t=v.value)==null||t.close()},O=async()=>{if(_.userTokens<=0){c.msgPowerInsufficient();return}if(!i.keyword.trim())return c.msgWarning("请输入您希望生成的主题内容");if(!i.total_num||i.total_num<1)return c.msgWarning("生成数量必须大于0");g.value=!0;try{const t=await ce({...i,type:B.XHS,copywriting_type:e.copywriting_type,channel:2});if(!t)return c.msgError("生成失败！");const{described:o,oral_copy:d,title:a}=t;if(e.copywriting_type===1){const w=a.map(p=>(p.content=p.content.slice(0,20),p));e.title.push(...w),e.described.push(...o)}else e.copywriting_type===2&&e.oral_copy.push(...d);_.getUser(),c.msgSuccess("生成成功！"),E()}catch(t){c.msgError(t)}finally{g.value=!1}},R=()=>{V("back")};return X(()=>{e.id&&W()}),(t,o)=>{const d=ee,a=te,w=ae,p=oe,$=se,F=Y("number-input");return m(),b(A,null,[n("div",de,[n("div",pe,[n("div",ue,[n("div",{class:"flex items-center gap-2 cursor-pointer",onClick:R},[l(d,{name:"el-icon-ArrowLeft",color:"#ffffff"}),o[6]||(o[6]=n("div",{class:"text-white"},"返回上一步",-1))]),n("div",me,[l(a,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:s(y),disabled:s(T),onClick:j},{default:f(()=>[...o[7]||(o[7]=[h(" 保存 ",-1)])]),_:1},8,["loading","disabled"])])]),n("div",fe,[n("div",_e,[l(a,{class:"!rounded-full !h-10 w-[106px] !border-app-border-2",color:"#181818",onClick:G},{default:f(()=>[...o[8]||(o[8]=[h(" 智能生成 ",-1)])]),_:1})]),n("div",ye,[s(e).copywriting_type===1?(m(),b(A,{key:0},[n("div",ge,[l(C,{"model-value":s(e).title,"onUpdate:modelValue":o[0]||(o[0]=r=>s(e).title=r),type:1},null,8,["model-value"])]),n("div",ve,[l(C,{"model-value":s(e).described,"onUpdate:modelValue":o[1]||(o[1]=r=>s(e).described=r),type:2},null,8,["model-value"])])],64)):k("",!0),s(e).copywriting_type===2?(m(),b("div",xe,[l(C,{"model-value":s(e).oral_copy,"onUpdate:modelValue":o[2]||(o[2]=r=>s(e).oral_copy=r),type:3,"show-topic":!1},null,8,["model-value"])])):k("",!0)])])])]),s(x)?(m(),z($,{key:0,ref_key:"popupRef",ref:v,"cancel-button-text":"","confirm-button-text":"",style:{"background-color":"var(--app-bg-color-2)","box-shadow":"0px 0px 0px 1px var(--app-border-color-1)"},"show-close":!1,onClosed:o[5]||(o[5]=r=>x.value=!1)},{default:f(()=>[n("div",we,[n("div",{class:"w-6 h-6 absolute top-[18px] right-[18px] cursor-pointer",onClick:E},[l(w)]),o[9]||(o[9]=n("div",{class:"text-white text-[15px] font-bold"},"智能生成",-1)),n("div",be,[l(p,{modelValue:s(i).keyword,"onUpdate:modelValue":o[3]||(o[3]=r=>s(i).keyword=r),placeholder:"您希望生成什么样的主题内容",class:"!h-11"},null,8,["modelValue"]),J(l(p,{modelValue:s(i).total_num,"onUpdate:modelValue":o[4]||(o[4]=r=>s(i).total_num=r),min:1,type:"number",placeholder:"您希望生成的数量",class:"!h-11 mt-2"},null,8,["modelValue"]),[[F,{decimal:0}]])]),n("div",he,[l(a,{type:"primary",class:"!rounded-full !h-[50px] w-full",loading:s(g),onClick:O},{default:f(()=>[h(" 开始（消耗"+M(s(P))+"算力） ",1)]),_:1},8,["loading"])])])]),_:1},512)):k("",!0)],64)}}});const De=ne(ke,[["__scopeId","data-v-ed0c5374"]]);export{De as default};
