import{d as U,A as E,r as S,aF as D,cq as G,G as J,k as f,I as R,s as a,m as e,q as t,Z as l,$ as O,v as $,t as h,bK as Z,l as w,K as H,J as M,cO as Q,y as X,ax as Y,au as ee,u as se}from"./entry.d7219633.js";import{a as te,E as ne}from"./index.0a6eb9ae.js";import{_ as oe}from"./index.vue.5e2341cc.js";import{E as le}from"./index.f15af271.js";import{E as ae}from"./el-empty.77af023a.js";/* empty css                        *//* empty css               *//* empty css                     */import{u as ie}from"./usePaging.3c53b51c.js";import{y as ce,z as re}from"./person_wechat.8bcf26fc.js";import{_ as de}from"./sidebar-panel.vue.93578dd6.js";const fe={class:"relative"},_e={class:"w-full bg-white rounded-lg flex h-[896px] overflow-hidden"},pe={class:"w-[94px] flex-shrink-0"},ue={class:"flex-1 flex flex-col border-r border-gray-200"},me={class:"flex-shrink-0"},he={class:"h-[70px] flex items-center justify-end px-4"},xe={class:"grow min-h-0"},ve=["src"],ge={class:"p-4 flex justify-end"},we={class:"w-[248px] flex-shrink-0 flex flex-col"},ke={class:"flex-shrink-0"},ye={class:"w-full h-[66px] bg-primary flex justify-between items-center px-4"},be={class:"text-white"},Ce={class:"grow min-h-0 py-4"},Ee={class:"flex flex-col gap-y-4 px-4"},Se=["src"],Re={class:"flex-1 text-[#414142]"},$e={class:"line-clamp-1"},Le=["onClick"],Ve={key:1,class:"flex items-center justify-center h-full"},Fe={class:"flex-shrink-0 mx-2 py-2"},Ie={class:"absolute -right-10 top-2"},Ge=U({__name:"add-friend",props:{wechatId:{}},emits:["close","success"],setup(L,{expose:V,emit:F}){const k=L,y=F,I=se(),b=E(),r=E(),x=S([]),_=D({wechat_id:"",nickname:""}),{pager:p,getLists:v}=ie({fetchFun:ce,params:_}),g=async()=>{var s,c;await v();const o=(s=r.value)==null?void 0:s.getSelectionRows();(c=r.value)==null||c.clearSelection(),o.forEach(d=>{var u;(u=r.value)==null||u.toggleRowSelection(d)})},i=S([]),B=o=>{i.value=o},T=async o=>{var s;(s=r.value)==null||s.toggleRowSelection(o,void 0)},j=async()=>{await I.$confirm({message:"确定要清空吗？",onConfirm:async()=>{var o;i.value=[],(o=r.value)==null||o.clearSelection()}})},{isLock:z,lockFn:K}=G(async()=>{if(i.value.length===0){J.msgWarning("请选择要添加的好友");return}C(),y("success",i.value)}),N=async()=>{const{lists:o}=await re({page_size:999,wechat_id:k.wechatId});x.value=o,x.value.length>0&&(_.wechat_id=k.wechatId,v())},W=()=>{var o;(o=b.value)==null||o.open(),N()},C=()=>{y("close")};return V({open:W}),(o,s)=>{const c=X,d=Y,u=ee,m=ne,A=oe,P=le,q=ae;return f(),R(Q,{"custom-class":"add-friend",ref_key:"popupRef",ref:b,"hide-title":"",width:"900px","show-close":!1,"cancel-button-text":"","confirm-button-text":""},{default:a(()=>[e("div",fe,[e("div",_e,[e("div",pe,[t(de,{"wechat-list":l(x),"show-add-we-chat":!1,"current-wechat":{wechat_id:o.wechatId}},null,8,["wechat-list","current-wechat"])]),e("div",ue,[e("div",me,[e("div",he,[t(u,{modelValue:l(_).nickname,"onUpdate:modelValue":s[1]||(s[1]=n=>l(_).nickname=n),placeholder:"搜索",class:"!w-[200px] h-[32px]",clearable:"",onClear:s[2]||(s[2]=n=>g()),onKeyup:s[3]||(s[3]=O(n=>g(),["enter"]))},{append:a(()=>[t(d,{onClick:s[0]||(s[0]=n=>g())},{default:a(()=>[t(c,{name:"el-icon-Search"})]),_:1})]),_:1},8,["modelValue"])])]),e("div",xe,[t(l(te),{ref_key:"friendTableRef",ref:r,data:l(p).lists,stripe:"",height:"100%","row-style":{height:"60px"},"row-key":"friend_id",onSelectionChange:B},{default:a(()=>[t(m,{type:"selection","reserve-selection":"",width:"55",fixed:"left"}),t(m,{prop:"friend_nickname",label:"微信名称"}),t(m,{prop:"avatar",label:"头像"},{default:a(({row:n})=>[e("img",{src:n.friend_avatar,class:"w-8 h-8 rounded mx-auto"},null,8,ve)]),_:1}),t(m,{prop:"remark",label:"备注名称"},{default:a(({row:n})=>[$(h(n.remark||"-"),1)]),_:1})]),_:1},8,["data"])]),e("div",ge,[t(A,{modelValue:l(p),"onUpdate:modelValue":s[4]||(s[4]=n=>Z(p)?p.value=n:null),onChange:l(v)},null,8,["modelValue","onChange"])])]),e("div",we,[e("div",ke,[e("div",ye,[e("div",be,"已选好友（"+h(l(i).length)+"）人",1),t(d,{link:"",onClick:j},{default:a(()=>[t(c,{name:"local-icon-clean",size:16,color:"#ffffff"}),s[5]||(s[5]=e("span",{class:"text-white ml-2"},"清空",-1))]),_:1,__:[5]})])]),e("div",Ce,[l(i).length>0?(f(),R(P,{key:0},{default:a(()=>[e("div",Ee,[(f(!0),w(M,null,H(l(i),n=>(f(),w("div",{key:n.friend_id,class:"flex items-center gap-x-4"},[e("img",{src:n.friend_avatar,class:"flex-shrink-0 w-8 h-8 rounded"},null,8,Se),e("div",Re,[e("div",$e,h(n.friend_nickname),1),e("div",null,h(n.remark||"-"),1)]),e("div",{class:"flex-shrink-0 w-4 h-4 rounded-full bg-error flex items-center justify-center cursor-pointer",onClick:Be=>T(n)},[t(c,{name:"local-icon-close",color:"#ffffff"})],8,Le)]))),128))])]),_:1})):(f(),w("div",Ve,[t(q,{description:"暂无数据"})]))]),e("div",Fe,[t(d,{type:"primary",class:"w-full !h-[37px]",loading:l(z),onClick:l(K)},{default:a(()=>s[6]||(s[6]=[$(" 确定添加 ",-1)])),_:1,__:[6]},8,["loading","onClick"])])])]),e("div",Ie,[t(d,{circle:"",type:"primary",onClick:C},{default:a(()=>[t(c,{name:"local-icon-close",color:"#ffffff",size:16})]),_:1})])])]),_:1},512)}}});export{Ge as _};
