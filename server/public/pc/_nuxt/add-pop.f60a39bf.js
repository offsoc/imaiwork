import{_ as J}from"./index.vue.fd4cab65.js";import{d as z,at as $,z as j,aG as K,c as h,A as Z,r as Q,aF as W,cx as X,D as Y,k as _,I as C,s as r,m as o,q as s,Z as l,l as A,K as ee,J as S,v as I,t as te,L as oe,cV as se,dw as m,G as N,y as le,au as ae,av as ne,ay as re,ax as ie,_ as ce}from"./entry.f4f46cb5.js";import{E as de,a as pe}from"./index.ed825429.js";import{_ as me}from"./index.71dc546d.js";/* empty css                  *//* empty css               *//* empty css                     */import{v as ue}from"./digital_human.b276942f.js";import{DigitalHumanModelVersionEnum as d}from"./index.728f9c9c.js";import"./index.bad4fd13.js";import"./index.03679949.js";import"./strings.87cef2c7.js";import"./_baseIteratee.0f37ae7b.js";import"./toNumber.d5c70aa7.js";import"./clamp.6295a89e.js";import"./index.d4d0dc47.js";import"./index.b2901b1d.js";import"./index.26e6fbc6.js";import"./cloneDeep.3fe36a61.js";/* empty css                  *//* empty css                    *//* empty css                  */const fe={class:"-my-4"},_e={class:"flex items-center gap-x-1 rounded-full bg-[#ffffff08] p-1 mt-5 w-fit"},xe={class:"h-[166px] bg-app-bg-1 rounded-lg flex flex-col justify-center items-center"},ge={class:"w-12 h-12 rounded-xl flex items-center justify-center border border-dashed border-[#ffffff1a] hover:border-[#ffffff33] cursor-pointer mt-8 flex-shrink-0"},ve={class:"px-[35px] mt-[18px]"},he=z({__name:"add-pop",emits:["success","close"],setup(ke,{expose:B,emit:D}){const k=D,T=$(),c=j(),{userTokens:R}=K(c),w=h(()=>{const{channel:t}=T.getDigitalHumanConfig;return t&&t.length>0?t.filter(n=>{if(n.id=parseInt(n.id),n.status==1&&d.CHANJING==n.id)return n}):[]}),x=h(()=>{var t,e,n,p,u;return{[d.STANDARD]:(t=c.getTokenByScene(m.HUMAN_VOICE))==null?void 0:t.score,[d.SUPER]:(e=c.getTokenByScene(m.HUMAN_VOICE_PRO))==null?void 0:e.score,[d.ADVANCED]:(n=c.getTokenByScene(m.HUMAN_VOICE_ADVANCED))==null?void 0:n.score,[d.ELITE]:(p=c.getTokenByScene(m.HUMAN_VOICE_ELITE))==null?void 0:p.score,[d.CHANJING]:(u=c.getTokenByScene(m.HUMAN_VOICE_CHANJING))==null?void 0:u.score}[a.model_version]}),g=Z(),b=Q(),a=W({url:"",name:"",gender:"male",model_version:d.STANDARD}),U={name:[{required:!0,message:"请输入音色名称"}],url:[{required:!0,message:"请上传音频"}],model_version:[{required:!0,message:"请选择模型"}]},F=h(()=>".mp3,.m4a,.wav"),H=t=>{const{data:{uri:e}}=t;a.url=e},M=()=>{g.value.open()},O=async()=>{var t;if(R.value<x.value){N.msgPowerInsufficient();return}await b.value.validate();try{await ue(a),(t=g.value)==null||t.close(),c.getUser(),k("success")}catch(e){N.msgError(e||"转写失败!")}},E=()=>{k("close")},{lockFn:L,isLock:y}=X(O);return Y(()=>w.value,t=>{t&&t.length>0&&(a.model_version=t[0].id)},{immediate:!0}),B({open:M}),(t,e)=>{const n=J,p=le,u=ae,f=ne,v=de,V=pe,P=me,G=re,q=ie;return _(),C(se,{ref_key:"popupRef",ref:g,width:"400px",async:"",style:{padding:"18px","background-color":"var(--app-bg-color-2)"},"confirm-button-text":"","cancel-button-text":"","show-close":!1,onClose:E},{default:r(()=>[o("div",fe,[o("div",{class:"w-6 h-6 absolute top-4 right-4",onClick:E},[s(n)]),e[7]||(e[7]=o("div",{class:"flex items-center gap-x-2"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[o("rect",{width:"20",height:"20",rx:"10",fill:"#0065FB"}),o("path",{d:"M6 8V12",stroke:"white","stroke-width":"1.2"}),o("path",{d:"M14 8V12",stroke:"white","stroke-width":"1.2"}),o("path",{d:"M10 6V14",stroke:"white","stroke-width":"1.2"})]),o("span",{class:"text-white font-bold text-[20px]"},"上传本地音频")],-1)),o("div",_e,[s(p,{name:"local-icon-tips",size:16}),e[3]||(e[3]=o("span",{class:"text-[#ffffff4d] text-xs"},"注意：请根据性别上传对应的音频文件素材。",-1))]),s(G,{class:"mt-[17px]",model:l(a),rules:U,ref_key:"formRef",ref:b,"label-position":"top",disabled:l(y)},{default:r(()=>[s(f,{label:"音色名称",prop:"name"},{default:r(()=>[s(u,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=i=>l(a).name=i),class:"!h-11",placeholder:"请输入音色名称",maxlength:"30"},null,8,["modelValue"])]),_:1}),s(f,{label:"性别",prop:"gender"},{default:r(()=>[s(V,{modelValue:l(a).gender,"onUpdate:modelValue":e[1]||(e[1]=i=>l(a).gender=i),class:"!h-11",placeholder:"请选择性别","popper-class":"dark-select-popper","show-arrow":!1},{default:r(()=>[s(v,{value:"male",label:"男"}),s(v,{value:"female",label:"女"})]),_:1},8,["modelValue"])]),_:1}),s(f,{label:"使用模型",prop:"model_version"},{default:r(()=>[s(V,{modelValue:l(a).model_version,"onUpdate:modelValue":e[2]||(e[2]=i=>l(a).model_version=i),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1,placeholder:"请选择模型"},{default:r(()=>[(_(!0),A(S,null,ee(l(w),i=>(_(),C(v,{key:i.id,value:i.id,label:i.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(f,{label:"上传音频",prop:"url"},{default:r(()=>[s(P,{class:"w-full",drag:"",type:"audio","list-type":"text",limit:1,size:20,accept:l(F),onSuccess:H},{default:r(()=>[o("div",xe,[o("div",ge,[s(p,{name:"el-icon-Plus",color:"#ffffff"})]),e[4]||(e[4]=o("div",{class:"text-white text-xs mt-3"},"上传录音文件",-1)),e[5]||(e[5]=o("div",{class:"text-xs text-[rgba(255,255,255,0.3)] text-center mt-4"}," 文件不超过20MB,不支持gif/avif等音频格式以外的文件 ",-1))])]),_:1},8,["accept"])]),_:1})]),_:1},8,["model","disabled"]),o("div",ve,[s(q,{type:"primary",class:"w-full !h-[50px] !rounded-full",loading:l(y),onClick:l(L)},{default:r(()=>[e[6]||(e[6]=I("开始转写 ",-1)),l(x)?(_(),A(S,{key:0},[I("（消耗"+te(l(x))+"算力）",1)],64)):oe("",!0)]),_:1},8,["loading","onClick"])])])]),_:1},512)}}});const qe=ce(he,[["__scopeId","data-v-855811d4"]]);export{qe as default};
