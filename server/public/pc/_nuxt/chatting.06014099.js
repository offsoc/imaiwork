import{E as L}from"./el-empty.03c7f5cd.js";import{d as I,r as m,bJ as P,D as Y,k as a,l as n,Z as t,I as j,s as p,q as l,m as u,t as N,bz as R,L as _,Y as q,aH as J,_ as Z}from"./entry.d9d53b29.js";import{_ as T}from"./chat-msg-item.vue.4d8b1f2e.js";import w from"./chat-content.4c6e2fac.js";import A from"./useHandle.eb1dbbb2.js";import{s as G,a as K}from"./vue-virtual-scroller.esm.4d447b5a.js";/* empty css                             */import{ContentTypeEnum as f}from"./index.cf59f1a8.js";import"./el-image.239907bf.js";import"./el-image-viewer.291603f7.js";import"./throttle.cbb177ea.js";import"./debounce.39f38609.js";import"./position.0f08d59c.js";import"./el-avatar.24f27c8b.js";import"./index.vue.1675bfa5.js";import"./useAudio.87b4401d.js";import"./mini-program-card.vue.f970ef8c.js";import"./person_wechat.8bcf26fc.js";const O={class:"h-full"},Q={key:0,class:"text-center py-4"},U={class:"text-xs text-center text-white bg-[#dadada] rounded px-[10px] py-[5px]"},W={key:1},X={key:2,class:"flex justify-center py-4"},ee=["innerHTML"],te={key:3},se={key:1,class:"flex h-full items-center justify-center"},oe=I({__name:"chatting",props:{sendDisabled:{type:Boolean,default:!1}},emits:["top"],setup(V,{expose:k,emit:D}){const b=V,S=D,{previewVideo:v,historyMsgList:y,disabledScroll:r,downloadFile:g,voiceToText:h}=A(),c=m(0),d=m(null),B=m(null),x=async()=>{var s;r.value||(await J(),(s=d.value)==null||s.scrollToBottom(),setTimeout(()=>{var o;(o=d.value)==null||o.scrollToBottom()},200))},C=s=>{var o;(o=d.value)==null||o.scrollToItem(s)},E=s=>{const o=s.target.scrollTop;o<c.value?r.value=!0:o>c.value&&(r.value=!1),c.value=o,$(s.target)},$=({scrollTop:s})=>{s==0&&S("top")},M=()=>{r.value=!1,c.value=0},{height:z}=P(B);return Y(z,s=>{b.sendDisabled&&x()}),k({scrollToBottom:x,scrollToItem:C,initScroll:M}),(s,o)=>{const F=L;return a(),n("div",O,[t(y).length>0?(a(),j(t(K),{key:0,class:"h-full pb-4 dynamic-scroller",ref_key:"scrollbarRef",ref:d,items:t(y),"min-item-size":100,onScroll:E},{default:p(({item:e,index:ae,active:H})=>[l(t(G),{item:e,active:H,"size-dependencies":[e.message,e.file]},{default:p(()=>[u("div",{class:q(["px-4",{"min-h-[100px]":[t(f).File,t(f).Picture,t(f).Video].includes(e.contentType)}])},[[1,2].includes(e.type)?(a(),n("div",Q,[u("span",U,N(t(R)(e.createTime).format("YYYY-MM-DD HH:mm:ss")),1)])):_("",!0),e.type==2?(a(),n("div",W,[l(T,{type:2,avatar:e.avatar,"wechat-id":e.wechatId,"is-room":e.is_room},{his:p(()=>[l(w,{type:2,message:e.message,"show-stt":e.showStt,"stt-message":e.sttMessage,"stt-loading":e.sttLoading,"message-type":e.contentType,file:e.file,onPreviewVideo:i=>t(v)(e),onDownloadFile:i=>t(g)(e),onVoiceToText:i=>t(h)(e)},null,8,["message","show-stt","stt-message","stt-loading","message-type","file","onPreviewVideo","onDownloadFile","onVoiceToText"])]),_:2},1032,["avatar","wechat-id","is-room"])])):_("",!0),e.type==3?(a(),n("div",X,[u("div",{class:"text-xs text-gray-500",innerHTML:e.message},null,8,ee)])):_("",!0),e.type==1?(a(),n("div",te,[l(T,{type:1,avatar:e.avatar},{my:p(()=>[l(w,{type:1,loading:e.loading,"is-active":e.is_active,message:e.message,"stt-message":e.sttMessage,"show-stt":e.showStt,"stt-loading":e.sttLoading,"message-type":e.contentType,file:e.file,onPreviewVideo:i=>t(v)(e),onDownloadFile:i=>t(g)(e),onVoiceToText:i=>t(h)(e)},null,8,["loading","is-active","message","stt-message","show-stt","stt-loading","message-type","file","onPreviewVideo","onDownloadFile","onVoiceToText"])]),_:2},1032,["avatar"])])):_("",!0)],2)]),_:2},1032,["item","active","size-dependencies"])]),_:1},8,["items"])):(a(),n("div",se,[l(F,{description:"暂无消息"})]))])}}});const Ve=Z(oe,[["__scopeId","data-v-a8772503"]]);export{Ve as default};
