import{d as Z,r as s,o as F,k as $,l as z,m as o,q as f,Z as n,t as A,bM as J,L as K,aH as m,dv as p,y as O,G as w,_ as Q}from"./entry.ca4d3d61.js";import{E as W}from"./el-slider.ebeb6bda.js";import"./el-input-number.5d96f707.js";import"./debounce.bdbfd9e6.js";import"./toNumber.33289b44.js";import"./clamp.ba5ce84b.js";import"./index.4fbaf6cb.js";const X={class:"flex items-center max-w-2xl w-full"},Y={class:"flex items-center gap-6"},ee={class:"flex items-center ml-14 grow gap-4"},ae={class:"grow"},le=Z({__name:"control",props:{music:{default:""}},emits:["play","pause","next","prev","end"],setup(B,{expose:I,emit:N}){const T=B,u=N,e=s(null),i=s(0),l=s(!1),r=s("00:00"),_=s("00:00"),c=s(!1),y=s(!1),g=s(!1),v=s(T.music),k=async()=>{await m(),e.value&&(e.value.src=v.value,e.value.load(),x())},P=async t=>{v.value=t,await m(),k()},h=()=>{e.value&&(c.value=!0,_.value=p(e.value.duration))},j=()=>{l.value&&e.value&&e.value.play(),c.value=!1},q=()=>{y.value=!0,c.value=!1},C=()=>y.value||!v.value?(w.msgError("无法播放音乐"),l.value=!1,!1):c.value?(w.msgError("播放器正在加载，请稍等"),l.value=!1,!1):e.value?!0:(w.msgError("播放器初始化失败"),k(),l.value=!1,!1),x=()=>{C()&&(l.value=!0,e.value.play(),u("play"))},b=()=>{u("pause"),l.value=!1,e.value.pause()},V=()=>{l.value?b():x()},M=async()=>{u("next"),await m()},D=async()=>{u("prev"),await m()},G=()=>{e.value&&(e.value.src=T.music,e.value.load()),l.value=!0,y.value=!1,c.value=!1,r.value="00:00",_.value="00:00",i.value=0,C()},S=()=>{l.value=!1,u("end")},H=t=>{if(e.value){const a=t/100*e.value.duration;r.value=p(a),g.value=!0}},L=t=>{if(e.value){const a=t/100*e.value.duration;e.value.currentTime=a,r.value=p(a),g.value=!1,l.value&&e.value.play()}},R=()=>{e.value&&!g.value&&(r.value=p(e.value.currentTime),i.value=e.value.currentTime/e.value.duration*100)};return F(()=>{k()}),I({play:x,pause:b,seek:L,next:M,end:S,toggle:V,resetPlayer:G,setAudio:P}),(t,a)=>{const E=O,U=W;return $(),z("div",X,[o("div",null,[o("div",Y,[o("button",{onClick:a[0]||(a[0]=d=>D())},[f(E,{name:"local-icon-music_left",size:24,color:"var(--color-primary)"})]),o("button",{class:"w-12 h-12 flex items-center justify-center bg-primary rounded-full",onClick:a[1]||(a[1]=d=>V())},[f(E,{name:n(l)?"local-icon-music_pause":"local-icon-music_play",color:"#ffffff",size:24},null,8,["name"])]),o("button",{onClick:a[2]||(a[2]=d=>M())},[f(E,{name:"local-icon-music_right",size:24,color:"var(--color-primary)"})])])]),o("div",ee,[o("div",null,A(n(r)),1),o("div",ae,[f(U,{modelValue:n(i),"onUpdate:modelValue":a[3]||(a[3]=d=>J(i)?i.value=d:null),"show-tooltip":!1,disabled:!n(v),onInput:H,onChange:L},null,8,["modelValue","disabled"])]),o("div",null,A(n(_)),1)]),n(v)?($(),z("audio",{key:0,ref_key:"audio",ref:e,class:"hidden",onEnded:S,onTimeupdate:R,onCanplay:j,onLoadedmetadata:h,onError:q},null,544)):K("",!0)])}}});const ce=Q(le,[["__scopeId","data-v-f505482c"]]);export{ce as default};
