import{d as U,bO as J,aF as W,r as m,Z as o,k as l,l as i,m as t,q as a,s as c,$ as Y,v as x,aI as C,J as $,K as Z,Y as I,a0 as R,t as r,L as g,I as V,bS as T,aH as S,ax as Q,au as X,y as ee,ba as se,cW as te,u as oe,G as le}from"./entry.2beb4577.js";import{E as ae}from"./index.47b30189.js";import{_ as ne}from"./index.vue.478e85a5.js";import{E as ie}from"./el-image.a83bf837.js";/* empty css                     */import"./el-image-viewer.d11cc27b.js";import{u as re}from"./usePaging.85211d66.js";import{p as ce,q as de}from"./redbook.418b34fe.js";import{_ as pe}from"./empty.vue.749fbb58.js";import{SidebarTypeEnum as ue}from"./index.db2ee73f.js";import fe from"./create-panel.e39783b1.js";import _e from"./preview-video-result.563f40b3.js";import{E as me}from"./index.abba0b88.js";const xe={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},ve={class:"flex-shrink-0 px-[14px] border-[0] border-b-[1px] border-app-border-1"},ge={class:"flex items-center justify-end h-[88px]"},he={class:"flex items-center gap-[14px]"},ke=["infinite-scroll-disabled"],ye={class:"h-full p-4"},be={key:0},we={class:"grid grid-cols-1 xl:grid-cols-2 gap-4"},Ee=["onClick"],Ce=["onClick"],$e={class:"flex-shrink-0 w-[143px] border border-app-border-2 overflow-hidden rounded-md bg-black"},Ie={class:"flex-1 flex flex-col gap-y-[10px]"},Re={class:"text-white break-all line-clamp-1 mr-4"},Ve={class:"flex items-center gap-x-1"},Te={class:"text-white"},Se={class:"flex items-center gap-x-1 text-white"},Be={class:"text-white"},Pe={class:"text-white"},Le={class:"flex items-center gap-x-2"},Ne={key:0,class:"text-white text-center text-xs w-full py-4"},Ae={key:1,class:"h-full flex items-center justify-center"},Ze=U({__name:"index",setup(De){const B=J(),f=W({name:"",page_no:1,page_size:20}),{pager:d,getLists:h,resetPage:u}=re({fetchFun:ce,params:f,isScroll:!0}),P={0:"草稿箱",1:"待处理",2:"生成中",3:"已完成",4:"失败",5:"部分完成"},L=()=>{_.value=!1,window.history.replaceState("","",`?type=${ue.DIGITAL_HUMAN_CREATION}`),u()},N=()=>{f.page_no++,h()},k=m(),_=m(B.query.is_create=="1"),y=async()=>{var n;_.value=!0,T({is_create:1}),await S(),(n=k.value)==null||n.createEmptyTask()},A=async n=>{n.status==0&&(_.value=!0,T({is_create:1,create_id:n.id}))},D=async(n,e)=>{oe().$confirm({message:"确定要删除该数字人任务吗？",theme:"dark",onConfirm:async()=>{try{await de({id:n}),d.lists.splice(e,1)}catch(p){le.msgError(p)}}})},b=m(),v=m(!1),q=async n=>{var e;v.value=!0,await S(),(e=b.value)==null||e.open(n)};return h(),(n,e)=>{const p=Q,H=X,j=ee,F=se,K=ae,M=ne,z=ie,G=te,O=me;return o(_)?(l(),V(fe,{key:1,ref_key:"createPanelRef",ref:k,onBack:L},null,512)):(l(),i("div",xe,[t("div",ve,[a(K,null,{default:c(()=>[t("div",ge,[t("div",he,[a(H,{modelValue:o(f).name,"onUpdate:modelValue":e[1]||(e[1]=s=>o(f).name=s),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[2]||(e[2]=s=>o(u)()),onKeydown:e[3]||(e[3]=Y(s=>o(u)(),["enter"]))},{append:c(()=>[a(p,{text:"",onClick:e[0]||(e[0]=s=>o(u)())},{default:c(()=>[...e[7]||(e[7]=[x(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),a(p,{type:"primary",class:"!rounded-full !h-10 !px-4",onClick:e[4]||(e[4]=s=>y())},{default:c(()=>[a(j,{name:"local-icon-add_circle",color:"#ffffff"}),e[8]||(e[8]=t("span",{class:"ml-2"},"创建批量数字人任务",-1))]),_:1}),t("div",null,[a(F,{content:"刷新"},{default:c(()=>[a(p,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[5]||(e[5]=s=>o(u)())})]),_:1})])])])]),_:1})]),C((l(),i("div",{class:"grow min-h-0 overflow-y-auto flex flex-col dynamic-scroller","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!o(d).isLoad,"infinite-scroll-distance":10},[C((l(),i("div",ye,[o(d).lists.length?(l(),i("div",be,[t("div",we,[(l(!0),i($,null,Z(o(d).lists,(s,w)=>(l(),i("div",{class:I(["flex gap-x-4 h-[222px] relative overflow-hidden bg-app-bg-3 border border-app-border-2 rounded-xl p-4",{"cursor-pointer":s.status==0}]),key:w,onClick:E=>A(s)},[t("div",{class:"absolute right-2 top-2 w-6 h-6",onClick:R(E=>D(s.id,w),["stop"])},[a(M)],8,Ce),t("div",$e,[a(z,{src:s.pic,class:"w-full h-full",fit:"cover"},{error:c(()=>[...e[9]||(e[9]=[t("div",{class:"w-full h-full flex items-center justify-center text-white card-gradient"}," 暂无封面 ",-1)])]),_:1},8,["src"])]),t("div",Ie,[t("div",Re,[x(r(s.name),1),s.automatic_clip==1?(l(),i($,{key:0},[x("（AI剪辑）")],64)):g("",!0)]),t("div",Ve,[t("span",Te,"生成状态："+r(s.success_num||0)+"/"+r(s.video_count||1),1),t("span",{class:I([[3,5].includes(s.status)?"text-[#3BB840]":"text-primary"])},r(P[s.status]),3)]),t("div",Se,[e[10]||(e[10]=t("span",null,"生成视频：",-1)),t("span",null,"成功"+r(s.success_num||0),1),t("span",null,"失败"+r(s.error_num||0),1)]),t("div",Be,"任务创建："+r(s.create_time),1),t("div",Pe,"最新提交："+r(s.latest_submission_time),1),t("div",Le,[a(p,{class:"!h-10 w-[126px] !border-app-border-2",color:"#1f1f1f",onClick:R(E=>q(s.id),["stop"])},{default:c(()=>[...e[11]||(e[11]=[x("查看视频",-1)])]),_:1},8,["onClick"])])])],10,Ee))),128))]),o(d).isLoad?g("",!0):(l(),i("div",Ne,"暂无更多了~"))])):(l(),i("div",Ae,[a(pe,{"btn-text":"创建批量数字人任务",msg:"快去发布你的专属数字人吧","custom-click":()=>y()},null,8,["custom-click"])]))])),[[G,o(d).loading]])],8,ke)),[[O,N]]),o(v)?(l(),V(_e,{key:0,ref_key:"previewVideoResultRef",ref:b,onClose:e[6]||(e[6]=s=>v.value=!1)},null,512)):g("",!0)]))}}});export{Ze as _};
