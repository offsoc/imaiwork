import{_ as A}from"./index.vue.f38ca415.js";import{d as G,r as m,c as H,aF as J,cq as O,G as C,bI as E,k as c,l as u,q as l,s as d,m as s,Z as i,cU as Z,t as Q,J as g,K as W,a0 as I,v as y,I as X,L as Y,au as ee,y as se,ax as te,cO as oe,aH as le,_ as ie}from"./entry.d7219633.js";import{E as ne}from"./el-image.37ed17f2.js";import{_ as ae}from"./index.55703cf7.js";import{_ as de}from"./index.vue.c82b4b26.js";import"./el-image-viewer.960ba8e6.js";import{z as ce,A as re,B as ue}from"./knowledge_base.519704cc.js";import"./position.cb246d7d.js";import"./index.3adcf74a.js";import"./index.9efd0300.js";import"./cloneDeep.1f319c9b.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./throttle.70466628.js";import"./debounce.085e8a4a.js";const me={class:"-my-4"},pe={class:"p-[18px]"},_e={class:"font-bold text-[20px]"},fe={class:"flex gap-2"},ve={class:"flex-1"},xe={class:"mt-3"},we={class:"flex-1"},ge={class:"mt-3"},ye={class:"mt-3"},ke={class:"mt-2"},he={class:"mt-2"},be={class:"flex flex-wrap gap-2"},Ve=["onClick"],Ce={class:"material-item"},Ee={class:"mt-3"},Ie={class:"mt-2"},Be={class:"material-item"},De={key:1,class:"w-full h-full z-10 relative"},Fe=["src"],$e={class:"absolute top-0 left-0 w-full h-full flex items-center justify-center"},ze={class:"mt-3"},Se={class:"mt-2"},Ue={class:"mt-3 flex"},qe=G({__name:"subsection-edit",emits:["close","success"],setup(Re,{expose:B,emit:D}){const k=D,h=m(null),p=m("add"),F=H(()=>p.value==="add"?"新增":"编辑"),o=J({kb_id:"",fd_id:"",question:"",answer:"",images:[],files:[],video:[],uuid:""}),$=t=>{const{uri:e,name:a}=t.data;o.images.push({name:a,url:e})},z=t=>{const{uri:e,name:a}=t.data;o.video=[{url:e,name:a}]},_=m(!1),f=m(null),S=async()=>{_.value=!0,await le(),f.value.open(),f.value.setUrl(o.video[0].url)},U=t=>{o.images.splice(t,1)},q=t=>{o.video.splice(t,1)},R=t=>{o.files.splice(t.uid,1)},L=t=>{const{uri:e,name:a}=t.data;o.files.push({name:a,url:e})},T=(t="add")=>{p.value=t,h.value.open()},v=()=>{k("close")},{lockFn:K,isLock:N}=O(async()=>{if(!o.question){C.msgError("请输入文档内容");return}try{p.value=="edit"?await ce(o):await re(o),v(),k("success")}catch(t){C.msgError(t)}});return B({open:T,setFormData:t=>E(t,o),getDetail:async t=>{const e=await ue({uuid:t});E(e,o)}}),(t,e)=>{const a=A,b=ee,P=ne,r=se,x=ae,w=te,M=oe,j=de;return c(),u(g,null,[l(M,{ref_key:"popupRef",ref:h,top:"10vh",width:"800px","cancel-button-text":"","confirm-button-text":"",async:"",style:{padding:"0"},"show-close":!1},{default:d(()=>[s("div",me,[s("div",{class:"absolute top-[18px] right-[18px] w-6 h-6",onClick:v},[l(a,{theme:i(Z).LIGHT},null,8,["theme"])]),s("div",pe,[s("div",_e,Q(i(F))+"分段",1),e[17]||(e[17]=s("div",{class:"border-b border-[#0000001a] my-3"},null,-1)),s("div",null,[s("div",fe,[s("div",ve,[e[6]||(e[6]=s("div",{class:"text-[#00000080]"},"文档内容（可理解成会遇到的提问）",-1)),s("div",xe,[l(b,{modelValue:i(o).question,"onUpdate:modelValue":e[0]||(e[0]=n=>i(o).question=n),type:"textarea",resize:"none",placeholder:"请输入文档内容",rows:10},null,8,["modelValue"])])]),s("div",we,[e[7]||(e[7]=s("div",{class:"text-[#00000080]"},"说明内容（可理解如何回复）",-1)),s("div",ge,[l(b,{modelValue:i(o).answer,"onUpdate:modelValue":e[1]||(e[1]=n=>i(o).answer=n),type:"textarea",resize:"none",placeholder:"请输入相关内容",rows:10},null,8,["modelValue"])])])]),s("div",ye,[e[14]||(e[14]=s("div",{class:"text-[#000000cc]"},"附加内容：",-1)),s("div",ke,[s("div",null,[e[9]||(e[9]=s("div",{class:"text-[#00000080]"},"上传图片：(最多9张)",-1)),s("div",he,[s("div",be,[(c(!0),u(g,null,W(i(o).images,(n,V)=>(c(),u("div",{key:V,class:"material-item"},[l(P,{src:n.url,"preview-src-list":[n.url],fit:"cover",class:"w-full h-full rounded-md"},null,8,["src","preview-src-list"]),s("div",{class:"absolute -top-2 -right-2",onClick:Te=>U(V)},[l(r,{name:"local-icon-error_fill",color:"#ffffff"})],8,Ve)]))),128)),l(x,{limit:9,multiple:"","show-progress":"","show-file-list":!1,onSuccess:$},{default:d(()=>[s("div",Ce,[l(r,{name:"local-icon-upload",size:18,color:"#0000004d"}),e[8]||(e[8]=s("span",{class:"text-[#0000004d] text-xs mt-2"},"上传图片",-1))])]),_:1})])])]),s("div",Ee,[e[11]||(e[11]=s("div",{class:"text-[#00000080]"},"上传视频：(格式为MP4，大小不能超过20M)",-1)),s("div",Ie,[l(x,{limit:1,type:"video","show-progress":"",accept:"video/mp4","max-size":20,"show-file-list":!1,onSuccess:z},{default:d(()=>[s("div",Be,[i(o).video.length?(c(),u("div",De,[s("div",{class:"absolute -top-2 -right-2",onClick:e[2]||(e[2]=I(n=>q(0),["stop"]))},[l(r,{name:"local-icon-error_fill",color:"#ffffff"})]),s("video",{src:i(o).video[0].url,class:"w-full h-full object-cover rounded-md"},null,8,Fe),s("div",$e,[s("div",{onClick:I(S,["stop"])},[l(r,{name:"local-icon-play",size:40,color:"#0000004d"})])])])):(c(),u(g,{key:0},[l(r,{name:"local-icon-upload",size:18,color:"#0000004d"}),e[10]||(e[10]=s("span",{class:"text-[#0000004d] text-xs mt-2"},"上传视频",-1))],64))])]),_:1})])]),s("div",ze,[e[13]||(e[13]=s("div",{class:"text-[#00000080]"},"上传附件：(支持上传PDF、docx、excel、等文件格式)",-1)),s("div",Se,[l(x,{type:"file",accept:".pdf,.docx,.xlsx,.doc,.csc,.txt,.md","list-type":"text",onRemove:R,onSuccess:L},{default:d(()=>[l(w,null,{default:d(()=>e[12]||(e[12]=[y("上传附件",-1)])),_:1,__:[12]})]),_:1})])])])])]),s("div",Ue,[l(w,{class:"flex-1 !rounded-full !h-[50px] w-[98px]",onClick:e[3]||(e[3]=n=>v())},{default:d(()=>e[15]||(e[15]=[y("取消",-1)])),_:1,__:[15]}),l(w,{type:"primary",class:"flex-1 !rounded-full !h-[50px] w-[98px]",loading:i(N),onClick:e[4]||(e[4]=n=>i(K)())},{default:d(()=>e[16]||(e[16]=[y(" 保存 ",-1)])),_:1,__:[16]},8,["loading"])])])])]),_:1},512),i(_)?(c(),X(j,{key:0,ref_key:"previewVideoRef",ref:f,onClose:e[5]||(e[5]=n=>_.value=!1)},null,512)):Y("",!0)],64)}}});const ss=ie(qe,[["__scopeId","data-v-55eb526b"]]);export{ss as default};
