import{E as K,a as O}from"./index.8fd3c68c.js";import{d as G,bP as H,aF as J,r as y,k as d,l as g,m as s,q as l,s as a,Z as o,$ as M,v as _,aI as W,I as k,t as c,Y,bM as Z,L as w,J as Q,bC as C,aH as $,u as X,G as V,ax as ee,au as te,ba as le,y as se,cW as oe}from"./entry.ee599c70.js";import{E as ae}from"./index.e69b4eeb.js";import{E as ne,a as ie}from"./index.ef8eb140.js";import{E as re}from"./el-empty.76498597.js";import{_ as de}from"./index.vue.33025166.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                        *//* empty css                 */import{u as pe}from"./useSocialPlatform.f7c9d861.js";import{u as ce}from"./usePaging.5914886e.js";import{e as ue,f as me}from"./device.b7e58507.js";import{_ as fe}from"./edit.vue.9d1c3b92.js";import{_ as _e}from"./detail.vue.acf0c687.js";const ve={class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},ye={class:"flex-shrink-0 px-[14px]"},ge={class:"flex items-center justify-end h-[88px]"},he={class:"flex items-center gap-[14px]"},xe={class:"grow min-h-0 overflow-hidden flex flex-col"},be={class:"grow min-h-0"},ke=["onClick"],Ee={class:"text-white"},we={class:"flex justify-center items-center gap-x-1"},Ce=["src"],$e={class:"flex items-center justify-center gap-2"},Ve={key:0},Pe={key:1},Te={key:2},Se={class:"flex justify-end items-center"},Be={class:"flex justify-center p-4"},We=G({__name:"index",setup(De){const{getPlatform:P}=pe();H();const u=J({name:"",task_type:3,page_size:20,media_type:""}),{pager:m,getLists:n,resetPage:T}=ce({fetchFun:ue,params:u}),h=y(!1),E=y(),x=y(!1),b=y(),S=i=>{const{publish_start:e,publish_end:p}=i;return e&&p?C(p).diff(C(e),"day")+1+"天":"-"},B=async i=>{h.value=!0,await $(),E.value.open(i)},D=async i=>{x.value=!0,await $(),b.value.open(),b.value.setFormData(i)},j=async i=>{X().$confirm({message:"是否删除该任务？",theme:"dark",onConfirm:async()=>{try{await me({id:i}),V.msgSuccess("删除成功"),n()}catch(e){V.msgError(e||"删除失败")}}})};return n(),(i,e)=>{const p=K,R=O,v=ee,I=te,N=le,z=ae,F=se,r=ne,L=re,A=ie,U=de,q=oe;return d(),g(Q,null,[s("div",ve,[s("div",ye,[l(z,null,{default:a(()=>[s("div",ge,[s("div",he,[s("div",null,[l(R,{modelValue:o(u).media_type,"onUpdate:modelValue":e[0]||(e[0]=t=>o(u).media_type=t),class:"!w-[160px]",placeholder:"请选择发布类型",clearable:"","popper-class":"dark-select-popper","show-arrow":!1,"empty-values":[null,void 0],onClear:e[1]||(e[1]=t=>o(n)()),onChange:e[2]||(e[2]=t=>o(n)())},{default:a(()=>[l(p,{label:"全部",value:""}),l(p,{label:"视频",value:"1"}),l(p,{label:"图片",value:"2"})]),_:1},8,["modelValue"])]),l(I,{modelValue:o(u).name,"onUpdate:modelValue":e[4]||(e[4]=t=>o(u).name=t),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[5]||(e[5]=t=>o(n)()),onKeydown:e[6]||(e[6]=M(t=>o(n)(),["enter"]))},{append:a(()=>[l(v,{text:"",onClick:e[3]||(e[3]=t=>o(n)())},{default:a(()=>[...e[12]||(e[12]=[_(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),s("div",null,[l(N,{content:"刷新"},{default:a(()=>[l(v,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[7]||(e[7]=t=>o(T)())})]),_:1})])])])]),_:1})]),s("div",xe,[s("div",be,[W((d(),k(A,{height:"100%",data:o(m).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:a(()=>[l(L)]),default:a(()=>[l(r,{prop:"name",label:"任务名称",width:"240",fixed:"left"},{default:a(({row:t})=>[s("div",{class:"flex items-center justify-center gap-2 cursor-pointer",onClick:f=>D(t)},[s("div",Ee,c(t.name),1),l(F,{name:"local-icon-edit",color:"#ffffff"})],8,ke)]),_:1}),l(r,{label:"发布账号",propas:"account","min-width":"200","show-overflow-tooltip":""},{default:a(({row:t})=>{var f;return[s("div",we,[s("img",{src:(f=o(P)(t.account_type))==null?void 0:f.icon,class:"w-4 h-4"},null,8,Ce),s("span",null,c(t.account),1)])]}),_:1}),l(r,{label:"发布类型",width:"80"},{default:a(({row:t})=>[_(c(t.media_type==1?"视频":"图片"),1)]),_:1}),l(r,{label:"任务状态",width:"120"},{default:a(({row:t})=>[s("div",$e,[s("div",{class:Y(["w-[6px] h-[6px] rounded-full",{"bg-primary":t.status==1,"bg-[#3BB840]":t.status==2}])},null,2),t.status==1?(d(),g("div",Ve,"进行中")):t.status==2?(d(),g("div",Pe,"已完成")):(d(),g("div",Te,"-"))])]),_:1}),l(r,{label:"发布周期","min-width":"100"},{default:a(({row:t})=>[s("div",null,c(S(t)),1)]),_:1}),l(r,{label:"发布进度",width:"100"},{default:a(({row:t})=>[_(c(t.published_count)+" / "+c(t.count),1)]),_:1}),l(r,{prop:"create_time",label:"创建时间",width:"180"}),l(r,{label:"操作",width:"120",fixed:"right",align:"right"},{default:a(({row:t})=>[s("div",Se,[l(v,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:f=>B(t)},{default:a(()=>[...e[13]||(e[13]=[_("详情",-1)])]),_:1},8,["onClick"]),l(v,{type:"danger",link:"",size:"small",onClick:f=>j(t.id)},{default:a(()=>[...e[14]||(e[14]=[_("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[q,o(m).loading]])]),s("div",Be,[l(U,{modelValue:o(m),"onUpdate:modelValue":e[8]||(e[8]=t=>Z(m)?m.value=t:null),layout:"prev, pager, next",onChange:o(n)},null,8,["modelValue","onChange"])])])]),o(x)?(d(),k(fe,{key:0,ref_key:"editPopupRef",ref:b,onClose:e[9]||(e[9]=t=>x.value=!1),onSuccess:e[10]||(e[10]=t=>o(n)())},null,512)):w("",!0),o(h)?(d(),k(_e,{key:1,ref_key:"detailPopupRef",ref:E,onClose:e[11]||(e[11]=t=>h.value=!1)},null,512)):w("",!0)],64)}}});export{We as _};
