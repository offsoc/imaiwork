import{d as k,z as w,r as u,G as y,aF as D,bz as T,k as v,l as x,q as p,s as h,m as A,Z as i}from"./entry.d7219633.js";import{k as M,m as I}from"./drawing.7058a163.js";import{ModelEnum as m,drawTypeEnumMap as b,DrawTypeEnum as C}from"./index.fb0aa6a9.js";import R from"./useCreateForm.02078254.js";import S from"./useDrawingTask.8cf66f93.js";import Y from"./result-content.20d28cd2.js";import{E as B}from"./index.f15af271.js";const F={class:"h-full relative w-full"},G={class:"px-[10px]"},W=k({__name:"index",setup(H){const{onEvent:c,setFormData:f}=R(),d=w(),n=u([]),r=u(!1);c("update:formData",async a=>{if(r.value){y.msgWarning("请等待上一次任务完成");return}r.value=!0;const{model:o,model_name:_,params:s}=a,e=D({date:T().format("YYYY-MM-DD HH:mm"),prompt:s.poster_description,images:[],formData:a,tags:[_,s.poster_type,s.poster_color,s.poster_title,s.poster_subtitle]});n.value.unshift(e);try{if(o==m.HIDREAMAI){e.images=new Array(parseInt(s.img_count)).fill({url:"",loading:!0,progress:0,status:0,error:!1});const{result:l}=await M(s),{processDrawingTask:t}=S({type:b[C.TXT2IMAGE],task_id:l.task_id,dataLists:e.images});await t({callback:E=>{e.images=E}})}else if(o==m.GENERAL||o==m.SEEDREAM){e.images=[{url:"",loading:!0,progress:0,status:0,error:!1}];const{result:l}=await I(s);e.images=[l.image_urls].map(t=>({url:t,loading:!1,progress:100,status:1,error:!1}))}d.getUser()}catch{e.images=e.images.map(t=>({...t,loading:!1,progress:0,status:4,error:!0}))}finally{r.value=!1}});const g=a=>{f(a)};return(a,o)=>(v(),x("div",F,[p(i(B),null,{default:h(()=>[A("div",G,[p(Y,{"result-lists":i(n),"is-all-tasks-completed":i(r),onRetry:g},null,8,["result-lists","is-all-tasks-completed"])])]),_:1})]))}});export{W as _};
