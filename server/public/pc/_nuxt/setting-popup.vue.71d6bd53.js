import{_ as C}from"./index.vue.d98c851e.js";import{d as N,r as T,aF as $,c as L,bK as O,k as u,I as x,s as t,m as l,q as s,Z as n,c$ as R,v as m,t as d,l as K,K as q,J as G,L as H,y as J,ba as Z,av as j,aw as A,ay as M,ax as P,cV as Q}from"./entry.ee599c70.js";import{E as W,a as X}from"./index.8fd3c68c.js";import{E as Y}from"./el-slider.b59fa7c4.js";import{E as ee}from"./el-input-number.0bb1bb2b.js";import{E as le}from"./el-switch.7d8162d3.js";/* empty css                  *//* empty css               *//* empty css                     */import{l as oe}from"./lodash.887a654f.js";import{searchOptions as se}from"./index.66741974.js";const te={class:"-my-4 p-[18px]"},ae={class:"flex items-center"},ne={class:"ml-1 cursor-pointer"},ie={class:"flex items-center"},me={class:"ml-1 cursor-pointer"},re={class:"flex items-center"},pe={class:"flex items-center"},ce={class:"ml-1 cursor-pointer"},de={class:"flex items-center"},ue={class:"flex items-center"},_e={class:"ml-1 cursor-pointer"},fe={class:"flex items-center"},xe={class:"ml-1 cursor-pointer"},ve={class:"flex items-center"},be={class:"mt-3 flex"},Ie=N({__name:"setting-popup",emits:["close","confirm"],setup(ke,{expose:g,emit:y}){const v=y,b=T(),a=$({search_mode:"similar",search_similar:0,search_tokens:8e3,optimize_ask:0,optimize_m_id:"",optimize_s_id:"",ranking_status:0,ranking_score:0,ranking_model:""}),k=L(()=>a.search_mode==="similar"),w=()=>{var i;(i=b.value)==null||i.open()},V=()=>{v("close")},z=()=>{const i=oe.cloneDeep(a);k.value||delete i.search_similar,v("confirm",i)};return g({open:w,setFormData:i=>O(i,a)}),(i,e)=>{const S=C,r=J,p=Z,F=W,U=X,c=j,_=Y,f=ee,E=A,D=le,I=M,h=P,B=Q;return u(),x(B,{ref_key:"popupRef",ref:b,top:"10vh",width:"700px","cancel-button-text":"","confirm-button-text":"",style:{padding:"0"},"show-close":!1},{default:t(()=>[l("div",te,[l("div",{class:"absolute top-[18px] right-[18px] w-6 h-6",onClick:V},[s(S,{theme:n(R).LIGHT},null,8,["theme"])]),e[14]||(e[14]=l("div",{class:"font-bold text-[20px]"},"向量检索配置",-1)),e[15]||(e[15]=l("div",{class:"border-b border-[#0000001a] my-3"},null,-1)),s(I,{ref:"formRef",model:n(a),"label-width":"100px"},{default:t(()=>[s(c,{label:"检索模式",prop:"search_mode"},{label:t(({label:o})=>[l("span",ae,[m(d(o)+" ",1),s(p,{placement:"top"},{content:t(()=>[...e[9]||(e[9]=[l("p",null,"语义检索: 采用向量化模型进行向量检索",-1),l("p",null,"全文检索: 使用传统的数据库检索方式检索",-1),l("p",null,"混合检索: 语义检索+全文检索,具有更好的效果,建议搭配重排模型使用。",-1),l("p",null,"注意: 当您使用全文或混合检索时，是没有语义相似度的，建议您开启重排模型",-1)])]),default:t(()=>[l("div",ne,[s(r,{name:"local-icon-privacy",color:"#00000080"})])]),_:1})])]),default:t(()=>[s(U,{class:"!w-64",modelValue:n(a).search_mode,"onUpdate:modelValue":e[0]||(e[0]=o=>n(a).search_mode=o),placeholder:"请选择搜索模式"},{default:t(()=>[(u(!0),K(G,null,q(n(se),o=>(u(),x(F,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(c,{label:"引用上限",prop:"search_tokens"},{label:t(({label:o})=>[l("span",ie,[m(d(o)+" ",1),s(p,{placement:"top"},{content:t(()=>[...e[10]||(e[10]=[l("p",null,"该参数表示单次文档从知识库检索最大的Tokens数量",-1),l("p",null,"说明: 引用越多意味着所需消耗的token越多",-1),l("p",null,"注意: 切记不要超出模型的最大token限制",-1)])]),default:t(()=>[l("div",me,[s(r,{name:"local-icon-privacy",color:"#00000080"})])]),_:1})])]),default:t(()=>[l("div",re,[s(_,{class:"!w-64",modelValue:n(a).search_tokens,"onUpdate:modelValue":e[1]||(e[1]=o=>n(a).search_tokens=o),size:"small",min:100,max:3e4},null,8,["modelValue"]),s(f,{class:"ml-4",modelValue:n(a).search_tokens,"onUpdate:modelValue":e[2]||(e[2]=o=>n(a).search_tokens=o),size:"small",min:100,max:3e4},null,8,["modelValue"])])]),_:1}),n(k)?(u(),x(c,{key:0,label:"最低相似度",prop:"search_similar"},{label:t(({label:o})=>[l("span",pe,[m(d(o)+" ",1),s(p,{placement:"top"},{content:t(()=>[...e[11]||(e[11]=[l("p",null,"语义检索的精度，提问检索的内容需要达到该精度才会被引用",-1),l("ol",{class:"list-decimal pl-4"},[l("li",null," 高语义相似度(>=0.8): 会检索相关性高的知识，会更准确，同时也容易未命中。 "),l("li",null," 低语义相似度(如0.4): 检索范围更大，更容易匹配知识，但可能回答会不准确。 "),l("li",null," 不同的向量模型检索相似度不一样，具体情况到 『知识库 - 搜索测试』进行调试。 "),l("li",null," 如果您使用的是『全文检索/混合检索』这个值则不会生效，仅对语义检索有效。 ")],-1)])]),default:t(()=>[l("div",ce,[s(r,{name:"local-icon-privacy",color:"#00000080"})])]),_:1})])]),default:t(()=>[l("div",de,[s(_,{class:"!w-64",modelValue:n(a).search_similar,"onUpdate:modelValue":e[3]||(e[3]=o=>n(a).search_similar=o),size:"small",min:0,max:1,step:.001,disabled:n(a).search_mode!=="similar"},null,8,["modelValue","disabled"]),s(f,{class:"ml-4",modelValue:n(a).search_similar,"onUpdate:modelValue":e[4]||(e[4]=o=>n(a).search_similar=o),size:"small",min:0,max:1,step:.001,disabled:n(a).search_mode!=="similar"},null,8,["modelValue","disabled"])])]),_:1})):H("",!0),s(E),s(c,{label:"结果重排",prop:"ranking_status"},{label:t(({label:o})=>[l("span",ue,[m(d(o)+" ",1),s(p,{content:"使用重排模型来进行二次排序, 可增强综合排名。",placement:"top"},{default:t(()=>[l("div",_e,[s(r,{name:"local-icon-privacy",color:"#00000080"})])]),_:1})])]),default:t(()=>[s(D,{modelValue:n(a).ranking_status,"onUpdate:modelValue":e[5]||(e[5]=o=>n(a).ranking_status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),s(c,{label:"重排权重",prop:"ranking_score"},{label:t(({label:o})=>[l("span",fe,[m(d(o)+" ",1),s(p,{content:"低于这个分数的数据将会被过滤。",placement:"top"},{default:t(()=>[l("div",xe,[s(r,{name:"local-icon-privacy",color:"#00000080"})])]),_:1})])]),default:t(()=>[l("div",ve,[s(_,{class:"!w-64",modelValue:n(a).ranking_score,"onUpdate:modelValue":e[6]||(e[6]=o=>n(a).ranking_score=o),size:"small",min:0,max:1,step:.001},null,8,["modelValue"]),s(f,{class:"ml-4",modelValue:n(a).ranking_score,"onUpdate:modelValue":e[7]||(e[7]=o=>n(a).ranking_score=o),size:"small",min:0,max:1,step:.001},null,8,["modelValue"])])]),_:1})]),_:1},8,["model"]),s(E),l("div",be,[s(h,{class:"flex-1 !rounded-full !h-[50px] w-[98px]",onClick:e[8]||(e[8]=o=>V())},{default:t(()=>[...e[12]||(e[12]=[m("取消",-1)])]),_:1}),s(h,{type:"primary",class:"flex-1 !rounded-full !h-[50px] w-[98px]",onClick:z},{default:t(()=>[...e[13]||(e[13]=[m(" 保存 ",-1)])]),_:1})])])]),_:1},512)}}});export{Ie as _};
