import{d as z,bO as P,aF as q,r as C,o as H,k as s,l as i,Z as a,m as n,q as o,s as l,$ as K,v as r,aI as R,I as b,J as c,K as G,t as J,Y as O,L as p,bM as Y,bS as w,G as A,ax as Z,au as Q,y as X,ba as ee,cW as te,u as oe,_ as se}from"./entry.2beb4577.js";import{E as ae}from"./index.47b30189.js";import{E as ne,a as le}from"./index.6beaca44.js";import{E as ie}from"./el-empty.bc763313.js";import{_ as re}from"./index.vue.5646543a.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                 */import{u as pe}from"./usePaging.85211d66.js";import{k as de,l as ce}from"./sph.d6d2831a.js";import{SidebarTypeEnum as k}from"./index.4596121c.js";import me from"./create-panel.c36f3f26.js";import{_ as ue}from"./detail.vue.59ac8c35.js";import"./_baseIteratee.70cb6d8d.js";import"./debounce.dd7f88c1.js";import"./toNumber.c824a4a2.js";import"./index.9d200730.js";import"./raf.c0777355.js";import"./index.4d719c96.js";import"./index.dcd97a19.js";import"./strings.a9740cf6.js";import"./clamp.a46ea567.js";import"./index.3d6ad44d.js";import"./index.e8be04c0.js";import"./index.a9d48d33.js";import"./cloneDeep.a23e4277.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./el-date-picker-panel.fc0da86b.js";import"./customParseFormat.7d9a8b8e.js";import"./panel-time-pick.d62e59d0.js";import"./index.ed72cac8.js";import"./el-time-picker.6b0df02f.js";import"./el-switch.be9dc874.js";import"./index.vue.478e85a5.js";/* empty css                  */import"./remark-pop.vue.48be7db9.js";import"./useCreateTask.8448275e.js";import"./useDictOptions.8db81bce.js";import"./device.b7e58507.js";import"./person_wechat.8bcf26fc.js";const _e={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},fe={class:"flex-shrink-0 px-[14px]"},ye={class:"flex items-center justify-end h-[88px]"},he={class:"flex items-center gap-[14px]"},ge={class:"grow min-h-0 overflow-hidden flex flex-col"},xe={class:"grow min-h-0"},ve={key:0,class:"flex gap-x-2 justify-center"},be={class:"rounded-md px-4 py-1 bg-app-bg-4 border border-app-border-2"},ke={key:1},Ee={class:"flex items-center justify-center gap-x-2"},Ce={class:"flex justify-end items-center"},we={class:"flex justify-center items-center h-full"},Ae={class:"flex justify-center p-4"},Be=z({__name:"index",setup($e){const{query:h}=P(),B=oe(),x=q({device_code:"",wechat_no:"",channel:"",exec_type:"",name:"",status:"",page_size:20}),_=C(h.is_create=="1"&&parseInt(h.type)==k.MANUAL_ADD_WECHAT),g=C(h.is_detail=="1"&&parseInt(h.type)==k.MANUAL_ADD_WECHAT),{pager:f,getLists:d,resetPage:$}=pe({fetchFun:de,params:x}),D=()=>{_.value=!0,w({is_create:1})},S=m=>{g.value=!0,w({is_detail:1,id:m})},T=m=>({0:"bg-[#999999]",1:"bg-primary",2:"bg-[#FFBC50]",3:"bg-[#3BB840]",4:"bg-[#3BB840]"})[m],V=async m=>{B.$confirm({message:"确定删除该记录吗？",theme:"dark",onConfirm:async()=>{try{await ce({id:m}),A.msgSuccess("删除成功"),d()}catch(e){A.msgError(e||"删除失败")}}})},E=()=>{_.value=!1,g.value=!1,window.history.replaceState("","",`?type=${k.MANUAL_ADD_WECHAT}`),d()};return H(()=>{_.value||d()}),(m,e)=>{const y=Z,I=Q,L=X,M=ee,N=ae,u=ne,W=ie,j=le,F=re,U=te;return s(),i(c,null,[!a(_)&&!a(g)?(s(),i("div",_e,[n("div",fe,[o(N,null,{default:l(()=>[n("div",ye,[n("div",he,[o(I,{modelValue:a(x).name,"onUpdate:modelValue":e[1]||(e[1]=t=>a(x).name=t),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[2]||(e[2]=t=>a(d)()),onKeydown:e[3]||(e[3]=K(t=>a(d)(),["enter"]))},{append:l(()=>[o(y,{text:"",onClick:e[0]||(e[0]=t=>a(d)())},{default:l(()=>[...e[6]||(e[6]=[r(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),o(y,{type:"primary",class:"!rounded-full !h-10",onClick:D},{default:l(()=>[o(L,{name:"local-icon-add_circle",color:"#ffffff"}),e[7]||(e[7]=n("span",{class:"ml-2"},"创建任务 ",-1))]),_:1}),n("div",null,[o(M,{content:"刷新"},{default:l(()=>[o(y,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[4]||(e[4]=t=>a($)())})]),_:1})])])])]),_:1})]),n("div",ge,[n("div",xe,[R((s(),b(j,{height:"100%",data:a(f).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:l(()=>[n("div",we,[o(W,{description:"暂无数据"})])]),default:l(()=>[o(u,{prop:"name",label:"任务名称",width:"240",fixed:"left"}),o(u,{label:"执行账号","min-width":"140","show-overflow-tooltip":""},{default:l(({row:t})=>[t.wechats.length>0?(s(),i("div",ve,[(s(!0),i(c,null,G(t.wechats,v=>(s(),i("div",be,J(v.wechat_nickname),1))),256))])):(s(),i("div",ke,"-"))]),_:1}),o(u,{label:"任务状态",width:"160",align:"center"},{default:l(({row:t})=>[n("div",Ee,[n("div",{class:O(["w-[6px] h-[6px] rounded-full",T(t.status)])},null,2),n("span",null,[t.status==0?(s(),i(c,{key:0},[r("未开始")],64)):p("",!0),t.status==1?(s(),i(c,{key:1},[r("进行中")],64)):p("",!0),t.status==2?(s(),i(c,{key:2},[r("已暂停")],64)):p("",!0),t.status==3?(s(),i(c,{key:3},[r("已完成")],64)):p("",!0),t.status==4?(s(),i(c,{key:4},[r("已结束")],64)):p("",!0)])])]),_:1}),o(u,{prop:"exec_day",label:"已执行天数","min-width":"120"}),o(u,{prop:"create_time",label:"创建时间",width:"180"}),o(u,{label:"操作",width:"120",fixed:"right",align:"right"},{default:l(({row:t})=>[n("div",Ce,[o(y,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:v=>S(t.id)},{default:l(()=>[...e[8]||(e[8]=[r("详情",-1)])]),_:1},8,["onClick"]),o(y,{type:"danger",link:"",size:"small",onClick:v=>V(t.id)},{default:l(()=>[...e[9]||(e[9]=[r("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[U,a(f).loading]])]),n("div",Ae,[o(F,{modelValue:a(f),"onUpdate:modelValue":e[5]||(e[5]=t=>Y(f)?f.value=t:null),layout:"prev, pager, next",onChange:a(d)},null,8,["modelValue","onChange"])])])])):p("",!0),a(_)?(s(),b(me,{key:1,onBack:E})):p("",!0),a(g)?(s(),b(ue,{key:2,onBack:E})):p("",!0)],64)}}});const gt=se(Be,[["__scopeId","data-v-79e7d658"]]);export{gt as default};
