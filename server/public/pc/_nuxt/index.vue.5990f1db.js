import{d as y,z as v,r as p,G as x,aF as h,bz as b,k as C,l as R,q as f,s as X,m as L,Z as u}from"./entry.d7219633.js";import{k as S,l as V,m as d,n as Y}from"./drawing.7058a163.js";import{drawTypeEnumMap as E,DrawTypeEnum as _,ModelEnum as c}from"./index.fb0aa6a9.js";import B from"./useCreateForm.02078254.js";import I from"./useDrawingTask.8cf66f93.js";import H from"./result-content.20d28cd2.js";import{E as N}from"./index.f15af271.js";const z={class:"h-full relative w-full"},U={class:"px-[10px]"},P=y({__name:"index",setup(j){let o;(a=>{a[a.TXT2IMAGE=E[_.TXT2IMAGE]]="TXT2IMAGE",a[a.IMAGE2IMAGE=E[_.IMAGE2IMAGE]]="IMAGE2IMAGE"})(o||(o={}));const T=v(),{onEvent:w,setFormData:A}=B(),g=p([]),i=p(!1);w("update:formData",async a=>{if(i.value){x.msgWarning("请等待上一次任务完成");return}i.value=!0;const{type:l,type_name:k,model:m,resolution:G,model_name:D,params:r}=a,s=h({date:b().format("YYYY-MM-DD HH:mm"),prompt:r.prompt,images:[],formData:a,tags:[D,G,k]});g.value.unshift(s);try{if(m==c.HIDREAMAI){s.images=new Array(parseInt(r.img_count)).fill({url:"",loading:!0,progress:0,status:0,error:!1});const{result:t}=l==o.TXT2IMAGE?await S(r):await V(r),{processDrawingTask:e}=I({type:l,task_id:t.task_id,dataLists:s.images});await e({callback:n=>{s.images=n}})}else if(m==c.GENERAL){s.images=[{url:"",loading:!0,progress:0,status:0,error:!1}];const{result:t}=await d(r);s.images=[t.image_urls].map(e=>({url:e,loading:!1,progress:100,status:1,error:!1}))}else if(m==c.SEEDREAM){if(s.images=[{url:"",loading:!0,progress:0,status:0,error:!1}],l==o.TXT2IMAGE){const{result:t}=await d(r);s.images=[t.image_urls].map(e=>({url:e,loading:!1,progress:100,status:1,error:!1}))}if(l==o.IMAGE2IMAGE){const{result:t}=await Y(r),{processDrawingTask:e}=I({type:7,model:m,task_id:t.task_id,dataLists:s.images});await e({callback:n=>{s.images=n}})}}T.getUser()}catch{s.images=s.images.map(e=>({...e,loading:!1,progress:0,status:4,error:!0}))}finally{i.value=!1}});const M=a=>{A(a)};return(a,l)=>(C(),R("div",z,[f(u(N),null,{default:X(()=>[L("div",U,[f(H,{"result-lists":u(g),"is-all-tasks-completed":u(i),onRetry:M},null,8,["result-lists","is-all-tasks-completed"])])]),_:1})]))}});export{P as _};
