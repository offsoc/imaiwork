import{d as Z,dI as z,aF as X,A as C,r as h,o as Y,l as ee,m as s,q as o,s as l,aI as te,Z as i,I as f,bM as oe,L as x,J as le,cW as se,k as c,$ as ie,v as _,t as v,bC as I,aH as V,cy as $,G as T,y as ae,ax as ne,au as re,ba as pe,u as me,_ as de}from"./entry.ca4d3d61.js";import{E as ce}from"./index.8b07fb5c.js";import{a as ue,E as fe}from"./index.9a4d38a6.js";import{E as _e}from"./el-image.a5590741.js";import{E as ve}from"./el-empty.355e6a02.js";import{_ as xe}from"./index.vue.441733b3.js";import{_ as ge}from"./index.vue.fa049f69.js";import{E as we}from"./el-image-viewer.c57baf7b.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                 */import{u as ye}from"./usePaging.15b2220c.js";import{b as be,d as he}from"./device.b7e58507.js";import{PublishTaskTypeEnum as ke}from"./index.db2ee73f.js";import"./_baseIteratee.37ea2cef.js";import"./debounce.bdbfd9e6.js";import"./toNumber.33289b44.js";import"./index.d577d4c6.js";import"./raf.53a060df.js";import"./index.5f182cdf.js";import"./index.ab577458.js";import"./strings.5c02160d.js";import"./clamp.ba5ce84b.js";import"./throttle.da389ed1.js";const Ee={class:"h-full flex flex-col"},Ce={class:"grow min-h-0 bg-app-bg-2 rounded-[20px] flex flex-col"},Ie={class:"flex-shrink-0 px-[14px]"},Ve={class:"flex items-center justify-between h-[88px] gap-[14px]"},$e={class:"flex items-center gap-[14px]"},Te={class:"grow min-h-0"},Re={class:""},De={class:"flex justify-center p-4"},Pe=Z({__name:"publish-record",props:{type:{default:ke.VIDEO}},emits:["back","copy"],setup(Be,{emit:R}){const D=R,P=me(),B=z(),g=X({publish_id:B.publish_id,task_type:3,material_title:""}),{pager:u,getLists:m,resetPage:L}=ye({fetchFun:be,params:g}),A={0:"等待中",1:"执行中",2:"执行完成",3:"执行失败",4:"中断"},w=C(),N=C(),y=h(!1),b=h(!1),k=h([]),S=n=>I(n.publish_end).isAfter(I()),j=async n=>{var a,d;const{material_type:e,material_url:r}=n;y.value=!0,await V(),e==1&&((a=w.value)==null||a.open(),(d=w.value)==null||d.setUrl(r)),e==2&&(b.value=!0,await V(),k.value=r.split(","))},F=n=>{const{material_type:e,material_url:r}=n;e==1&&$(r),e==2&&r.split(",").forEach(d=>{$(d)})},q=n=>{P.$confirm({message:"确定删除该记录吗？",onConfirm:async()=>{try{await he(n.id),T.msgSuccess("删除成功"),m()}catch{T.msgWarning("删除失败")}}})};return Y(()=>{m()}),(n,e)=>{const r=ae,a=ne,d=re,M=pe,U=ce,p=fe,K=_e,O=ve,W=ue,G=xe,H=ge,J=we,Q=se;return c(),ee(le,null,[s("div",Ee,[s("div",Ce,[s("div",Ie,[o(U,null,{default:l(()=>[s("div",Ve,[s("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[0]||(e[0]=t=>D("back"))},[o(r,{name:"el-icon-ArrowLeft",color:"#ffffff"}),e[9]||(e[9]=s("div",{class:"text-white"},"返回",-1))]),s("div",$e,[o(d,{modelValue:i(g).material_title,"onUpdate:modelValue":e[2]||(e[2]=t=>i(g).material_title=t),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入标题",clearable:"",onClear:e[3]||(e[3]=t=>i(m)()),onKeydown:e[4]||(e[4]=ie(t=>i(m)(),["enter"]))},{append:l(()=>[o(a,{onClick:e[1]||(e[1]=t=>i(m)())},{default:l(()=>[...e[10]||(e[10]=[_(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),s("div",null,[o(M,{content:"刷新"},{default:l(()=>[o(a,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[5]||(e[5]=t=>i(L)())})]),_:1})])])])]),_:1})]),s("div",Te,[te((c(),f(W,{data:i(u).lists,height:"100%","header-row-style":{height:"62px"},"row-style":{height:"60px"}},{empty:l(()=>[o(O,{description:"暂无数据"})]),default:l(()=>[o(p,{prop:"material_title",label:"标题","min-width":"120px","show-overflow-tooltip":""},{default:l(({row:t})=>[s("div",null,v(t.material_title||"-"),1)]),_:1}),o(p,{prop:"material_subtitle",label:"正文","min-width":"160px","show-overflow-tooltip":""},{default:l(({row:t})=>[s("div",null,v(t.material_subtitle||"-"),1)]),_:1}),o(p,{label:"封面图",width:"120px"},{default:l(({row:t})=>[t.pic?(c(),f(K,{key:0,class:"h-[80px]",fit:"cover",src:t.pic,"preview-src-list":[t.pic],"preview-teleported":""},null,8,["src","preview-src-list"])):x("",!0)]),_:1}),o(p,{prop:"exec_time",label:"执行时间点",width:"180px"},{default:l(({row:t})=>[s("div",null,v(t.exec_time||"-"),1)]),_:1}),o(p,{label:"发布状态",width:"120px"},{default:l(({row:t})=>[_(v(A[t.status]||"-"),1)]),_:1}),o(p,{prop:"remark",label:"备注","min-width":"100px","show-overflow-tooltip":""},{default:l(({row:t})=>[s("div",null,v(t.remark||"-"),1)]),_:1}),o(p,{label:"操作",width:"160px",fixed:"right"},{default:l(({row:t})=>[s("div",Re,[o(a,{type:"primary",link:"",onClick:E=>j(t)},{default:l(()=>[...e[11]||(e[11]=[_("查看",-1)])]),_:1},8,["onClick"]),o(a,{type:"primary",link:"",onClick:E=>F(t)},{default:l(()=>[...e[12]||(e[12]=[_("下载",-1)])]),_:1},8,["onClick"]),t.status==1||!S(t)?(c(),f(a,{key:0,type:"danger",link:"",onClick:E=>q(t)},{default:l(()=>[...e[13]||(e[13]=[_("删除",-1)])]),_:1},8,["onClick"])):x("",!0)])]),_:1})]),_:1},8,["data"])),[[Q,i(u).loading]])]),s("div",De,[o(G,{modelValue:i(u),"onUpdate:modelValue":e[6]||(e[6]=t=>oe(u)?u.value=t:null),layout:"prev, pager, next",onChange:i(m)},null,8,["modelValue","onChange"])])])]),i(y)?(c(),f(H,{key:0,ref_key:"previewVideoRef",ref:w,onClose:e[7]||(e[7]=t=>y.value=!1)},null,512)):x("",!0),i(b)?(c(),f(J,{key:1,ref_key:"previewImageRef",ref:N,"url-list":i(k),"initial-index":0,onClose:e[8]||(e[8]=t=>b.value=!1)},null,8,["url-list"])):x("",!0)],64)}}});const it=de(Pe,[["__scopeId","data-v-576cfa40"]]);export{it as default};
