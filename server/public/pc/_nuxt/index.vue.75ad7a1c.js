import{d as q,bM as w,aF as H,r as I,o as M,Z as l,k as n,l as r,m as i,q as s,s as a,$ as G,v as p,aI as J,I as y,t as _,J as Q,L as f,Y,bK as Z,bz as T,bQ as E,u as W,G as v,ax as X,au as ee,y as te,b5 as se,cP as ae}from"./entry.d7219633.js";import{E as le}from"./index.f15af271.js";import{E as ne,a as ie}from"./index.0a6eb9ae.js";import{_ as oe}from"./index.vue.5e2341cc.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                 */import{u as de}from"./usePaging.3c53b51c.js";import{z as re,A as ue,B as ce}from"./redbook.f03a8b74.js";import{_ as pe}from"./empty.vue.2a7cc8eb.js";import{PublishTaskTypeEnum as C,SidebarTypeEnum as P}from"./index.83df7a87.js";import _e from"./publish-panel.5b9a4ad7.js";import me from"./publish-record.74bdc566.js";const fe={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},he={class:"flex-shrink-0 px-[14px]"},be={class:"flex items-center justify-end h-[88px]"},ye={class:"flex items-center gap-[14px]"},ge={class:"grow min-h-0 overflow-hidden flex flex-col"},ve={class:"grow min-h-0"},ke={key:0},xe={key:1},Ee={class:"flex items-center justify-center gap-2"},Ce={key:1},Pe={key:2},Se={key:3},Be={key:4},Ie={key:5},Te={class:"flex justify-end items-center"},Ve={class:"leading-6"},$e={class:"flex justify-center p-4"},Ge=q({__name:"index",setup(De){const{query:g}=w(),k=H({name:"",page_size:20,media_type:C.VIDEO}),{pager:h,getLists:u,resetPage:V}=de({fetchFun:re,params:k}),$=o=>{const{publish_start:t,publish_end:d}=o;return t&&d?T(d).diff(T(t),"day")+1+"天":"-"},m=I(g.is_publish=="1"&&parseInt(g.type)==P.PUBLISH_VIDEO_TASK),S=()=>{m.value=!0,E({is_publish:1})},B=()=>{m.value=!1,b.value=!1,window.history.replaceState("","",`?type=${P.PUBLISH_VIDEO_TASK}`),u()},D=async o=>{W().$confirm({message:"是否删除该任务？",theme:"dark",onConfirm:async()=>{try{await ue({id:o}),v.msgSuccess("删除成功"),u()}catch(t){v.msgError(t||"删除失败")}}})},z=async o=>{try{await ce({id:o.id,status:o.status==4?1:4}),v.msgSuccess("操作成功"),u()}catch(t){v.msgError(t||"操作失败")}},L=o=>{m.value=!0,E({is_publish:1,publish_id:o.publish_id,material_id:o.video_setting_id})},b=I(g.is_record=="1"&&parseInt(g.type)==P.PUBLISH_VIDEO_TASK),K=o=>{b.value=!0,E({is_record:1,publish_id:o.id})};return M(()=>{!m.value&&!b.value&&u()}),(o,t)=>{const d=X,O=ee,j=te,A=se,F=le,c=ne,N=ie,R=oe,U=ae;return!l(m)&&!l(b)?(n(),r("div",fe,[i("div",he,[s(F,null,{default:a(()=>[i("div",be,[i("div",ye,[s(O,{modelValue:l(k).name,"onUpdate:modelValue":t[1]||(t[1]=e=>l(k).name=e),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:t[2]||(t[2]=e=>l(u)()),onKeydown:t[3]||(t[3]=G(e=>l(u)(),["enter"]))},{append:a(()=>[s(d,{text:"",onClick:t[0]||(t[0]=e=>l(u)())},{default:a(()=>t[6]||(t[6]=[p(" 搜索 ",-1)])),_:1,__:[6]})]),_:1},8,["modelValue"]),s(d,{type:"primary",class:"!rounded-full !h-10 !w-[116px]",onClick:S},{default:a(()=>[s(j,{name:"local-icon-add_circle",color:"#ffffff"}),t[7]||(t[7]=i("span",{class:"ml-2"},"发布视频",-1))]),_:1,__:[7]}),i("div",null,[s(A,{content:"刷新"},{default:a(()=>[s(d,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:t[4]||(t[4]=e=>l(V)())})]),_:1})])])])]),_:1})]),i("div",ge,[i("div",ve,[J((n(),y(N,{height:"100%",data:l(h).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:a(()=>[i("div",Ve,[s(pe,{"btn-text":"发布视频",msg:"快去发布你的专属视频吧","custom-click":S})])]),default:a(()=>[s(c,{prop:"name",label:"任务名称",width:"240",fixed:"left"}),s(c,{label:"发布账号","min-width":"200"},{default:a(({row:e})=>[e.account?(n(),r("div",ke,[p(_(e.account)+" ",1),e.nickname?(n(),r(Q,{key:0},[p(" ("+_(e.nickname)+") ",1)],64)):f("",!0)])):(n(),r("div",xe,"-"))]),_:1}),s(c,{label:"任务状态",width:"120"},{default:a(({row:e})=>[i("div",Ee,[e.status!=0?(n(),r("div",{key:0,class:Y(["w-[6px] h-[6px] rounded-full",{"bg-primary":e.status==1,"bg-[#3BB840]":e.status==2,"bg-danger":e.status==3,"bg-[#FFBC50]":e.status==4}])},null,2)):f("",!0),e.status==0?(n(),r("div",Ce,"未开启")):e.status==1?(n(),r("div",Pe,"进行中")):e.status==2?(n(),r("div",Se,"已完成")):e.status==3?(n(),r("div",Be,"已删除")):e.status==4?(n(),r("div",Ie,"暂停中")):f("",!0)])]),_:1}),s(c,{label:"发布周期","min-width":"100"},{default:a(({row:e})=>[i("div",null,_($(e)),1)]),_:1}),s(c,{prop:"next_publish_time",label:"下组视频发布点",width:"180"},{default:a(({row:e})=>[i("div",null,_(e.next_publish_time||"-"),1)]),_:1}),s(c,{label:"发布进度",width:"140"},{default:a(({row:e})=>[p(_(e.published_count)+" / "+_(e.count),1)]),_:1}),s(c,{prop:"create_time",label:"创建时间",width:"180"}),s(c,{label:"操作",width:"180",fixed:"right",align:"right"},{default:a(({row:e})=>[i("div",Te,[e.status==1||e.status==4?(n(),y(d,{key:0,class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>z(e)},{default:a(()=>[p(_(e.status==1?"暂停":"继续"),1)]),_:2},1032,["onClick"])):f("",!0),e.status==0?(n(),y(d,{key:1,class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>L(e)},{default:a(()=>t[8]||(t[8]=[p("编辑",-1)])),_:2,__:[8]},1032,["onClick"])):f("",!0),s(d,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>K(e)},{default:a(()=>t[9]||(t[9]=[p("详情",-1)])),_:2,__:[9]},1032,["onClick"]),s(d,{type:"danger",link:"",size:"small",onClick:x=>D(e.id)},{default:a(()=>t[10]||(t[10]=[p("删除",-1)])),_:2,__:[10]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[U,l(h).loading]])]),i("div",$e,[s(R,{modelValue:l(h),"onUpdate:modelValue":t[5]||(t[5]=e=>Z(h)?h.value=e:null),layout:"prev, pager, next",onChange:l(u)},null,8,["modelValue","onChange"])])])])):l(m)?(n(),y(_e,{key:1,type:l(C).VIDEO,onBack:B},null,8,["type"])):l(b)?(n(),y(me,{key:2,type:l(C).VIDEO,onBack:B},null,8,["type"])):f("",!0)}}});export{Ge as _};
