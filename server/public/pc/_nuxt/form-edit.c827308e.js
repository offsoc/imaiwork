import{a as D,E as M}from"./index.52e544f1.js";import{d as P,A as w,r as c,c as X,aF as j,k as u,l as v,q as a,s,Z as e,J as T,K as C,I as d,au as p,L as H,m as J,v as I,t as G,bK as Q,$ as W,cP as Y,aH as ee,av as le,ax as oe,ay as te}from"./entry.46557796.js";import{E as ae}from"./index.c76cd001.js";import{E as ne}from"./el-switch.03413428.js";/* empty css                  *//* empty css               *//* empty css                     */import{FieldTypeEnum as _,FieldTypeMap as se}from"./formEnums.87727bf8.js";import"./index.304400de.js";import"./strings.1c189114.js";import"./debounce.22e3311f.js";import"./_baseIteratee.6084bee0.js";import"./index.1d76ef55.js";const ue={class:"edit-popup"},re={class:"flex gap-2"},Re=P({__name:"form-edit",emits:["success","close"],setup(de,{expose:U,emit:F}){const x=F,h=w(),V=w(),g=c("add"),B=X(()=>g.value=="edit"?"编辑表单":"新增表单"),y=c([]),o=j({name:_.TEXT,field:"",title:"",placeholder:"",rows:4,options:[],maxlength:200,isRequired:!1}),S={field:[{required:!0,message:"请输入字段值",trigger:["blur"]},{pattern:/^(?!^\d)(?!.*?_$)[A-Za-z_$][A-Za-z\d_$]*$/,message:"字段值格式不正确",trigger:["change"]},{validator(r,l,m){y.value.some(n=>n.field==o.field)?m(new Error("字段不能重复，请修改")):m()},trigger:"change"}],title:[{required:!0,message:"请输入字段名称",trigger:["blur"]}]},i=c(""),E=c(!1),R=c(),$=r=>{o.options.splice(o.options.indexOf(r),1)},q=()=>{E.value=!0,ee(()=>{R.value.input.focus()})},k=()=>{i.value&&o.options.push(i.value),E.value=!1,i.value=""},A=async()=>{var r,l;await((r=h.value)==null?void 0:r.validate()),(l=V.value)==null||l.close(),x("success",{data:o,type:g.value})},L=r=>{var f;const{data:l,lists:m}=r;y.value=m,g.value=l?"edit":"add",l&&Object.keys(o).forEach(n=>{o[n]=l[n]}),(f=V.value)==null||f.open()},O=()=>{x("close")};return U({open:L}),(r,l)=>{const m=M,f=D,n=le,z=ae,K=oe,N=ne,Z=te;return u(),v("div",ue,[a(Y,{ref_key:"popupRef",ref:V,title:e(B),async:!0,width:"550px",onConfirm:A,onClose:O},{default:s(()=>[a(Z,{ref_key:"formRef",ref:h,model:e(o),"label-width":"100px","label-position":"top",rules:S},{default:s(()=>[a(n,{label:"字段类型"},{default:s(()=>[a(f,{modelValue:e(o).name,"onUpdate:modelValue":l[0]||(l[0]=t=>e(o).name=t),placeholder:"请输入字段类型",clearable:""},{default:s(()=>[(u(!0),v(T,null,C(e(se),(t,b)=>(u(),d(m,{key:b,label:t,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段名称",prop:"title"},{default:s(()=>[a(e(p),{modelValue:e(o).title,"onUpdate:modelValue":l[1]||(l[1]=t=>e(o).title=t),placeholder:"请输入字段名称",maxlength:"100",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"字段值",prop:"field"},{default:s(()=>[a(e(p),{modelValue:e(o).field,"onUpdate:modelValue":l[2]||(l[2]=t=>e(o).field=t),placeholder:"字段值允许包含数字、字母、下划线_、美元符号$，且必须唯一",maxlength:"100",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"占位文字",prop:"placeholder"},{default:s(()=>[a(e(p),{modelValue:e(o).placeholder,"onUpdate:modelValue":l[3]||(l[3]=t=>e(o).placeholder=t),placeholder:"请输入占位文字",maxlength:"100",clearable:""},null,8,["modelValue"])]),_:1}),e(o).name==e(_).TEXTAREA?(u(),d(n,{key:0,label:"默认行数"},{default:s(()=>[a(e(p),{modelValue:e(o).rows,"onUpdate:modelValue":l[4]||(l[4]=t=>e(o).rows=t),type:"number",placeholder:"请输入默认行数",max:20},null,8,["modelValue"])]),_:1})):H("",!0),[e(_).MULTIPLE,e(_).SELECT].includes(e(o).name)?(u(),d(n,{key:1,label:"选项"},{default:s(()=>[J("div",re,[(u(!0),v(T,null,C(e(o).options,t=>(u(),d(z,{key:t,closable:"","disable-transitions":!1,onClose:b=>$(t)},{default:s(()=>[I(G(t),1)]),_:2},1032,["onClose"]))),128)),e(E)?(u(),d(e(p),{key:0,ref_key:"InputRef",ref:R,modelValue:e(i),"onUpdate:modelValue":l[5]||(l[5]=t=>Q(i)?i.value=t:null),size:"small",onKeyup:W(k,["enter"]),maxlength:"50",onBlur:k},null,8,["modelValue"])):(u(),d(K,{key:1,size:"small",onClick:q},{default:s(()=>l[8]||(l[8]=[I(" + 添加选项 ",-1)])),_:1,__:[8]}))])]),_:1})):(u(),d(n,{key:2,label:"最大输入长度",prop:"maxlength"},{default:s(()=>[a(e(p),{modelValue:e(o).maxlength,"onUpdate:modelValue":l[6]||(l[6]=t=>e(o).maxlength=t),type:"number",placeholder:"请输入最大输入长度",max:200},null,8,["modelValue"])]),_:1})),a(n,{label:"是否必填"},{default:s(()=>[a(N,{modelValue:e(o).isRequired,"onUpdate:modelValue":l[7]||(l[7]=t=>e(o).isRequired=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{Re as default};
