import{d as w,r as _,G as E,aF as k,bz as x,k as p,l as u,q as d,s as f,m as t,Z as r,L as D,_ as I}from"./entry.46557796.js";import{j as A}from"./drawing.7058a163.js";import{drawTypeEnumMap as F,DrawTypeEnum as b,FashionImageTypeEnum as C}from"./index.fb0aa6a9.js";import H from"./useCreateForm.91aa09b3.js";import M from"./useDrawingTask.323114d7.js";import N from"./result-content.ed816fb5.js";import{E as T}from"./index.304400de.js";import"./cloneDeep.18da6720.js";import"./el-image.663be0a1.js";import"./el-image-viewer.4c392e93.js";import"./throttle.f2fe0ca7.js";import"./debounce.22e3311f.js";import"./position.bb07cf08.js";import"./index.vue.4fd7b3ea.js";import"./useCopy.84a3fbb4.js";import"./index.vue.7b7084b3.js";const O={class:"h-full relative w-full"},S={class:"px-[10px]"},j={class:"z-[22] absolute top-4 left-0 w-full flex px-4"},G={class:"flex flex-col items-center gap-5 mt-2"},L={class:"create-image-item"},R=["src"],Y={key:0,class:"create-image-item"},B=["src"],V={class:"create-image-item"},z=["src"],P=w({__name:"index",setup(W){let l;(s=>{s[s.FASHION_IMAGE=F[b.FASHION_IMAGE]]="FASHION_IMAGE"})(l||(l={}));const{onEvent:g,setFormData:h}=H(),c=_([]),o=_(!1);g("update:formData",async s=>{if(o.value){E.msgWarning("请等待上一次任务完成");return}o.value=!0;const{type_name:n,params:e}=s,a=k({date:x().format("YYYY-MM-DD HH:mm"),tags:[n],images:[],formData:s});c.value.unshift(a);try{a.images=new Array(parseInt(e.img_count)).fill({url:"",loading:!0,progress:0,status:0,error:!1});const{result:m}=await A(e),{processDrawingTask:i}=M({type:l.FASHION_IMAGE,task_id:m.task_id,dataLists:a.images});await i({callback:y=>{a.images=y}})}catch{a.images=a.images.map(i=>({...i,loading:!1,progress:0,status:4,error:!0}))}finally{o.value=!1}});const v=s=>{h(s)};return(s,n)=>(p(),u("div",O,[d(r(T),null,{default:f(()=>[t("div",S,[d(N,{"result-lists":r(c),"is-all-tasks-completed":r(o),onRetry:v},{"add-content":f(({item:e})=>[t("div",j,[t("div",G,[t("div",L,[t("img",{src:e.formData.params.upper_clothes,class:"w-full h-full object-contain"},null,8,R)]),e.formData.type==r(C).UPPER_LOWER_CLOTHES?(p(),u("div",Y,[t("img",{src:e.formData.params.lower_clothes,class:"w-full h-full object-contain"},null,8,B)])):D("",!0),t("div",V,[t("img",{src:e.formData.params.persons[0],class:"w-full h-full object-contain"},null,8,z)])])])]),_:1},8,["result-lists","is-all-tasks-completed"])])]),_:1})]))}});const cs=I(P,[["__scopeId","data-v-e80fd615"]]);export{cs as default};
