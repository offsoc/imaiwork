import{d as ae,z as re,aG as ce,r as w,A as de,c as B,cq as ie,G as D,D as ue,k as s,l as a,m as n,q as x,s as p,Z as e,a0 as pe,J as E,K as I,I as m,L as v,v as b,t as V,cr as G,c7 as C,bw as me,au as _e,y as fe,av as ye,ay as xe,ax as ve,_ as Ee}from"./entry.d7219633.js";import{_ as he}from"./index.55703cf7.js";import{E as ke}from"./index.f15af271.js";import{E as ge}from"./el-image.37ed17f2.js";import{E as we}from"./el-empty.77af023a.js";import{_ as be}from"./index.dcf52bcb.js";/* empty css                     */import"./el-image-viewer.960ba8e6.js";import{u as Fe}from"./useCopy.8e0a0b1f.js";import{c as Ie}from"./agent.a3fcedc5.js";import{FormFieldTypeEnum as c}from"./index.11e2700c.js";import"./index.3adcf74a.js";import"./index.9efd0300.js";import"./cloneDeep.1f319c9b.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./position.cb246d7d.js";import"./throttle.70466628.js";import"./debounce.085e8a4a.js";const Ve={class:"w-full h-full flex"},Ce={class:"w-[350px] flex-shrink-0 border-r-[1px] border-[#0000000d] py-4 flex flex-col"},Se={class:"grow min-h-0"},Ue={class:"px-4"},Ne={class:"h-[111px] rounded-md flex flex-col items-center justify-center relative leading-5"},Re={class:"mt-3 flex justify-center"},ze={class:"flex-1"},Le={class:"p-4"},Oe={class:"flex flex-col gap-y-3"},je={class:"flex items-center justify-between px-[15px] h-[52px] border-b-[1px] border-[#0000000d]"},Ae={class:"flex items-center gap-x-3"},Be={class:"px-2 py-[2px] bg-[#F2F2F2] rounded"},De={class:"py-4 px-[14px] flex flex-col gap-2"},Ge=["src"],Te={key:2,class:"flex justify-end mt-2"},Je={key:1,class:"break-all"},Me={key:1,class:"h-full flex items-center justify-center"},qe={key:1,class:"h-full flex items-center justify-center"},$e=ae({__name:"index",props:{detail:{default:()=>({})},result:{default:()=>({})}},emits:["success"],setup(T,{emit:J}){const y=T,M=J,q=re(),{userTokens:$}=ce(q),{copy:P}=Fe(),d=w({}),S=de(),U=w({}),K=B(()=>{if(!y.detail)return[];let{inputs:o}=y.detail;return o=C(o)?JSON.parse(o):[],o.forEach(t=>{if(d.value[t.fields]=t.value,t.required==="true"){const u=t.type===c.FILE;U.value[t.fields]=[{required:!0,message:u?"请上传文件":"请输入",trigger:u?"change":"blur"}]}}),o}),_=B(()=>{if(!y.detail)return{};const o=C(y.detail.outputs)?JSON.parse(y.detail.outputs):[],t={};return o.forEach(u=>{t[u.fields]={...u}}),t}),W=o=>o?me(o)?o:[o]:[],X=(o,t)=>{d.value[t]=o.data.uri},Z=(o,t)=>{d.value[t]=""},h=w(null),F=w(!1),{lockFn:H,isLock:Q}=ie(async()=>{var o;if($.value<=1){D.msgPowerInsufficient();return}await((o=S.value)==null?void 0:o.validate());try{F.value=!0;const t=await Ie({id:y.detail.id,...d.value});h.value=t,M("success",t)}catch(t){D.msgError(t)}finally{F.value=!1}});return ue(()=>y.result,o=>{if(o){const{content:t}=o;h.value=C(t)?JSON.parse(t):t}},{immediate:!0}),(o,t)=>{const u=_e,Y=fe,ee=he,te=ye,oe=xe,N=ke,k=ve,se=ge,le=we,ne=be;return s(),a("div",Ve,[n("div",Ce,[n("div",Se,[x(N,null,{default:p(()=>[n("div",Ue,[x(oe,{ref_key:"formRef",ref:S,model:e(d),rules:e(U),"label-position":"top",onSubmit:t[0]||(t[0]=pe(()=>{},["prevent"]))},{default:p(()=>[(s(!0),a(E,null,I(e(K),(l,i)=>(s(),m(te,{key:i,label:l.name,prop:l.fields},{default:p(()=>[l.type===e(c).INPUT?(s(),m(u,{key:0,modelValue:e(d)[l.fields],"onUpdate:modelValue":r=>e(d)[l.fields]=r,class:"!h-11",clearable:"",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),l.type===e(c).TEXTAREA?(s(),m(u,{key:1,modelValue:e(d)[l.fields],"onUpdate:modelValue":r=>e(d)[l.fields]=r,clearable:"",placeholder:"请输入",type:"textarea",resize:"none",maxlength:1e3,rows:5},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),l.type===e(c).NUMBER?(s(),m(u,{key:2,modelValue:e(d)[l.fields],"onUpdate:modelValue":r=>e(d)[l.fields]=r,type:"number",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])):v("",!0),l.type===e(c).VIDEO||l.type===e(c).IMAGE||l.type===e(c).FILE?(s(),m(ee,{key:3,class:"w-full",drag:"",type:l.type,"list-type":"text",limit:1,"max-size":500,onRemove:r=>Z(r,l.fields),onSuccess:r=>X(r,l.fields)},{default:p(()=>[n("div",Ne,[x(Y,{name:"local-icon-file_add",size:36,color:"#000000"}),t[1]||(t[1]=n("span",{class:"text-gray-500 text-xs mt-2"},"点击或将文件拖拽到这里上传",-1))])]),_:2},1032,["type","onRemove","onSuccess"])):v("",!0)]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])])]),_:1})]),n("div",Re,[x(k,{color:"#000000",class:"!h-[50px] w-[276px] !rounded-xl",loading:e(Q),onClick:e(H)},{default:p(()=>t[2]||(t[2]=[b(" 立即运行 ",-1)])),_:1,__:[2]},8,["loading","onClick"])])]),n("div",ze,[e(F)?(s(),a("div",qe,[x(ne)])):(s(),a(E,{key:0},[e(h)?(s(),m(N,{key:0},{default:p(()=>[n("div",Le,[n("div",Oe,[(s(!0),a(E,null,I(e(h),(l,i)=>{var r,R,z;return s(),a("div",{key:i,class:"border border-[#0000000d] rounded-xl"},[n("div",je,[n("div",Ae,[n("span",null,V(((r=e(_)[i])==null?void 0:r.name)||"-"),1),n("span",Be,V((R=e(_)[i])==null?void 0:R.type),1)]),((z=e(_)[i])==null?void 0:z.type)==e(c).FILE?(s(),m(k,{key:0,color:"#000000",size:"small",onClick:f=>{var g;return("downloadFile"in o?o.downloadFile:e(G))(l,(g=e(_)[i])==null?void 0:g.name)}},{default:p(()=>t[3]||(t[3]=[b(" 下载 ",-1)])),_:2,__:[3]},1032,["onClick"])):(s(),m(k,{key:1,color:"#000000",size:"small",onClick:f=>e(P)(l)},{default:p(()=>t[4]||(t[4]=[b("复制",-1)])),_:2,__:[4]},1032,["onClick"]))]),n("div",De,[(s(!0),a(E,null,I(W(l),(f,g)=>{var L,O,j;return s(),a("div",{key:g},[[e(c).VIDEO,e(c).IMAGE].includes((L=e(_)[i])==null?void 0:L.type)?(s(),a(E,{key:0},[((O=e(_)[i])==null?void 0:O.type)==e(c).VIDEO?(s(),a("video",{key:0,src:f,class:"w-full max-h-[200px] rounded-[10px]",controls:""},null,8,Ge)):v("",!0),((j=e(_)[i])==null?void 0:j.type)==e(c).IMAGE?(s(),m(se,{key:1,src:f,fit:"cover",class:"w-full rounded-[10px]","preview-src-list":[f],"preview-teleported":""},null,8,["src","preview-src-list"])):v("",!0),f?(s(),a("div",Te,[x(k,{color:"#000000",size:"small",onClick:Pe=>{var A;return("downloadFile"in o?o.downloadFile:e(G))(f,((A=e(_)[i])==null?void 0:A.name)||"")}},{default:p(()=>t[5]||(t[5]=[b("下载",-1)])),_:2,__:[5]},1032,["onClick"])])):v("",!0)],64)):(s(),a("span",Je,V(f),1))])}),128))])])}),128))])])]),_:1})):(s(),a("div",Me,[x(le)]))],64))])])}}});const mt=Ee($e,[["__scopeId","data-v-3eb271fc"]]);export{mt as default};
