import{E as M,a as Y}from"./el-breadcrumb.23df9e4a.js";import{d as Z,r as p,o as G,k as n,l as c,m as i,q as f,s as d,Y as R,Z as o,t as g,I as y,L as m,cr as X,v as L,aI as tt,J as S,K as et,bO as P,aH as B,dI as st,ax as ot,y as at,cW as it,u as nt,_ as rt}from"./entry.f4f46cb5.js";import{ak as lt,an as pt,ao as ct}from"./person_wechat.703f63bb.js";import{_ as mt}from"./send-name.vue.12832a27.js";import{_ as ut}from"./send-way.vue.f73b6c3c.js";import{_ as dt}from"./send-container.vue.41d34a41.js";import _t from"./useTask.c24b3453.js";import{PushTypeEnum as j}from"./index.a1206616.js";import"./index.ed825429.js";import"./index.bad4fd13.js";import"./index.03679949.js";import"./strings.87cef2c7.js";import"./_baseIteratee.0f37ae7b.js";import"./toNumber.d5c70aa7.js";import"./clamp.6295a89e.js";import"./index.d4d0dc47.js";import"./el-date-picker-panel.31ae2123.js";import"./customParseFormat.6a4fc492.js";import"./panel-time-pick.d45c81c7.js";import"./index.87d72f66.js";import"./debounce.640f3738.js";/* empty css                  *//* empty css               *//* empty css                     */import"./el-empty.28f9091a.js";import"./7_day.257301c1.js";import"./material-edit.91e90493.js";import"./el-input-number.1ee836d6.js";import"./el-time-picker.87d58762.js";import"./index.d7101a01.js";/* empty css                  */import"./add-content.d4e61971.js";import"./el-tabs.5c0d0dcf.js";import"./raf.787400b1.js";import"./index.6f68e864.js";import"./el-alert.7a5c1271.js";import"./index.25e18e1c.js";import"./index.vue.cb61de56.js";import"./index.71dc546d.js";import"./index.b2901b1d.js";import"./index.26e6fbc6.js";import"./cloneDeep.3fe36a61.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./el-image.01a57254.js";import"./el-image-viewer.c352c3bd.js";import"./throttle.a2681779.js";import"./index.vue.b711ba9e.js";/* empty css                   */import"./arrow_down.70a5466c.js";import"./dom.7f5b5a10.js";import"./index.cf59f1a8.js";import"./emoji.vue.d23f13fc.js";import"./useHandle.560e2f4a.js";import"./mini-program-card.vue.44c1fcac.js";import"./material-picker.vue.c8c40833.js";import"./index.vue.69f36fe8.js";import"./sidebar.192f863c.js";import"./useMaterial.7ff6fcd0.js";import"./usePaging.64f4ceb2.js";import"./container.680208a5.js";import"./index.vue.f3f2b692.js";import"./upload.8e503fac.js";import"./preview.vue.b5d399a7.js";import"./link-card.vue.07f8b073.js";import"./file-card.vue.6f668f51.js";import"./send-date.vue.d7c9e266.js";import"./file-item.vue.24289673.js";import"./send-date-preview.vue.32003375.js";import"./send-container-item.74c13f58.js";import"./date.95a59cef.js";const ft={class:"h-full flex flex-col"},yt={class:"flex items-center justify-between bg-white p-4 rounded-lg flex-shrink-0"},vt={class:"flex justify-center"},xt={class:"grow min-h-0 bg-white rounded-xl mt-4 p-6"},ht={key:0,class:"step-container h-full flex flex-col"},kt={class:"grow min-h-0 w-[680px] flex flex-col gap-10"},gt={class:"px-8 mt-8 flex gap-4"},wt=["src"],Ct={class:"flex flex-col gap-2"},bt={class:"font-bold text-[20px]"},Et={class:"text-lg text-[#8A8C99]"},St={class:"flex justify-end px-3 mt-4"},Pt={key:0,class:"flex items-center gap-2"},Bt=["onClick"],Dt={class:"h-full"},It=Z({__name:"create-panel",emits:["back"],setup(Tt,{expose:V,emit:U}){const W=U,z=nt(),r=p("name"),{resource:w}=_t(),_=p([{img:w.CreateImg,title:"给您的SOP起个名字",desc:"请输入一个独特的名称，以便更好的管理和识别",status:0,key:"name"},{img:w.PostImg,title:"您希望以什么方式推送",desc:"请选择推送渠道，确保信息传递符合您的偏好",status:0,key:"type"},{img:w.ContentImg,title:"设置您需要推送的内容",desc:"选择并配置您希望目标对象接收的推送信息和推送类型",status:0,key:"content"}]),a=p(null),C=p(),x=p(!1),D=p(),b=p(),K=async e=>{x.value=!1,await v((e==null?void 0:e.id)||a.value.id),P({id:(e==null?void 0:e.id)||a.value.id})},Q=async()=>{await v(a.value.id),lt({id:a.value.id,type:a.value.type,flow_id:a.value.flow_id,stage_id:a.value.stage_id,push_type:a.value.push_type,status:2})},q=async e=>{var s,k;r.value=e.key;const{key:t}=e;t=="name"?(x.value=!0,await B(),(s=C.value)==null||s.open(),a.value&&((k=C.value)==null||k.setFormData(a.value))):t=="type"?await $():t=="content"&&T(),P({step:r.value})},I=()=>{W("back")},H=async()=>{await z.$confirm({message:"确定取消吗？",onConfirm:async()=>{I()}})},E=()=>{r.value="name",P({step:"name"})},h=p(!1),v=async e=>{if(e){h.value=!0;try{const t=await pt({id:e});a.value=t,t.push_name&&_.value.forEach(s=>{s.key=="name"&&(s.status=1)}),t.flow_id&&_.value.forEach(s=>{s.key=="type"&&(s.status=1)}),r.value=="type"&&$(),t.push_time_list&&t.push_time_list.length&&(T(),_.value.forEach(s=>{s.key=="content"&&(s.status=1)}))}finally{h.value=!1}}},T=async()=>{var t,s;await B(),(t=b.value)==null||t.setFormData(a.value);const e=await ct({push_id:a.value.id});(s=b.value)==null||s.setDateList(e)},$=async()=>{var e;await B(),(e=D.value)==null||e.setFormData(a.value)};return G(async()=>{const{id:e,step:t}=st();t&&_.value.some(s=>s.key==t)?r.value=t:r.value="name",e&&v(e)}),V({getDetail:v}),(e,t)=>{var A,N;const s=M,k=Y,F=ot,O=at,J=it;return n(),c(S,null,[i("div",ft,[i("div",yt,[i("div",null,[f(k,{"separator-icon":o(X)},{default:d(()=>[f(s,null,{default:d(()=>[i("span",{class:"cursor-pointer text-[#8A8C99] hover:text-primary",onClick:I}," 任务管理 ")]),_:1}),f(s,null,{default:d(()=>[i("span",{class:R({"cursor-pointer text-[#8A8C99] hover:text-primary":["type","content"].includes(o(r))}),onClick:E},g(o(a)?o(a).push_name:"新建SOP"),3)]),_:1}),o(r)=="type"?(n(),y(s,{key:0},{default:d(()=>[...t[2]||(t[2]=[i("span",null," 设置推送方式 ",-1)])]),_:1})):m("",!0),o(r)=="content"?(n(),y(s,{key:1},{default:d(()=>[...t[3]||(t[3]=[i("span",null," 设置推送内容 ",-1)])]),_:1})):m("",!0)]),_:1},8,["separator-icon"])]),i("div",vt,[f(F,{type:"primary",class:"!h-10 w-[100px] !rounded-full",onClick:H},{default:d(()=>[...t[4]||(t[4]=[L("取消",-1)])]),_:1}),o(r)!="name"?(n(),y(F,{key:0,class:"!h-10 w-[100px] !rounded-full",onClick:E},{default:d(()=>[...t[5]||(t[5]=[L("返回",-1)])]),_:1})):m("",!0)])]),tt((n(),c("div",xt,[o(h)?m("",!0):(n(),c(S,{key:0},[o(r)=="name"?(n(),c("div",ht,[i("div",kt,[(n(!0),c(S,null,et(o(_),(l,u)=>(n(),c("div",{key:u,class:"h-[149px] rounded-2xl border border-solid border-primary-light-8 relative"},[i("div",{class:R(["absolute top-0 right-0 rounded-tr-2xl rounded-bl-2xl w-[100px] p-2 text-center text-white text-lg font-bold",[l.status==1?"bg-success":"bg-primary"]])},g(l.status==1?"已设置":`第${u+1}步`),3),i("div",gt,[i("img",{src:l.img,alt:"",class:"w-[56px] h-[56px]"},null,8,wt),i("div",Ct,[i("div",bt,g(l.title),1),i("div",Et,g(l.desc),1)])]),i("div",St,[u!=0&&l.status==0&&o(_)[u-1].status==0?(n(),c("div",Pt,[t[6]||(t[6]=i("span",{class:"opacity-50 text-primary"}," 您还未完成上一步",-1)),f(O,{name:"el-icon-QuestionFilled",color:"#5580F9"})])):(n(),c("div",{key:1,class:"cursor-pointer flex items-center gap-2",onClick:Ft=>q(l)},[t[7]||(t[7]=i("span",{class:"hover:underline text-primary"},"前往设置",-1)),f(O,{name:"el-icon-Right",size:16,color:"var(--color-primary)"})],8,Bt))])]))),128))])])):m("",!0),i("div",Dt,[o(r)=="content"?(n(),y(dt,{key:0,ref_key:"sendContainerRef",ref:b,type:o(j).AUTO_SOP,"task-id":(A=o(a))==null?void 0:A.id,"push-day":(N=o(a))==null?void 0:N.push_day,onBack:E,onSuccess:Q},null,8,["type","task-id","push-day"])):m("",!0),o(r)=="type"?(n(),y(ut,{key:1,ref_key:"sendWayRef",ref:D,onSuccess:t[0]||(t[0]=l=>{var u;return v((u=o(a))==null?void 0:u.id)})},null,512)):m("",!0)])],64))])),[[J,o(h)]])]),o(x)?(n(),y(mt,{key:0,ref_key:"nameEditRef",ref:C,type:o(j).AUTO_SOP,onSuccess:K,onClose:t[1]||(t[1]=l=>x.value=!1)},null,8,["type"])):m("",!0)],64)}}});const Ge=rt(It,[["__scopeId","data-v-7d860dc5"]]);export{Ge as default};
