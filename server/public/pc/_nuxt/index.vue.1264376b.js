import{d as J,bM as Y,aF as Z,r as x,Z as o,k as n,l as i,m as t,q as a,s as r,$ as W,v as f,aI as T,J as V,K as X,Y as R,a0 as k,t as c,L as v,I as g,bQ as w,aH as P,ax as ee,au as se,y as te,b5 as oe,cQ as le,u as ne,G as ae}from"./entry.d9d53b29.js";import{E as ie}from"./index.050c9b6b.js";import{_ as re}from"./index.vue.3e248b2d.js";import{E as ce}from"./el-image.239907bf.js";/* empty css                     */import"./el-image-viewer.291603f7.js";import{u as de}from"./usePaging.64764a63.js";import{x as pe,y as ue}from"./redbook.f03a8b74.js";import{_ as fe}from"./empty.vue.98f610d2.js";import{SidebarTypeEnum as S}from"./index.83df7a87.js";import _e from"./create-panel.ac270b4c.js";import me from"./preview-video-result.b6965718.js";import{E as xe}from"./index.01064705.js";const ve={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},he={class:"flex-shrink-0 px-[14px] border-[0] border-b-[1px] border-app-border-1"},ye={class:"flex items-center justify-end h-[88px]"},ke={class:"flex items-center gap-[14px]"},ge=["infinite-scroll-disabled"],we={class:"h-full p-4"},be={key:0},Ce={class:"grid grid-cols-1 xl:grid-cols-2 gap-4"},Ee=["onClick"],$e=["onClick"],Ie={class:"flex-shrink-0 w-[143px] border border-app-border-2 overflow-hidden rounded-md bg-black"},Te={class:"flex-1 flex flex-col gap-y-[10px]"},Ve={class:"text-white break-all line-clamp-1 mr-4"},Re={class:"flex items-center gap-x-1"},Pe={class:"text-white"},Se={class:"flex items-center gap-x-1 text-white"},Be={class:"text-white"},Le={class:"text-white"},Ae={class:"flex items-center gap-x-2"},De={key:0,class:"text-white text-center text-xs w-full py-4"},Ne={key:1,class:"h-full flex items-center justify-center"},We=J({__name:"index",setup(He){const B=Y(),_=Z({name:"",page_no:1,page_size:20}),{pager:p,getLists:b,resetPage:u}=de({fetchFun:pe,params:_,isScroll:!0}),L={0:"草稿箱",1:"待处理",2:"生成中",3:"已完成",4:"失败",5:"部分完成"},A=()=>{m.value=!1,window.history.replaceState("","",`?type=${S.DIGITAL_HUMAN_CREATION}`),u()},D=()=>{_.page_no++,b()},C=x(),m=x(B.query.is_create=="1"),E=async()=>{var l;m.value=!0,w({is_create:1}),await P(),(l=C.value)==null||l.createEmptyTask()},N=async l=>{l.status==0&&(m.value=!0,w({is_create:1,create_id:l.id}))},H=async(l,e)=>{ne().$confirm({message:"确定要删除该数字人任务吗？",theme:"dark",onConfirm:async()=>{try{await ue({id:l}),p.lists.splice(e,1)}catch(d){ae.msgError(d)}}})},K=async l=>{w({type:S.PUBLISH_VIDEO_TASK,is_publish:1,dh_create_id:l}),setTimeout(()=>{window.location.reload()},500)},$=x(),h=x(!1),M=async l=>{var e;h.value=!0,await P(),(e=$.value)==null||e.open(l)};return b(),(l,e)=>{const d=ee,j=se,q=te,F=oe,U=ie,z=re,G=ce,O=le,Q=xe;return o(m)?(n(),g(_e,{key:1,ref_key:"createPanelRef",ref:C,onBack:A},null,512)):(n(),i("div",ve,[t("div",he,[a(U,null,{default:r(()=>[t("div",ye,[t("div",ke,[a(j,{modelValue:o(_).name,"onUpdate:modelValue":e[1]||(e[1]=s=>o(_).name=s),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[2]||(e[2]=s=>o(u)()),onKeydown:e[3]||(e[3]=W(s=>o(u)(),["enter"]))},{append:r(()=>[a(d,{text:"",onClick:e[0]||(e[0]=s=>o(u)())},{default:r(()=>e[7]||(e[7]=[f(" 搜索 ",-1)])),_:1,__:[7]})]),_:1},8,["modelValue"]),a(d,{type:"primary",class:"!rounded-full !h-10 !px-4",onClick:e[4]||(e[4]=s=>E())},{default:r(()=>[a(q,{name:"local-icon-add_circle",color:"#ffffff"}),e[8]||(e[8]=t("span",{class:"ml-2"},"创建批量数字人任务",-1))]),_:1,__:[8]}),t("div",null,[a(F,{content:"刷新"},{default:r(()=>[a(d,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[5]||(e[5]=s=>o(u)())})]),_:1})])])])]),_:1})]),T((n(),i("div",{class:"grow min-h-0 overflow-y-auto flex flex-col dynamic-scroller","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!o(p).isLoad,"infinite-scroll-distance":10},[T((n(),i("div",we,[o(p).lists.length?(n(),i("div",be,[t("div",Ce,[(n(!0),i(V,null,X(o(p).lists,(s,I)=>(n(),i("div",{class:R(["flex gap-x-4 h-[222px] relative overflow-hidden bg-app-bg-3 border border-app-border-2 rounded-xl p-4",{"cursor-pointer":s.status==0}]),key:I,onClick:y=>N(s)},[t("div",{class:"absolute right-2 top-2 w-6 h-6",onClick:k(y=>H(s.id,I),["stop"])},[a(z)],8,$e),t("div",Ie,[a(G,{src:s.pic,class:"w-full h-full",fit:"cover"},{error:r(()=>e[9]||(e[9]=[t("div",{class:"w-full h-full flex items-center justify-center text-white card-gradient"}," 暂无封面 ",-1)])),_:2},1032,["src"])]),t("div",Te,[t("div",Ve,[f(c(s.name),1),s.automatic_clip==1?(n(),i(V,{key:0},[f("（AI剪辑）")],64)):v("",!0)]),t("div",Re,[t("span",Pe,"生成状态："+c(s.success_num||0)+"/"+c(s.video_count||1),1),t("span",{class:R([[3,5].includes(s.status)?"text-[#3BB840]":"text-primary"])},c(L[s.status]),3)]),t("div",Se,[e[10]||(e[10]=t("span",null,"生成视频：",-1)),t("span",null,"成功"+c(s.success_num||0),1),t("span",null,"失败"+c(s.error_num||0),1)]),t("div",Be,"任务创建："+c(s.create_time),1),t("div",Le,"最新提交："+c(s.latest_submission_time),1),t("div",Ae,[a(d,{class:"!h-10 w-[126px] !border-app-border-2",color:"#1f1f1f",onClick:k(y=>M(s.id),["stop"])},{default:r(()=>e[11]||(e[11]=[f("查看视频",-1)])),_:2,__:[11]},1032,["onClick"]),s.status!=0?(n(),g(d,{key:0,type:"primary",class:"!h-10 w-[126px]",onClick:k(y=>K(s.id),["stop"])},{default:r(()=>e[12]||(e[12]=[f("发布",-1)])),_:2,__:[12]},1032,["onClick"])):v("",!0)])])],10,Ee))),128))]),o(p).isLoad?v("",!0):(n(),i("div",De,"暂无更多了~"))])):(n(),i("div",Ne,[a(fe,{"btn-text":"创建批量数字人任务",msg:"快去发布你的专属数字人吧","custom-click":()=>E()},null,8,["custom-click"])]))])),[[O,o(p).loading]])],8,ge)),[[Q,D]]),o(h)?(n(),g(me,{key:0,ref_key:"previewVideoResultRef",ref:$,onClose:e[6]||(e[6]=s=>h.value=!1)},null,512)):v("",!0)]))}}});export{We as _};
