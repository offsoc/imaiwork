import{E as L}from"./index.304400de.js";import{E as B}from"./el-empty.db5857ba.js";import{d as N,aF as V,r,A as q,cq as z,bR as j,bI as G,k as o,l as i,m as s,Z as n,I as f,s as H,J as b,K as J,q as l,a0 as K,L as C,G as h,aH as k,y as T,u as U}from"./entry.46557796.js";/* empty css                     */import{_ as Z}from"./7_day.257301c1.js";import{ae as O,af as Q,ag as W,ah as X}from"./person_wechat.8bcf26fc.js";import Y from"./material-edit.e95b77d8.js";import{_ as ee}from"./send-date.vue.e97a47b8.js";import{_ as te}from"./send-date-preview.vue.0e5d95ce.js";import se from"./send-container-item.86f96eb6.js";const ae={class:"h-full flex flex-col gap-x-4"},oe={class:"grow min-h-0 flex"},ne={class:"flex-1 flex flex-col h-full"},re={class:"flex-shrink min-h-0"},ie={class:"px-4 flex flex-col gap-y-4"},le={key:1,class:"mt-14"},ce={class:"w-[456px] flex-shrink-0"},de={class:"h-full"},me={key:0,class:"border border-primary-light-8 rounded-xl py-4 relative px-2"},pe={key:1,class:""},be=N({__name:"send-container",props:{type:{},taskId:{}},emits:["back","success"],setup(D,{expose:S,emit:P}){const g=D,c=P,I=U(),d=V({push_time_list:[]}),m=r([]),F=e=>{I.$confirm({message:"确定删除该内容吗？",onConfirm:async()=>{try{await O({content_id:e}),c("success"),h.msgSuccess("删除成功")}catch(t){h.msgError(t)}}})},p=r(!1),u=q(),M=async()=>{var e;p.value=!0,await k(),(e=u.value)==null||e.open("add")},v=async e=>{var t,_;try{const a=await Q({content_id:e});p.value=!0,await k(),(t=u.value)==null||t.open("edit"),(_=u.value)==null||_.setFormData({content_id:a.id,content:a.content,time:{order_day:a.order_day,push_time:a.push_time}})}catch(a){h.msgError(a)}},R=async e=>{try{e.content_id?await W({push_id:g.taskId,...e}):await X({push_id:g.taskId,...e}),c("success")}catch(t){h.msgError(t)}},y=r(!1);r(!1);const E=r(),$=async()=>{var e;y.value=!0,await k(),(e=E.value)==null||e.open()};z(async()=>{if(d.push_time_list.length==0){j.error("请添加内容");return}c("success"),A()});const A=()=>{c("back")};return S({setFormData:e=>G(e,d),setDateList:e=>{m.value=e}}),(e,t)=>{const _=L,a=B,w=T;return o(),i(b,null,[s("div",ae,[s("div",oe,[s("div",ne,[s("div",re,[n(d).push_time_list.length?(o(),f(_,{key:0},{default:H(()=>[s("div",ie,[(o(!0),i(b,null,J(n(d).push_time_list,(x,ue)=>(o(),f(se,{item:x,onDelete:F,onEdit:v},null,8,["item"]))),256))])]),_:1})):(o(),i("div",le,[l(a,{description:"请添加内容"})]))]),s("div",{class:"m-4 p-2 bg-primary-light-9 rounded-xl flex items-center justify-center cursor-pointer gap-x-2",onClick:K(M,["stop"])},[l(w,{name:"local-icon-add_box_fill",color:"var(--color-primary)",size:20}),t[2]||(t[2]=s("span",{class:"text-primary font-bold"}," 添加内容 ",-1))])]),s("div",ce,[t[3]||(t[3]=s("div",{class:"flex items-center gap-2 mb-4"},[s("img",{src:Z,class:"w-6 h-6"}),s("span",null,"推送日期预览")],-1)),s("div",de,[n(m).length?(o(),i("div",me,[l(ee,{"date-list":n(m),onEdit:v},null,8,["date-list"]),s("div",{class:"absolute top-1 right-1 z-40 p-1 hover:bg-primary-light-8 rounded-md cursor-pointer",onClick:$},[l(w,{name:"local-icon-fullscreen",color:"var(--color-primary)"})])])):(o(),i("div",pe,[l(a,{description:"请添加内容"})]))])])])]),n(y)?(o(),f(te,{key:0,ref_key:"sendDatePreviewRef",ref:E,"date-list":n(m),onClose:t[0]||(t[0]=x=>y.value=!1),onEdit:v},null,8,["date-list"])):C("",!0),n(p)?(o(),f(Y,{key:1,ref_key:"materialEditRef",ref:u,onSuccess:R,onClose:t[1]||(t[1]=x=>p.value=!1)},null,512)):C("",!0)],64)}}});export{be as _};
