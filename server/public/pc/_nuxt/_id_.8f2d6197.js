import{E as De,a as Pe}from"./el-breadcrumb.05cbb8bb.js";import{E as Re}from"./el-card.6eb35d3c.js";import{d as Te,bP as $e,a as Se,r as u,c as G,aF as Ne,dP as U,o as Le,k as i,l as c,m as o,q as n,s as a,v as C,t as p,Z as l,J as S,K as q,Y as M,L as y,$ as Ie,aI as Be,I as w,a0 as N,bM as Ve,G as d,em as f,aH as Fe,y as Oe,aw as je,ax as Ge,au as Ue,cW as qe,u as Me}from"./entry.ee599c70.js";import{E as He}from"./index.f36399ff.js";import{E as Ke}from"./el-avatar.1965756b.js";import{E as ze}from"./index.684b3e96.js";import{E as We}from"./el-empty.76498597.js";import{E as v,a as Xe}from"./index.ef8eb140.js";import{_ as Je}from"./index.vue.33025166.js";/* empty css                   *//* empty css               *//* empty css                 *//* empty css                     */import{u as Ye}from"./useSocialPlatform.f7c9d861.js";import{u as Ze}from"./useDeviceWs.564cc9d8.js";import{u as Qe}from"./useAddDeviceAccount.08503a23.js";import{u as et}from"./usePaging.5914886e.js";import{g as H,m as tt}from"./service.9c966dd0.js";import{h as ot}from"./device.b7e58507.js";import{_ as st}from"./device-add.vue.61ab17bb.js";import{_ as lt}from"./device-progress.vue.d4c61fff.js";import"./index.e69b4eeb.js";import"./_baseIteratee.6942dcd2.js";import"./debounce.f4735d5c.js";import"./toNumber.0872a42f.js";import"./index.0e845cb8.js";import"./raf.09011a0b.js";import"./index.8fd3c68c.js";import"./strings.32bdf471.js";import"./clamp.05cad4d6.js";import"./sph_icon.de3a3562.js";import"./useWebSocket.95c6cc65.js";import"./usePolling.9e875bbf.js";import"./index.6fe7ec27.js";/* empty css                    */const nt={class:"h-full flex flex-col p-4"},at={class:"h-[71px] px-5 flex items-center justify-between border-b border-b-[#E8E8E8]"},rt={class:"flex items-center gap-2"},it={class:"min-w-[170px] flex items-center gap-2 cursor-pointer"},ct={class:"text-[#36393F] text-lg font-bold"},dt={class:"flex flex-col"},ut={class:"flex flex-col gap-y-1 p-2 max-h-[300px] overflow-y-auto"},pt=["onClick"],mt={class:"flex justify-center py-3"},ft={key:0,class:"bg-[#F2F3F8] text-xs py-1 px-2 rounded-lg"},vt={class:"grow min-h-0 flex w-full"},_t={class:"w-[178px] bg-white border-r border-r-[#E8E8E8] flex-shrink-0"},gt={class:"flex flex-col gap-y-4 p-4"},yt=["onClick"],ht=["src"],xt={class:"flex-1 overflow-auto flex flex-col mt-4"},Et={class:"flex justify-between items-center px-4"},bt={class:"grow min-h-0 mt-4 w-full"},kt={class:"flex items-center justify-center gap-x-2"},Ct={class:"flex flex-col gap-2"},wt=["onClick"],At={class:"flex items-center justify-center"},Dt=["onClick"],Pt=["onClick"],Rt={key:0,class:"flex items-center justify-center h-full"},Tt={key:1,class:"flex items-center justify-center h-full"},$t={class:"flex justify-end p-4"},vo=Te({__name:"[id]",setup(St){const K=$e(),z=Se(),W=Me(),{socialPlatformList:X,currentSocialPlatform:L}=Ye(),A=u([]),I=u(null),h=u(!1),E=u(!1),B=u(""),J=G(()=>A.value.find(s=>s.device_code===r.device_code)),Y=G(()=>X.filter(s=>s.show)),{onEvent:Z,send:V}=Ze(),{showAddDevice:D,addDeviceLoading:Q,progressValue:ee,handleAddAccount:te,refreshAccount:oe,handleRefreshAccount:se}=Qe({send:V,onEvent:Z,onSuccess:s=>{const{msg:t,type:k,data:j}=s;switch(k){case f.GET_USER_INFO:h.value=!1,m();break;case f.OPEN_APP:case f.OPEN_PERSON_CENTER:case f.GET_ACCOUNT_INFO:case f.DATA_SEND:case f.GET_ACCOUNT_INFO_COMPLETE:B.value=t;break;default:E.value=!1,d.closeLoading();break}},onError:s=>{E.value=!0,d.closeLoading(),d.msgError(s.error)}}),le=async()=>{await F(),m()},b=u(!1),ne=async()=>{if(!b.value)try{b.value=!0;const{lists:s}=await H({status:1,device_code:r.device_code});if(s.length==0){d.msgError("暂无在线账号");return}T(s[0])}catch(s){d.msgError(s)}finally{b.value=!1}},ae=u(null),F=async()=>{const{lists:s}=await ot({page_size:999});A.value=[{device_model:"全部",device_code:""},...s]},re=async()=>{D.value=!0,await Fe(),I.value.open()},ie=s=>{E.value=!1,L.value=s,r.type=s,ue()},ce=s=>{r.device_code=s,m()},r=Ne({type:U.XHS,name:"",account:"",device_code:""}),{pager:x,getLists:m,resetParams:de,resetPage:ue}=et({fetchFun:H,params:r}),pe=s=>{z.push({path:"/app/service",query:{type:U.XHS}})},P=u(),R=u(null),O=()=>{h.value=!0,te({device_code:r.device_code,type:r.type})},T=s=>{h.value=!0,oe.value=[{id:s.id,account:s.account,type:s.type}],se(s.device_code,s.type)},me=()=>{R.value?T(R.value):O()},fe=async s=>{R.value=s,d.loading("获取名片中...",P.value),V({type:f.GET_BUSINESS_CARD,deviceId:s.device_code,appType:s.type})},ve=s=>{W.$confirm({message:"删除账号时，当前执行的任务将中断并无法继续，确定要删除该账号吗？",onConfirm:async()=>{d.loading("删除中...",P.value);try{await tt({id:s.id}),d.msgSuccess("删除成功"),m()}catch(t){d.msgError(t)}finally{d.closeLoading()}}})};return Le(async()=>{r.device_code=K.query.device_code,m()}),F(),(s,t)=>{const k=De,j=Pe,_e=Re,_=Oe,ge=je,$=Ge,ye=He,he=Ue,xe=Ke,Ee=ze,be=We,ke=Xe,Ce=Je,we=qe;return i(),c(S,null,[o("div",nt,[n(_e,{class:"!border-none !rounded-xl",shadow:"never"},{default:a(()=>[n(j,null,{default:a(()=>[n(k,null,{default:a(()=>[o("span",{class:"cursor-pointer text-[#8A8C99] hover:text-primary",onClick:t[0]||(t[0]=e=>s.$router.back())}," AI终端 ")]),_:1}),n(k,null,{default:a(()=>[...t[7]||(t[7]=[C("账号设置",-1)])]),_:1})]),_:1})]),_:1}),o("div",{class:"grow min-h-0 bg-white rounded-lg mt-4 flex flex-col overflow-hidden",ref_key:"containerRef",ref:P},[o("div",at,[o("div",null,[o("div",rt,[n(ye,{"show-arrow":!1,"popper-class":"!p-0 !min-w-[200px]  !border-none !rounded-lg !shadow-[0_0_10px_1px_rgba(0,0,0,0.1)]"},{reference:a(()=>{var e;return[o("div",it,[n(_,{name:"el-icon-ArrowDownBold"}),o("span",ct,p((e=l(J))==null?void 0:e.device_model),1)])]}),default:a(()=>[o("div",dt,[o("div",ut,[(i(!0),c(S,null,q(l(A),(e,g)=>(i(),c("div",{class:M(["break-all hover:bg-primary-light-9 rounded-lg p-2 cursor-pointer",{"bg-primary-light-9 text-primary":l(r).device_code===e.device_code}]),key:g,onClick:Ae=>ce(e.device_code)},p(e.device_model),11,pt))),128))]),n(ge,{class:"!m-0"}),o("div",mt,[n($,{type:"primary",link:"",onClick:re},{default:a(()=>[n(_,{name:"el-icon-Plus"}),t[8]||(t[8]=o("span",null,"添加设备",-1))]),_:1})])])]),_:1}),l(r).device_code?(i(),c("span",ft,"设备ID："+p(l(r).device_code),1)):y("",!0)])])]),o("div",vt,[o("div",_t,[o("div",gt,[(i(!0),c(S,null,q(l(Y),(e,g)=>(i(),c("div",{key:g,class:M(["flex items-center gap-x-3 px-4 hover:bg-primary-light-9 py-1.5 cursor-pointer",{"bg-primary-light-9":l(L)===e.type}]),onClick:Ae=>ie(e.type)},[o("img",{src:e.icon,class:"w-6 h-6"},null,8,ht),o("div",null,p(e.name),1)],10,yt))),128))])]),o("div",xt,[o("div",Et,[o("div",null,[n($,{link:"",onClick:ne,loading:l(b)},{default:a(()=>[n(_,{name:"el-icon-Refresh"}),t[9]||(t[9]=o("span",null,"刷新数据",-1))]),_:1},8,["loading"])]),n(he,{modelValue:l(r).account,"onUpdate:modelValue":t[1]||(t[1]=e=>l(r).account=e),placeholder:"搜索账号信息",class:"!w-[200px]","prefix-icon":"el-icon-Search",clearable:"",onClear:t[2]||(t[2]=e=>l(de)()),onKeyup:t[3]||(t[3]=Ie(e=>l(m)(),["enter"]))},null,8,["modelValue"])]),o("div",bt,[Be((i(),w(ke,{ref_key:"tableRef",ref:ae,data:l(x).lists,height:"100%",stripe:"","row-style":{height:"60px",cursor:"pointer"},"header-cell-style":{height:"63px"},onRowClick:pe},{empty:a(()=>[l(r).device_code?(i(),c("div",Rt,[t[15]||(t[15]=C(" 还没有账号，",-1)),n($,{type:"primary",link:"",onClick:O},{default:a(()=>[...t[14]||(t[14]=[C("点击获取设备账号信息",-1)])]),_:1})])):(i(),c("div",Tt,[n(be,{description:"暂无账号信息"})]))]),default:a(()=>[n(l(v),{label:"头像",width:"80"},{default:a(({row:e})=>[n(xe,{src:e.avatar},null,8,["src"])]),_:1}),n(l(v),{label:"账号/昵称",prop:"account","min-width":"180"},{default:a(({row:e})=>[o("div",kt,[o("div",null,[o("div",null,p(e.account),1),o("div",null,"("+p(e.nickname)+")",1)]),e.status==1?(i(),w(Ee,{key:0,type:"success"},{default:a(()=>[...t[10]||(t[10]=[C("当前账号",-1)])]),_:1})):y("",!0)])]),_:1}),n(l(v),{label:"粉丝数量",prop:"fans","min-width":"100"},{default:a(({row:e})=>[o("div",null,p(e.fans||"-"),1)]),_:1}),n(l(v),{label:"点赞数量",prop:"thumbup_collect","min-width":"100"},{default:a(({row:e})=>[o("div",null,p(e.thumbup_collect||"-"),1)]),_:1}),n(l(v),{label:"关注数量",prop:"followers","min-width":"100"},{default:a(({row:e})=>[o("div",null,p(e.followers||"-"),1)]),_:1}),n(l(v),{label:"更新时间",prop:"create_time",width:"180"}),n(l(v),{label:"操作",width:"120px",fixed:"right"},{default:a(({row:e})=>[o("div",Ct,[e.status==1?(i(),c("div",{key:0,class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:N(g=>T(e),["stop"])},[o("span",At,[n(_,{name:"el-icon-Refresh"})]),t[11]||(t[11]=o("span",null,"刷新数据",-1))],8,wt)):y("",!0),e.account_type==1&&e.status==1?(i(),c("div",{key:1,class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:N(g=>fe(e),["stop"])},[n(_,{name:"el-icon-Postcard"}),t[12]||(t[12]=o("span",null,"名片获取",-1))],8,Dt)):y("",!0),o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:N(g=>ve(e),["stop"])},[n(_,{name:"el-icon-Delete"}),t[13]||(t[13]=o("span",null,"账号移除",-1))],8,Pt)])]),_:1})]),_:1},8,["data"])),[[we,l(x).loading]])]),o("div",$t,[n(Ce,{modelValue:l(x),"onUpdate:modelValue":t[4]||(t[4]=e=>Ve(x)?x.value=e:null),onChange:l(m)},null,8,["modelValue","onChange"])])])])],512)]),l(D)?(i(),w(st,{key:0,ref_key:"addDeviceRef",ref:I,"bind-loading":l(Q),onClose:t[5]||(t[5]=e=>D.value=!1),onConfirm:le},null,8,["bind-loading"])):y("",!0),l(h)?(i(),w(lt,{key:1,"progress-value":l(ee),"progress-error":l(E),step:l(B),onClose:t[6]||(t[6]=e=>h.value=!1),onRetry:me},null,8,["progress-value","progress-error","step"])):y("",!0)],64)}}});export{vo as default};
