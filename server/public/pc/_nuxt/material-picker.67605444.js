import{d as W,as as k,aG as q,x as F,r as J,c as K,l as p,q as l,s as f,Z as s,m as e,I as w,L as E,J as C,K as Z,k as u,al as H,u as Q,y as X,_ as Y}from"./entry.d9d53b29.js";import{_ as ee}from"./index.ece7f347.js";import{E as te}from"./index.890e9d1e.js";import{E as oe}from"./el-image.239907bf.js";import{_ as ae}from"./index.vue.3e248b2d.js";/* empty css                   */import"./el-image-viewer.291603f7.js";import{u as le}from"./useTemplate.afda57ca.js";import{PublishTaskTypeEnum as r,MaterialActionType as m}from"./index.83df7a87.js";import"./index.d23c2db7.js";import"./index.cce223cb.js";import"./cloneDeep.df46b56a.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./position.0f08d59c.js";import"./throttle.cbb177ea.js";import"./debounce.39f38609.js";const se={class:"flex flex-col gap-y-2"},ie={class:"flex items-center justify-center rounded p-1 bg-[#ffffff0d]"},re={class:"type-menu-item"},ne={class:"flex items-center justify-center rounded p-1 bg-[#ffffff0d]"},ce={class:"grid grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2"},fe={class:"w-8 h-8 rounded-xl flex items-center justify-center border border-dashed border-[#ffffff1a] hover:border-[#ffffff33] cursor-pointer mb-4"},ue=["src","onClick"],de=["onClick"],pe={class:"absolute bottom-2 w-full z-[33] px-2"},me=["onClick"],ve=W({__name:"material-picker",props:k({type:{default:r.VIDEO},materialList:{default:()=>[]},maxVideoCount:{default:30},maxImageCount:{default:18},videoSize:{default:100},videoMinResolution:{default:480},videoMaxResolution:{default:1080},videoMinDuration:{default:5},videoMaxDuration:{default:600}},{materialList:{},materialListModifiers:{}}),emits:k(["update:materialList","previewVideo","importMaterial","changeMaterial"],["update:materialList"]),setup(g,{emit:D}){const I=g,n=D,{type:c,maxVideoCount:L,maxImageCount:V,videoSize:P,videoMinResolution:T,videoMaxResolution:z,videoMinDuration:R,videoMaxDuration:A}=q(I),o=F(g,"materialList"),i=J(),h=K(()=>c.value==r.VIDEO?{type:"video",limit:L.value,maxSize:P.value,videoMinWidth:T.value,videoMaxWidth:z.value,minDuration:R.value,maxDuration:A.value}:{type:"image",limit:V.value,maxSize:10}),$=a=>{const{uri:t}=a.data;c.value==r.VIDEO,i.value>-1?o.value[i.value]=t:o.value.push(t),n("update:materialList",o.value),n("changeMaterial",{type:i.value==-1?m.ADD:m.REPLACE}),i.value=-1},S=()=>{n("importMaterial",{index:i.value,type:m.REPLACE})},x=a=>{i.value=a},O=a=>{Q().$confirm({message:"确定要删除该素材吗？",theme:"dark",onConfirm:()=>{(c.value==r.VIDEO||c.value==r.IMAGE)&&o.value.splice(a,1),n("update:materialList",o.value),n("changeMaterial",{type:m.DELETE})}})},j=a=>{n("previewVideo",a)},{DefineTemplate:B,UseTemplate:M}=le();return(a,t)=>{const v=X,N=ee,b=te,G=oe,U=ae;return u(),p(C,null,[l(s(B),null,{default:f(()=>[e("div",se,[e("div",{class:"type-menu-item",onClick:S},[e("span",ie,[l(v,{name:"local-icon-import",color:"#ffffff"})]),t[1]||(t[1]=e("span",{class:"text-[#ffffffcc]"}," 素材库导入 ",-1))]),l(N,H({class:"w-full","show-progress":""},s(h),{"show-file-list":!1,onSuccess:$}),{default:f(()=>[e("div",re,[e("span",ne,[l(v,{name:"local-icon-upload",color:"#ffffff"})]),t[2]||(t[2]=e("span",{class:"text-[#ffffffcc]"}," 本地上传",-1))])]),_:1},16)])]),_:1}),e("div",ce,[o.value.length<s(h).limit?(u(),w(b,{key:0,trigger:"click",width:"212","popper-class":"!rounded-xl !bg-app-bg-2 !border-app-border-2 !p-2 choose-type-popover","show-arrow":!1},{reference:f(()=>[e("div",{class:"material-item p-[6px] cursor-pointer hover:!border-[#ffffff33]",onClick:t[0]||(t[0]=d=>x(-1))},[e("div",fe,[l(v,{name:"el-icon-Plus",color:"#ffffff"})]),t[3]||(t[3]=e("div",{class:"absolute bottom-2 w-full z-[33] px-2"},[e("div",{class:"change-material-btn"},"添加素材")],-1))])]),default:f(()=>[l(s(M))]),_:1})):E("",!0),(u(!0),p(C,null,Z(o.value,(d,_)=>(u(),p("div",{key:_,class:"material-item"},[s(c)==s(r).VIDEO?(u(),p("video",{key:0,src:d,class:"w-full h-full object-cover rounded-md",onClick:y=>j(d)},null,8,ue)):s(c)==s(r).IMAGE?(u(),w(G,{key:1,src:d,class:"w-full h-full rounded-md",fit:"cover","preview-teleported":"","preview-src-list":[d]},null,8,["src","preview-src-list"])):E("",!0),e("div",{class:"absolute top-1 right-1 z-[22] w-4 h-4 rounded-full",onClick:y=>O(_)},[l(U,{"icon-size":10})],8,de),l(b,{trigger:"click",width:"212","popper-class":"!rounded-xl !bg-app-bg-2 !border-app-border-2 !p-2 choose-type-popover","show-arrow":!1},{reference:f(()=>[e("div",pe,[e("div",{class:"change-material-btn cursor-pointer",style:{"backdrop-filter":"blur(6px)"},onClick:y=>x(_)}," 替换 ",8,me)])]),default:f(()=>[l(s(M))]),_:2},1024)]))),128))])],64)}}});const Re=Y(ve,[["__scopeId","data-v-70e275f6"]]);export{Re as default};
