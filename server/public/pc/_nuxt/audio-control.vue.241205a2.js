import{d as pe,c as j,r as i,D as ve,k as m,l as g,m as l,q as p,s as h,Z as r,t as v,a0 as D,J as z,K as H,a3 as X,L as F,Y as G,ds as k,G as x,y as fe,b5 as me,aH as I}from"./entry.46557796.js";import{E as ge}from"./index.816355b6.js";/* empty css                   */const he={class:"h-full flex items-center px-10 gap-8"},xe={class:"flex items-center gap-4"},ye={class:"grow relative"},_e={class:"absolute -bottom-[20px] left-0 text-[#27264d73] text-xs"},be={class:"w-full h-1 relative cursor-pointer progress-bar bg-primary-light-7 group"},we={class:"absolute top-0 left-0 w-full h-full flex"},Te={class:"bg-primary-light-6 min-w-[4px] mx-[2px] relative h-full"},Ee={class:"rounded-lg p-4 bg-primary-light-7 min-w-[400px] text-xs"},ke={class:"flex gap-1"},Ce={class:"text-[#585A73]"},$e={class:"text-primary font-bold"},Se={class:"text-[#585A73] mt-2 leading-[20px]"},Me={class:"absolute -bottom-[20px] right-0 text-[#27264d73] text-xs"},Le={class:"min-w-[50px]"},ze={class:"text-primary cursor-pointer"},Be={class:"flex flex-col justify-center items-center gap-5"},Pe=["onClick"],Ne=pe({__name:"audio-control",props:{music:{default:""},contentList:{default:[]}},emits:["play","pause","next","prev","end","update-time"],setup(J,{expose:K,emit:Y}){const y=Y,C=J,u=j(()=>{const{contentList:e}=C;return e.map(t=>({...t,width:0}))}),B=i(null),$=i(null),_=i(!1),b=i("1.0"),Z=["2.0","1.5","1.25","1.0","0.75"],P=j(()=>u.value.reduce((e,t)=>e+(t.End-t.Start),0)),O=(e,t)=>{if(e){const n=(e.End-e.Start)/P.value*100,d=u.value.slice(0,t).reduce((o,f)=>o+(f.End-f.Start),0)/P.value*100;return{width:`${n}%`,left:`${d}%`}}return{}},S=i(C.music),s=i(null),w=i(0);i(0);const c=i(!1),M=i("00:00"),R=i("00:00"),T=i(!1),V=i(!1),L=i(null),E=i("00:00"),A=async()=>{await I(),s.value&&(s.value.src=S.value,s.value.load())},Q=async e=>{S.value=e,await I(),A()},U=()=>{s.value&&(T.value=!0,R.value=k(s.value.duration))},ee=()=>{c.value&&s.value&&s.value.play(),T.value=!1},te=()=>{V.value=!0,T.value=!1},se=()=>V.value||!S.value?(x.msgError("无法播放音乐"),c.value=!1,!1):T.value?(x.msgError("播放器正在加载，请稍等"),c.value=!1,!1):s.value?!0:(x.msgError("播放器初始化失败"),A(),c.value=!1,!1),le=()=>{se()&&(c.value=!0,s.value.play(),y("play"))},oe=()=>{y("pause"),c.value=!1,s.value.pause()},ae=()=>{c.value?oe():le()},ne=()=>{c.value=!1,y("end")},re=e=>{const t=document.querySelector(".progress-bar");if(t){const a=t.getBoundingClientRect(),n=e.clientX-a.left,d=n/a.width*s.value.duration;L.value=u.value.find(o=>d>=o.Start/1e3&&d<o.End/1e3)||{},E.value=k(d),E.value&&(B.value.style.left=`${n}px`),$.value&&($.value.style.left=`${n}px`)}},ie=e=>{const t=document.querySelector(".progress-bar");if(t){const a=t.getBoundingClientRect(),d=(e.clientX-a.left)/a.width*100;w.value=d;const o=w.value/100*s.value.duration;N(o),W(o)}},N=e=>{u.value.forEach(t=>{let{Start:a,End:n}=t;a=Math.floor(a/1e3),n=Math.ceil(n/1e3),e>=n?t.width="100%":e>=a&&e<n?t.width=`${(e-a)/(n-a)*100}%`:t.width="0%"})},W=e=>{s.value&&(s.value.currentTime=e,M.value=k(e))},ue=()=>{s.value&&(M.value=k(s.value.currentTime),u.value.length>1?N(s.value.currentTime):w.value=s.value.currentTime/s.value.duration*100||0,y("update-time",s.value.currentTime*1e3))},q=e=>{s.value?s.value.currentTime+=e:x.msgError("当前音频未加载")},ce=e=>{s.value?(b.value=e,s.value.playbackRate=Number(e)):x.msgError("当前音频未加载")};return ve(()=>C.music,e=>{e&&Q(e)},{immediate:!0}),K({seek:W}),(e,t)=>{const a=fe,n=me,d=ge;return m(),g(z,null,[l("div",he,[l("div",xe,[l("div",null,[p(n,{content:"后退5秒"},{default:h(()=>[l("div",{onClick:t[0]||(t[0]=o=>q(-5))},[p(a,{name:"local-icon-replay5",color:"var(--color-primary)",size:24})])]),_:1})]),l("button",{class:"w-9 h-9 flex items-center justify-center bg-primary rounded-full",onClick:t[1]||(t[1]=o=>ae())},[p(a,{name:r(c)?"local-icon-music_pause":"local-icon-music_play",color:"#ffffff",size:18},null,8,["name"])]),l("div",null,[p(n,{content:"快进5秒"},{default:h(()=>[l("div",{onClick:t[2]||(t[2]=o=>q(5))},[p(a,{name:"local-icon-neplay5",color:"var(--color-primary)",size:24})])]),_:1})])]),l("div",ye,[l("div",_e,v(r(M)),1),l("div",{class:"relative py-2 group",onMousemove:D(re,["stop"]),onClick:ie},[l("div",be,[l("div",we,[(m(!0),g(z,null,H(r(u),(o,f)=>(m(),g("div",{key:f,class:"h-full absolute top-0 hover:h-[6px] z-50",style:X(O(o,f)),onMousemove:t[3]||(t[3]=de=>_.value=!0),onMouseleave:t[4]||(t[4]=de=>_.value=!1)},[l("div",Te,[l("div",{class:"absolute top-0 left-0 h-full bg-primary max-w-full",style:X({width:r(u).length==1?`${r(w)}%`:o.width})},null,4)])],36))),128))]),r(_)&&r(u).length>1?(m(),g("div",{key:0,class:"absolute -top-[20px] -translate-x-1/2 -translate-y-full",ref_key:"sectionTooltipRef",ref:$},[l("div",Ee,[l("div",ke,[l("span",Ce,v(r(E)),1),l("span",$e,v(r(L).Headline),1)]),l("div",Se,v(r(L).Summary),1)])],512)):F("",!0)]),p(n,{content:r(E)},{default:h(()=>[l("div",{class:G(["absolute h-[16px] w-[2px] bg-primary -top-[4px] invisible group-hover:visible",{"z-[8888]":r(u).length==1}]),ref_key:"timeTooltipRef",ref:B,onMousemove:t[5]||(t[5]=D(o=>_.value=!1,["stop"]))},null,34)]),_:1},8,["content"])],32),l("div",Me,v(r(R)),1)]),l("div",Le,[p(d,{placement:"top","popper-class":"!w-[105px] !min-w-[90px] !rounded-xl !py-6"},{reference:h(()=>[l("div",ze,v(r(b)=="1.0"?"倍速":`${r(b)}x`),1)]),default:h(()=>[l("div",Be,[(m(),g(z,null,H(Z,o=>l("div",{class:G(["hover:text-primary cursor-pointer",{"text-primary":r(b)==o}]),onClick:f=>ce(o)},v(o)+"x ",11,Pe)),64))])]),_:1})])]),e.music?(m(),g("audio",{key:0,ref_key:"audio",ref:s,class:"hidden",onEnded:ne,onTimeupdate:ue,onCanplay:ee,onLoadedmetadata:U,onError:te},null,544)):F("",!0)],64)}}});export{Ne as _};
