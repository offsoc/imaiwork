import{d as O,a as U,r as p,aF as W,A as X,o as ee,aH as _,f as oe,k as n,l as c,aI as N,Z as t,m as o,q as l,s as r,J as P,K as se,I as R,t as T,Y as z,dL as te,v as E,dE as ae,a8 as ie,L as M,G as B,y as ne,ax as le,cQ as re,u as de,_ as ce}from"./entry.d9d53b29.js";import{E as pe}from"./el-card.3b33bf82.js";import{E as _e}from"./index.890e9d1e.js";/* empty css                   */import{u as fe}from"./usePaging.64764a63.js";import{u as ue,i as me,T as ve}from"./useMindMap.d85e9900.js";import{b as ge,c as xe}from"./mind_map.667e7a11.js";import{_ as he}from"./fixed-btns.vue.128a5573.js";import{_ as we}from"./index.vue.d1b62bca.js";import{E as ye}from"./index.01064705.js";import"./index.3864ff87.js";import"./index.937f4495.js";import"./katex.0065138a.js";import"./index.79f7263c.js";import"./index.050c9b6b.js";import"./index.8a3302e5.js";import"./strings.fbd015b4.js";import"./debounce.39f38609.js";import"./_baseIteratee.73cb21ab.js";import"./index.4538c991.js";import"./el-slider.48c81ee5.js";import"./el-input-number.3a2d39dc.js";import"./index.3c330aca.js";/* empty css                  *//* empty css               *//* empty css                     */import"./useDictOptions.794690b5.js";import"./knowledge_base.519704cc.js";import"./common.1373bb04.js";import"./position.0f08d59c.js";import"./throttle.cbb177ea.js";const ke=["infinite-scroll-disabled"],be={class:"grow flex flex-col min-h-0"},Ce={class:"px-4 pb-4"},Ee={class:"grid grid-cols-2 gap-3 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},Me={class:"bg-[#F2F2F2] grow w-full relative"},Be={class:"p-3"},$e={class:"line-clamp-1 font-semibold pr-3 flex-shrink-0"},Le={class:"text-tx-primary text-sm"},Fe={class:"rotate-90 origin-center p-1"},Se={class:"flex flex-col gap-2"},De=["onClick"],Ne={class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg"},Pe=["onClick"],Re={key:0,class:"text-center py-4 text-gray-500"},Te={key:1,class:"w-full h-full fixed top-0 left-[9000px] opacity-0"},ze=O({__name:"index",setup(Ae){const $=U(),A=de(),f=p(),g=W({page_no:1,page_size:15}),{getLists:x,pager:d}=fe({fetchFun:ge,params:g,isScroll:!0}),I=()=>{$.push("/app/mind_map/editor")},h=p(null),w=p(!1),V=async s=>{var e,a;w.value=!0,await _(),(e=h.value)==null||e.open(),(a=h.value)==null||a.setFormData({type:"txt",fileName:s.ask,content:s.reply})},H=()=>{$.back()},K=async()=>{d.lists=[],await x(),await _(),D()},L=(s,e)=>{s?f.value=e:f.value=void 0},q=async(s,e)=>{await A.$confirm({message:"确定删除此思维导图吗？",onConfirm:async()=>{await xe({id:s}),B.msgSuccess("删除成功"),d.lists.splice(e,1)}})},F=X([]),{createCanvasPng:j}=ue(),y=p(!1),k=p(null),G=async s=>{y.value=!0,B.loading("生成中..."),await _(),(await S(k.value,d.lists[s].reply)).fit(),setTimeout(()=>{j(k.value),y.value=!1,B.closeLoading()},1e3)},S=async(s,e)=>{let a=me.create(s);await _();const u=new ve,{root:m}=u.transform(e);return a.setData(m),setTimeout(()=>{a.fit()},100),a},D=async s=>{d.lists.forEach(async(e,a)=>{await S(F.value[a],e.reply)})};p(!1);const J=async()=>{g.page_no+=1,await x()};return ee(async()=>{await x(),await _(),D()}),(s,e)=>{const a=ne,u=oe("router-link"),m=pe,b=le,Q=_e,Y=re,Z=ye;return n(),c(P,null,[N((n(),c("div",{class:"flex flex-col h-full overflow-y-auto","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!t(d).isLoad,"infinite-scroll-distance":10},[e[6]||(e[6]=o("div",{class:"text-[20px] font-bold p-4"},"思维导图",-1)),o("div",be,[o("div",Ce,[N((n(),c("div",Ee,[l(m,{shadow:"never",class:"!rounded-xl bg-white relative hover:scale-[1.02] hover:shadow-[0_14px_24px_0_rgba(0,0,0,0.05)]"},{default:r(()=>[l(u,{to:"/app/mind_map/editor",class:"flex w-full h-72 items-center justify-center flex-col gap-4 cursor-pointer"},{default:r(()=>[l(a,{name:"el-icon-Plus",color:"var(--color-primary)",size:32}),e[1]||(e[1]=o("div",{class:"text-primary"},"新增思维导图",-1))]),_:1,__:[1]})]),_:1}),(n(!0),c(P,null,se(t(d).lists,(i,C)=>(n(),R(m,{shadow:"never",class:z(["cursor-pointer !rounded-xl bg-white relative hover:scale-[1.02] hover:shadow-[0_14px_24px_0_rgba(0,0,0,0.05)] !p-0 group",[t(f)==i.id?"shadow-[0_14px_24px_0_rgba(0,0,0,0.05)]":""]]),key:C},{default:r(()=>[l(u,{to:`/app/mind_map/editor?id=${i.id}`,class:"w-full flex-grow h-72 group flex flex-col"},{default:r(()=>[o("div",Me,[(n(),c("svg",{ref_for:!0,ref_key:"mindMapContainer",ref:F,class:"w-full h-full"},null,512)),e[2]||(e[2]=o("div",{class:"absolute w-full h-full z-20 top-0 left-0"},null,-1))]),o("div",Be,[o("div",$e,T(i.ask),1),o("div",Le,T(i.create_time),1)])]),_:2},1032,["to"]),o("div",{class:z(["h-full absolute top-4 right-2 z-50 invisible group-hover:visible",[t(f)==i.id?"!visible":""]])},[l(Q,{"show-arrow":!1,"popper-class":"!w-[120px] !min-w-[120px] !p-[6px] !rounded-xl",onShow:v=>L(!0,i.id),onHide:v=>L(!1,i.id)},{reference:r(()=>[o("div",Fe,[l(a,{name:"el-icon-MoreFilled"})])]),default:r(()=>[o("div",Se,[o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg",onClick:v=>G(C)},[l(b,{link:"",icon:t(te)},{default:r(()=>e[3]||(e[3]=[E(" 导出文件 ",-1)])),_:1,__:[3]},8,["icon"])],8,De),o("div",Ne,[l(b,{link:"",icon:t(ae),onClick:v=>V(i)},{default:r(()=>e[4]||(e[4]=[E(" 训练知识库 ",-1)])),_:2,__:[4]},1032,["icon","onClick"])]),o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg",onClick:v=>q(i.id,C)},[l(b,{link:"",icon:t(ie)},{default:r(()=>e[5]||(e[5]=[E(" 删除 ",-1)])),_:1,__:[5]},8,["icon"])],8,Pe)])]),_:2},1032,["onShow","onHide"])],2)]),_:2},1032,["class"]))),128))])),[[Y,t(d).loading]])]),t(d).isLoad?M("",!0):(n(),c("div",Re,"暂无更多了"))]),l(he,{"show-add":t(g).page_no>1,onAdd:I,onBack:H,onRefresh:K},null,8,["show-add"])],8,ke)),[[Z,J]]),t(w)?(n(),R(we,{key:0,ref_key:"knbBindRef",ref:h,onClose:e[0]||(e[0]=i=>w.value=!1)},null,512)):M("",!0),t(y)?(n(),c("div",Te,[(n(),c("svg",{ref_key:"exportSvg",ref:k,class:"w-full h-full"},null,512))])):M("",!0)],64)}}});const go=ce(ze,[["__scopeId","data-v-7d08a23d"]]);export{go as default};
