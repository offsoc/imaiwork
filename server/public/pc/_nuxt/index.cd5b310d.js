import{d as O,a as Q,r as p,aF as U,A as X,o as ee,aH as f,f as oe,k as n,l as c,aI as N,Z as t,m as o,q as l,s as r,J as P,K as se,I as R,t as T,Y as z,e0 as te,v as E,dV as ae,a8 as ie,L as M,G as B,y as ne,ax as le,cW as re,u as de,_ as ce}from"./entry.ca4d3d61.js";import{E as pe}from"./el-card.d39efca2.js";import{E as fe}from"./index.655612b0.js";/* empty css                   */import{u as ue}from"./usePaging.15b2220c.js";import{u as _e,i as me,T as ve}from"./useMindMap.0314a564.js";import{b as ge,c as xe}from"./mind_map.667e7a11.js";import{_ as he}from"./fixed-btns.vue.096ce8b7.js";import{_ as we}from"./index.vue.9508e575.js";import{E as ye}from"./index.b6d81f77.js";import"./index.3864ff87.js";import"./index.937f4495.js";import"./index.5f182cdf.js";import"./index.8b07fb5c.js";import"./index.ab577458.js";import"./strings.5c02160d.js";import"./_baseIteratee.37ea2cef.js";import"./toNumber.33289b44.js";import"./clamp.ba5ce84b.js";import"./index.d577d4c6.js";import"./el-slider.ebeb6bda.js";import"./el-input-number.5d96f707.js";import"./index.4fbaf6cb.js";import"./debounce.bdbfd9e6.js";/* empty css                  *//* empty css               *//* empty css                     */import"./useDictOptions.795b1a54.js";import"./knowledge_base.519704cc.js";import"./common.1373bb04.js";import"./throttle.da389ed1.js";const ke=["infinite-scroll-disabled"],be={class:"grow flex flex-col min-h-0"},Ce={class:"px-4 pb-4"},Ee={class:"grid grid-cols-2 gap-3 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},Me={class:"bg-[#F2F2F2] grow w-full relative"},Be={class:"p-3"},$e={class:"line-clamp-1 font-semibold pr-3 flex-shrink-0"},Fe={class:"text-tx-primary text-sm"},Le={class:"rotate-90 origin-center p-1"},Se={class:"flex flex-col gap-2"},De=["onClick"],Ne={class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg"},Pe=["onClick"],Re={key:0,class:"text-center py-4 text-gray-500"},Te={key:1,class:"w-full h-full fixed top-0 left-[9000px] opacity-0"},ze=O({__name:"index",setup(Ae){const $=Q(),A=de(),u=p(),g=U({page_no:1,page_size:15}),{getLists:x,pager:d}=ue({fetchFun:ge,params:g,isScroll:!0}),I=()=>{$.push("/app/mind_map/editor")},h=p(null),w=p(!1),V=async s=>{var e,a;w.value=!0,await f(),(e=h.value)==null||e.open(),(a=h.value)==null||a.setFormData({type:"txt",fileName:s.ask,content:s.reply})},H=()=>{$.back()},K=async()=>{d.lists=[],await x(),await f(),D()},F=(s,e)=>{s?u.value=e:u.value=void 0},q=async(s,e)=>{await A.$confirm({message:"确定删除此思维导图吗？",onConfirm:async()=>{await xe({id:s}),B.msgSuccess("删除成功"),d.lists.splice(e,1)}})},L=X([]),{createCanvasPng:j}=_e(),y=p(!1),k=p(null),G=async s=>{y.value=!0,B.loading("生成中..."),await f(),(await S(k.value,d.lists[s].reply)).fit(),setTimeout(()=>{j(k.value),y.value=!1,B.closeLoading()},1e3)},S=async(s,e)=>{let a=me.create(s);await f();const _=new ve,{root:m}=_.transform(e);return a.setData(m),setTimeout(()=>{a.fit()},100),a},D=async s=>{d.lists.forEach(async(e,a)=>{await S(L.value[a],e.reply)})};p(!1);const J=async()=>{g.page_no+=1,await x()};return ee(async()=>{await x(),await f(),D()}),(s,e)=>{const a=ne,_=oe("router-link"),m=pe,b=le,W=fe,Y=re,Z=ye;return n(),c(P,null,[N((n(),c("div",{class:"flex flex-col h-full overflow-y-auto","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!t(d).isLoad,"infinite-scroll-distance":10},[e[6]||(e[6]=o("div",{class:"text-[20px] font-bold p-4"},"思维导图",-1)),o("div",be,[o("div",Ce,[N((n(),c("div",Ee,[l(m,{shadow:"never",class:"!rounded-xl bg-white relative hover:scale-[1.02] hover:shadow-[0_14px_24px_0_rgba(0,0,0,0.05)]"},{default:r(()=>[l(_,{to:"/app/mind_map/editor",class:"flex w-full h-72 items-center justify-center flex-col gap-4 cursor-pointer"},{default:r(()=>[l(a,{name:"el-icon-Plus",color:"var(--color-primary)",size:32}),e[1]||(e[1]=o("div",{class:"text-primary"},"新增思维导图",-1))]),_:1})]),_:1}),(n(!0),c(P,null,se(t(d).lists,(i,C)=>(n(),R(m,{shadow:"never",class:z(["cursor-pointer !rounded-xl bg-white relative hover:scale-[1.02] hover:shadow-[0_14px_24px_0_rgba(0,0,0,0.05)] !p-0 group",[t(u)==i.id?"shadow-[0_14px_24px_0_rgba(0,0,0,0.05)]":""]]),key:C},{default:r(()=>[l(_,{to:`/app/mind_map/editor?id=${i.id}`,class:"w-full flex-grow h-72 group flex flex-col"},{default:r(()=>[o("div",Me,[(n(),c("svg",{ref_for:!0,ref_key:"mindMapContainer",ref:L,class:"w-full h-full"},null,512)),e[2]||(e[2]=o("div",{class:"absolute w-full h-full z-20 top-0 left-0"},null,-1))]),o("div",Be,[o("div",$e,T(i.ask),1),o("div",Fe,T(i.create_time),1)])]),_:2},1032,["to"]),o("div",{class:z(["h-full absolute top-4 right-2 z-50 invisible group-hover:visible",[t(u)==i.id?"!visible":""]])},[l(W,{"show-arrow":!1,"popper-class":"!w-[120px] !min-w-[120px] !p-[6px] !rounded-xl",onShow:v=>F(!0,i.id),onHide:v=>F(!1,i.id)},{reference:r(()=>[o("div",Le,[l(a,{name:"el-icon-MoreFilled"})])]),default:r(()=>[o("div",Se,[o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg",onClick:v=>G(C)},[l(b,{link:"",icon:t(te)},{default:r(()=>[...e[3]||(e[3]=[E(" 导出文件 ",-1)])]),_:1},8,["icon"])],8,De),o("div",Ne,[l(b,{link:"",icon:t(ae),onClick:v=>V(i)},{default:r(()=>[...e[4]||(e[4]=[E(" 训练知识库 ",-1)])]),_:1},8,["icon","onClick"])]),o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg",onClick:v=>q(i.id,C)},[l(b,{link:"",icon:t(ie)},{default:r(()=>[...e[5]||(e[5]=[E(" 删除 ",-1)])]),_:1},8,["icon"])],8,Pe)])]),_:2},1032,["onShow","onHide"])],2)]),_:2},1032,["class"]))),128))])),[[Y,t(d).loading]])]),t(d).isLoad?M("",!0):(n(),c("div",Re,"暂无更多了"))]),l(he,{"show-add":t(g).page_no>1,onAdd:I,onBack:H,onRefresh:K},null,8,["show-add"])],8,ke)),[[Z,J]]),t(w)?(n(),R(we,{key:0,ref_key:"knbBindRef",ref:h,onClose:e[0]||(e[0]=i=>w.value=!1)},null,512)):M("",!0),t(y)?(n(),c("div",Te,[(n(),c("svg",{ref_key:"exportSvg",ref:k,class:"w-full h-full"},null,512))])):M("",!0)],64)}}});const go=ce(ze,[["__scopeId","data-v-7d08a23d"]]);export{go as default};
