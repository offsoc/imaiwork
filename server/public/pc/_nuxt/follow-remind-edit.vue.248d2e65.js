import{E as I,a as C}from"./index.52e544f1.js";import{d as j,r as i,aF as U,bz as q,cq as H,G as g,bI as N,k as R,I as $,s as r,q as l,Z as o,m as p,ay as z,cP as A,av as B,au as P}from"./entry.46557796.js";import{E as S}from"./el-input-number.2848ce7e.js";import{E as L}from"./el-time-picker.715c6813.js";/* empty css                  *//* empty css               *//* empty css                     */import{aC as O,aD as T}from"./person_wechat.8bcf26fc.js";const G={class:"flex items-center gap-x-2 text-xs"},ee=j({__name:"follow-remind-edit",emits:["close","success"],setup(M,{expose:E,emit:w}){const c=w,f=i("add"),_=i(),t=U({flow_id:"",stage_id:"",remind_id:"",status:0,judgment:0,send_time:q().add(10,"minutes").format("HH:mm:ss"),content:""}),V={send_time:[{required:!0,message:"请选择提醒时间",trigger:"blur"},{validator:(s,e,a)=>{const m=new Date,u=new Date(`${m.getFullYear()}-${m.getMonth()+1}-${m.getDate()} ${e}`);t.judgment==0&&u<m?a(new Error("提醒时间不能小于当前时间")):a()}}],content:[{required:!0,message:"请输入提醒内容",trigger:"blur"}]},d=i(),{lockFn:v,isLock:b}=H(async()=>{var s,e;await((s=_.value)==null?void 0:s.validate());try{t.remind_id?await O(t):await T(t),(e=d.value)==null||e.close(),c("success"),g.msgSuccess("操作成功")}catch(a){g.msgError(a)}}),x=s=>{var e;f.value=s,(e=d.value)==null||e.open()},F=()=>{c("close")};return E({open:x,setFormData:s=>{N(s,t)}}),(s,e)=>{const a=I,m=C,u=B,k=S,y=L,D=P;return R(),$(A,{ref_key:"popupRef",ref:d,title:o(f)==="add"?"新建跟进提醒":"编辑跟进提醒",width:"610px",async:"","confirm-loading":o(b),onClose:F,onConfirm:o(v)},{default:r(()=>[l(o(z),{ref_key:"formRef",ref:_,model:o(t),rules:V,"label-position":"top"},{default:r(()=>[l(u,{label:"提醒规则",prop:"status"},{default:r(()=>[l(m,{modelValue:o(t).status,"onUpdate:modelValue":e[0]||(e[0]=n=>o(t).status=n),placeholder:"请选择提醒规则"},{default:r(()=>[l(a,{label:"以停留标签天数为判定规则",value:0}),l(a,{label:"以沉默天数为判定规则",value:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"时间规则",prop:"send_time"},{default:r(()=>[p("div",G,[e[4]||(e[4]=p("span",null,"停留超过",-1)),l(k,{modelValue:o(t).judgment,"onUpdate:modelValue":e[1]||(e[1]=n=>o(t).judgment=n),size:"small"},null,8,["modelValue"]),e[5]||(e[5]=p("span",null,"天后，次日",-1)),l(y,{modelValue:o(t).send_time,"onUpdate:modelValue":e[2]||(e[2]=n=>o(t).send_time=n),placeholder:"请选择提醒时间",size:"small",class:"!w-[150px]","value-format":"HH:mm:ss"},null,8,["modelValue"])])]),_:1}),l(u,{label:"发送内容",prop:"content"},{default:r(()=>[l(D,{modelValue:o(t).content,"onUpdate:modelValue":e[3]||(e[3]=n=>o(t).content=n),placeholder:"请输入提醒内容",type:"textarea",class:"w-full",rows:5},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","confirm-loading","onConfirm"])}}});export{ee as _};
