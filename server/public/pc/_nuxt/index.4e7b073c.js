import{E as te,a as oe}from"./index.52e544f1.js";import{d as q,r as u,A as le,k as i,I as k,s as _,m as s,q as l,Z as t,y as Z,cP as se,aF as ae,l as p,bK as ne,$ as ie,v as re,aI as N,J as B,K as ce,t as G,L as v,cV as de,eh as pe,G as H,aH as j,dj as ue,u as me,ax as fe,au as _e,b5 as ve,cQ as ye,_ as we}from"./entry.46557796.js";import{_ as ge}from"./index.c84588fb.js";import{E as he}from"./index.304400de.js";import{E as xe}from"./el-image.663be0a1.js";import{_ as be}from"./index.vue.4fd7b3ea.js";import{_ as ke}from"./handle-menu.vue.54609769.js";import{_ as Ee}from"./index.vue.7b7084b3.js";/* empty css                  *//* empty css               *//* empty css                     */import"./el-image-viewer.4c392e93.js";import{u as Ve}from"./usePaging.3ef28349.js";import{g as Ce,D as Ie,E as $e}from"./redbook.f03a8b74.js";import{_ as Me}from"./empty.vue.336169b3.js";import Re from"./edit.b7a45525.js";import{MaterialTypeEnum as c}from"./index.83df7a87.js";import{E as Le}from"./index.c34f420e.js";import"./index.c76cd001.js";import"./strings.1c189114.js";import"./debounce.22e3311f.js";import"./_baseIteratee.6084bee0.js";import"./index.1d76ef55.js";import"./index.fdfb054e.js";import"./index.6c2ab172.js";import"./cloneDeep.18da6720.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./position.bb07cf08.js";import"./index.816355b6.js";/* empty css                   */import"./useTemplate.afda57ca.js";import"./throttle.f2fe0ca7.js";import"./index.vue.520aef1d.js";const Pe={class:"-my-4"},Se={class:"w-full h-[200px] flex items-center justify-center"},De=["src"],Ue=q({__name:"index",emits:["close"],setup(J,{expose:a,emit:h}){const R=h,m=u(""),E=u(),d=le(),L=()=>{d.value.open()},V=x=>{m.value=x},w=()=>{R("close")};return a({open:L,setUrl:V}),(x,g)=>{const b=Z,P=se;return i(),k(P,{ref_key:"audioPlayerRef",ref:d,width:"800px","confirm-button-text":"","cancel-button-text":"",style:{"background-color":"var(--app-bg-color-2)"},"show-close":!1,onClose:w},{default:_(()=>[s("div",Pe,[s("div",{class:"absolute right-4 top-4 w-6 h-6 rounded-full bg-[rgba(255,255,255,0.05)] flex items-center justify-center cursor-pointer hover:bg-[rgba(255,255,255,0.1)]",onClick:w},[l(b,{name:"el-icon-Close",color:"#8B9199"})]),g[0]||(g[0]=s("div",{class:"flex items-center gap-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[s("path",{opacity:"0.1",d:"M6 0.5H18C21.0376 0.5 23.5 2.96243 23.5 6V18C23.5 21.0376 21.0376 23.5 18 23.5H6C2.96243 23.5 0.5 21.0376 0.5 18V6C0.5 2.96243 2.96243 0.5 6 0.5Z",stroke:"white"}),s("path",{d:"M8 10V14",stroke:"white","stroke-width":"1.2"}),s("path",{d:"M16 10V14",stroke:"white","stroke-width":"1.2"}),s("path",{d:"M12 8V16",stroke:"white","stroke-width":"1.2"})]),s("div",{class:"text-white text-[20px] font-bold"},"预览")],-1)),s("div",Se,[s("audio",{class:"w-full",ref_key:"audioRef",ref:E,src:t(m),controls:"",autoplay:""},null,8,De)])])]),_:1},512)}}}),Ae=""+new URL("audio_bg.a2f033ba.png",import.meta.url).href,Oe={class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},Te={class:"flex-shrink-0 px-[14px] border-[0] border-b-[1px] border-app-border-1"},ze={class:"flex items-center justify-end h-[88px]"},Be={class:"flex items-center gap-[14px]"},je=["infinite-scroll-disabled"],Fe={class:"h-full p-4"},Ke={key:0},Ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4 cursor-pointer"},Ge={class:"w-full px-3 absolute z-[22] top-2"},He={class:"line-clamp-1 text-white"},qe={class:"absolute bottom-2 w-full text-center px-3 text-[#ffffff80] line-clamp-1 z-[22]"},Ze=["src"],Je={key:1,src:Ae,class:"w-full h-full object-cover"},Qe={class:"absolute top-[50%] left-[50%] -translate-x-[50%] -translate-y-[50%] z-[1000]"},We=["onClick"],Xe={class:"absolute right-2 top-2 z-[1000] w-9 h-9 invisible group-hover:visible"},Ye={key:0,class:"text-white text-center text-xs w-full py-4"},et={key:1,class:"h-full flex items-center justify-center"},tt=q({__name:"index",setup(J){const a=ae({name:"",page_no:1,page_size:20,m_type:"",field:"",order_by:""}),h=u(""),R=r=>{r==1?(a.order_by="desc",a.field="create_time"):r==2?(a.order_by="asc",a.field="create_time"):r==3?(a.order_by="asc",a.field="size"):(a.order_by="desc",a.field="size"),d()},{pager:m,getLists:E,resetPage:d}=Ve({fetchFun:Ce,params:a,isScroll:!0}),L=()=>{a.page_no++,E()},V=u(),w=u(!1),x=async r=>{try{const{name:e,size:n,response:C,raw:{type:y}}=r,{uri:I}=C.data,O=y.includes("video"),$=y.includes("image"),T=y.includes("audio"),M={name:e.split(".")[0],size:n,type:pe.REDBOOK,sort:0,m_type:$?c.IMAGE:T?c.MUSIC:c.VIDEO,content:I,duration:0};if(O&&await(async()=>new Promise((z,K)=>{const f=document.createElement("video");f.src=I,f.muted=!0,f.playsInline=!0,f.preload="auto",f.crossOrigin="anonymous",f.onloadedmetadata=async()=>{M.duration=f.duration,z(f.duration)}}))(),await Ie(M),w.value)return;w.value=!0,V.value=setTimeout(()=>{d(),clearTimeout(V.value),w.value=!1},500)}catch(e){H.msgError(e)}},g=u(!1),b=u(),P=[{label:"重命名",icon:"local-icon-edit3",click:async r=>{g.value=!0,await j(),b.value.open(),b.value.setFormData(r)}},{label:"下载素材",icon:"local-icon-download",click:({content:r})=>{ue(r)}},{label:"删除素材",icon:"local-icon-delete",click:({id:r})=>{me().$confirm({message:"确定删除该素材吗？",theme:"dark",onConfirm:async()=>{try{await $e({id:r});const e=m.lists.findIndex(n=>n.id==r);m.lists.splice(e,1)}catch(e){H.msgWarning(e)}}})}}],S=u(!1),D=u(!1),U=u(),A=u(),Q=async r=>{const{m_type:e,content:n}=r;e==c.VIDEO?(S.value=!0,await j(),U.value.open(),U.value.setUrl(n)):(D.value=!0,await j(),A.value.open(),A.value.setUrl(n))};return E(),(r,e)=>{const n=te,C=oe,y=fe,I=_e,O=Z,$=ge,T=ve,M=he,F=xe,z=be,K=ke,f=Ee,W=Ue,X=ye,Y=Le;return i(),p(B,null,[s("div",Oe,[s("div",Te,[l(M,null,{default:_(()=>[s("div",ze,[s("div",Be,[l(C,{modelValue:t(a).m_type,"onUpdate:modelValue":e[0]||(e[0]=o=>t(a).m_type=o),class:"!w-[100px]","popper-class":"dark-select-popper",clearable:"","show-arrow":!1,"empty-values":[null,void 0],"value-on-clear":null,onChange:t(d)},{default:_(()=>[l(n,{label:"全部",value:""}),l(n,{label:"视频",value:t(c).VIDEO},null,8,["value"]),l(n,{label:"图片",value:t(c).IMAGE},null,8,["value"]),l(n,{label:"音频",value:t(c).MUSIC},null,8,["value"])]),_:1},8,["modelValue","onChange"]),l(C,{modelValue:t(h),"onUpdate:modelValue":e[1]||(e[1]=o=>ne(h)?h.value=o:null),class:"!w-[140px]","popper-class":"dark-select-popper",clearable:"","show-arrow":!1,"empty-values":[null,void 0],"value-on-clear":null,onChange:R},{default:_(()=>[l(n,{label:"全部",value:""}),l(n,{label:"最新开始排序",value:"1"}),l(n,{label:"最早开始排序",value:"2"}),l(n,{label:"文件从大到小",value:"3"}),l(n,{label:"文件从小到大",value:"4"})]),_:1},8,["modelValue"]),l(I,{modelValue:t(a).name,"onUpdate:modelValue":e[3]||(e[3]=o=>t(a).name=o),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[4]||(e[4]=o=>t(d)()),onKeydown:e[5]||(e[5]=ie(o=>t(d)(),["enter"]))},{append:_(()=>[l(y,{text:"",onClick:e[2]||(e[2]=o=>t(d)())},{default:_(()=>e[11]||(e[11]=[re(" 搜索 ",-1)])),_:1,__:[11]})]),_:1},8,["modelValue"]),l($,{type:"file",accept:"video/*,image/*,.mp3,.wav,.m4a","show-progress":"","show-file-list":!1,onChange:x},{default:_(()=>[l(y,{type:"primary",class:"!rounded-full !h-10 !px-4"},{default:_(()=>[l(O,{name:"local-icon-add_circle",color:"#ffffff"}),e[12]||(e[12]=s("span",{class:"ml-2"},"上传素材",-1))]),_:1,__:[12]})]),_:1}),l(T,{content:"刷新"},{default:_(()=>[l(y,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[6]||(e[6]=o=>t(d)())})]),_:1})])])]),_:1})]),N((i(),p("div",{class:"grow min-h-0 overflow-y-auto flex flex-col dynamic-scroller","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!t(m).isLoad,"infinite-scroll-distance":10},[N((i(),p("div",Fe,[t(m).lists.length?(i(),p("div",Ke,[s("div",Ne,[(i(!0),p(B,null,ce(t(m).lists,(o,ee)=>(i(),p("div",{class:"material-item card-gradient group",key:ee},[s("div",Ge,[s("div",He,G(o.name),1)]),s("div",qe,G(o.create_time),1),t(c).IMAGE==o.m_type?(i(),k(F,{key:0,class:"w-full h-full",fit:"cover",lazy:"","preview-teleported":"",src:o.content,"preview-src-list":[o.content]},null,8,["src","preview-src-list"])):v("",!0),t(c).VIDEO==o.m_type||t(c).MUSIC==o.m_type?(i(),p(B,{key:1},[t(c).VIDEO==o.m_type?(i(),p("video",{key:0,src:o.content,class:"w-full h-full object-cover"},null,8,Ze)):v("",!0),t(c).MUSIC==o.m_type?(i(),p("img",Je)):v("",!0),s("div",Qe,[s("div",{class:"w-12 h-12",onClick:ot=>Q(o)},[l(z)],8,We)])],64)):v("",!0),s("div",Xe,[l(K,{theme:t(de).DARK,data:o,"menu-list":P},null,8,["theme","data"])])]))),128))]),t(m).isLoad?v("",!0):(i(),p("div",Ye,"暂无更多了~"))])):(i(),p("div",et,[l($,{type:"file",accept:"video/*,image/*","show-progress":"","show-file-list":!1,onChange:x},{default:_(()=>[l(Me,{"btn-text":"上传素材",msg:"快去上传你的素材吧"})]),_:1})]))])),[[X,t(m).loading]])],8,je)),[[Y,L]])]),t(S)?(i(),k(f,{key:0,ref_key:"previewVideoRef",ref:U,onClose:e[7]||(e[7]=o=>S.value=!1)},null,512)):v("",!0),t(D)?(i(),k(W,{key:1,ref_key:"previewAudioRef",ref:A,onClose:e[8]||(e[8]=o=>D.value=!1)},null,512)):v("",!0),t(g)?(i(),k(Re,{key:2,ref_key:"editPopupRef",ref:b,onClose:e[9]||(e[9]=o=>g.value=!1),onSuccess:e[10]||(e[10]=o=>t(d)())},null,512)):v("",!0)],64)}}});const Tt=we(tt,[["__scopeId","data-v-74ac5417"]]);export{Tt as default};
