import{E as C,a as I}from"./index.5f182cdf.js";import{d as j,r as i,aF as U,bC as H,cx as N,G as g,bK as R,k as $,I as q,s as r,q as l,Z as o,m as p,ay as A,cV as B,av as S,au as z}from"./entry.ca4d3d61.js";import{E as L}from"./el-input-number.5d96f707.js";import{E as O}from"./el-time-picker.e4236b4e.js";/* empty css                  *//* empty css               *//* empty css                     */import{aC as P,aD as T}from"./person_wechat.703f63bb.js";const G={class:"flex items-center gap-x-2 text-xs"},ee=j({__name:"follow-remind-edit",emits:["close","success"],setup(K,{expose:E,emit:w}){const c=w,f=i("add"),_=i(),t=U({flow_id:"",stage_id:"",remind_id:"",status:0,judgment:0,send_time:H().add(10,"minutes").format("HH:mm:ss"),content:""}),V={send_time:[{required:!0,message:"请选择提醒时间",trigger:"blur"},{validator:(s,e,a)=>{const m=new Date,u=new Date(`${m.getFullYear()}-${m.getMonth()+1}-${m.getDate()} ${e}`);t.judgment==0&&u<m?a(new Error("提醒时间不能小于当前时间")):a()}}],content:[{required:!0,message:"请输入提醒内容",trigger:"blur"}]},d=i(),{lockFn:v,isLock:x}=N(async()=>{var s,e;await((s=_.value)==null?void 0:s.validate());try{t.remind_id?await P(t):await T(t),(e=d.value)==null||e.close(),c("success"),g.msgSuccess("操作成功")}catch(a){g.msgError(a)}}),b=s=>{var e;f.value=s,(e=d.value)==null||e.open()},F=()=>{c("close")};return E({open:b,setFormData:s=>{R(s,t)}}),(s,e)=>{const a=C,m=I,u=S,k=L,y=O,D=z;return $(),q(B,{ref_key:"popupRef",ref:d,title:o(f)==="add"?"新建跟进提醒":"编辑跟进提醒",width:"610px",async:"","confirm-loading":o(x),onClose:F,onConfirm:o(v)},{default:r(()=>[l(o(A),{ref_key:"formRef",ref:_,model:o(t),rules:V,"label-position":"top"},{default:r(()=>[l(u,{label:"提醒规则",prop:"status"},{default:r(()=>[l(m,{modelValue:o(t).status,"onUpdate:modelValue":e[0]||(e[0]=n=>o(t).status=n),placeholder:"请选择提醒规则"},{default:r(()=>[l(a,{label:"以停留标签天数为判定规则",value:0}),l(a,{label:"以沉默天数为判定规则",value:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"时间规则",prop:"send_time"},{default:r(()=>[p("div",G,[e[4]||(e[4]=p("span",null,"停留超过",-1)),l(k,{modelValue:o(t).judgment,"onUpdate:modelValue":e[1]||(e[1]=n=>o(t).judgment=n),size:"small"},null,8,["modelValue"]),e[5]||(e[5]=p("span",null,"天后，次日",-1)),l(y,{modelValue:o(t).send_time,"onUpdate:modelValue":e[2]||(e[2]=n=>o(t).send_time=n),placeholder:"请选择提醒时间",size:"small",class:"!w-[150px]","value-format":"HH:mm:ss"},null,8,["modelValue"])])]),_:1}),l(u,{label:"发送内容",prop:"content"},{default:r(()=>[l(D,{modelValue:o(t).content,"onUpdate:modelValue":e[3]||(e[3]=n=>o(t).content=n),placeholder:"请输入提醒内容",type:"textarea",class:"w-full",rows:5},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","confirm-loading","onConfirm"])}}});export{ee as _};
