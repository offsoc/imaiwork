import{d as U,bM as D,aF as q,r as P,o as H,Z as a,k as n,l as r,m as o,q as s,s as l,$ as Q,v as p,aI as J,I as y,t as _,J as Y,L as f,Y as Z,bK as O,bz as T,bQ as E,u as W,G as g,ax as X,au as ee,y as te,b5 as se,cQ as le}from"./entry.46557796.js";import{E as ae}from"./index.304400de.js";import{E as ne,a as oe}from"./index.5f8d7d98.js";import{_ as ie}from"./index.vue.383c1815.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                 */import{u as de}from"./usePaging.3ef28349.js";import{z as re,A as ue,B as ce}from"./redbook.f03a8b74.js";import{_ as pe}from"./empty.vue.336169b3.js";import{PublishTaskTypeEnum as C,SidebarTypeEnum as S}from"./index.83df7a87.js";import _e from"./publish-panel.115c1016.js";import me from"./publish-record.aa929095.js";const fe={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},he={class:"flex-shrink-0 px-[14px]"},be={class:"flex items-center justify-end h-[88px]"},ye={class:"flex items-center gap-[14px]"},ve={class:"grow min-h-0 overflow-hidden flex flex-col"},ge={class:"grow min-h-0"},ke={key:0},xe={key:1},Ee={class:"flex items-center justify-center gap-2"},Ce={key:1},Se={key:2},Be={key:3},Ie={key:4},Pe={class:"flex justify-end items-center"},Te={class:"leading-6"},$e={class:"flex justify-center p-4"},He=U({__name:"index",setup(Ae){const{query:v}=D(),k=q({name:"",page_no:1,page_size:20,media_type:C.IMAGE}),{pager:h,getLists:u,resetPage:$}=de({fetchFun:re,params:k}),A=i=>{const{publish_start:t,publish_end:d}=i;return t&&d?T(d).diff(T(t),"day")+1+"天":"-"},m=P(v.is_publish=="1"&&parseInt(v.type)==S.PUBLISH_IMAGE_TASK),B=()=>{m.value=!0,E({is_publish:1})},I=()=>{m.value=!1,b.value=!1,window.history.replaceState("","",`?type=${S.PUBLISH_IMAGE_TASK}`),u()},V=async i=>{W().$confirm({message:"是否删除该任务？",theme:"dark",onConfirm:async()=>{try{await ue({id:i}),g.msgSuccess("删除成功"),u()}catch(t){g.msgError(t||"删除失败")}}})},z=async i=>{try{await ce({id:i.id,status:i.status==4?1:4}),g.msgSuccess("操作成功"),u()}catch(t){g.msgError(t||"操作失败")}},M=i=>{m.value=!0,E({is_publish:1,publish_id:i.publish_id,material_id:i.video_setting_id})},b=P(v.is_record=="1"&&parseInt(v.type)==S.PUBLISH_IMAGE_TASK),w=i=>{b.value=!0,E({is_record:1,publish_id:i.id})};return H(()=>{!m.value&&!b.value&&u()}),(i,t)=>{const d=X,G=ee,L=te,K=se,j=ae,c=ne,F=oe,N=ie,R=le;return!a(m)&&!a(b)?(n(),r("div",fe,[o("div",he,[s(j,null,{default:l(()=>[o("div",be,[o("div",ye,[s(G,{modelValue:a(k).name,"onUpdate:modelValue":t[1]||(t[1]=e=>a(k).name=e),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:t[2]||(t[2]=e=>a(u)()),onKeydown:t[3]||(t[3]=Q(e=>a(u)(),["enter"]))},{append:l(()=>[s(d,{text:"",onClick:t[0]||(t[0]=e=>a(u)())},{default:l(()=>t[6]||(t[6]=[p(" 搜索 ",-1)])),_:1,__:[6]})]),_:1},8,["modelValue"]),s(d,{type:"primary",class:"!rounded-full !h-10 !w-[116px]",onClick:B},{default:l(()=>[s(L,{name:"local-icon-add_circle",color:"#ffffff"}),t[7]||(t[7]=o("span",{class:"ml-2"},"发布图文",-1))]),_:1,__:[7]}),o("div",null,[s(K,{content:"刷新"},{default:l(()=>[s(d,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:t[4]||(t[4]=e=>a($)())})]),_:1})])])])]),_:1})]),o("div",ve,[o("div",ge,[J((n(),y(F,{height:"100%",data:a(h).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:l(()=>[o("div",Te,[s(pe,{"btn-text":"发布图文",msg:"快去发布你的专属图文吧","custom-click":B})])]),default:l(()=>[s(c,{prop:"name",label:"任务名称",width:"240",fixed:"left","show-overflow-tooltip":""}),s(c,{label:"发布账号","min-width":"200"},{default:l(({row:e})=>[e.account?(n(),r("div",ke,[p(_(e.account)+" ",1),e.nickname?(n(),r(Y,{key:0},[p(" ("+_(e.nickname)+") ",1)],64)):f("",!0)])):(n(),r("div",xe,"-"))]),_:1}),s(c,{label:"任务状态",width:"120"},{default:l(({row:e})=>[o("div",Ee,[e.status!=0?(n(),r("div",{key:0,class:Z(["w-[6px] h-[6px] rounded-full",{"bg-primary":e.status==1,"bg-[#3BB840]":e.status==2,"bg-[#FFBC50]":e.status==3}])},null,2)):f("",!0),e.status==0?(n(),r("div",Ce,"未开启")):e.status==1?(n(),r("div",Se,"进行中")):e.status==2?(n(),r("div",Be,"已完成")):e.status==3?(n(),r("div",Ie,"暂停中")):f("",!0)])]),_:1}),s(c,{label:"发布周期","min-width":"100"},{default:l(({row:e})=>[o("div",null,_(A(e)),1)]),_:1}),s(c,{prop:"next_publish_time",label:"下组图文发布点",width:"180"},{default:l(({row:e})=>[o("div",null,_(e.next_publish_time||"-"),1)]),_:1}),s(c,{label:"发布进度",width:"140"},{default:l(({row:e})=>[p(_(e.published_count)+" / "+_(e.count),1)]),_:1}),s(c,{prop:"create_time",label:"创建时间",width:"180"}),s(c,{label:"操作",width:"180",fixed:"right",align:"right"},{default:l(({row:e})=>[o("div",Pe,[e.status==1||e.status==4?(n(),y(d,{key:0,class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>z(e)},{default:l(()=>[p(_(e.status==1?"暂停":"继续"),1)]),_:2},1032,["onClick"])):f("",!0),e.status==0?(n(),y(d,{key:1,class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>M(e)},{default:l(()=>t[8]||(t[8]=[p("编辑",-1)])),_:2,__:[8]},1032,["onClick"])):f("",!0),s(d,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>w(e)},{default:l(()=>t[9]||(t[9]=[p("详情",-1)])),_:2,__:[9]},1032,["onClick"]),s(d,{type:"danger",link:"",size:"small",onClick:x=>V(e.id)},{default:l(()=>t[10]||(t[10]=[p("删除",-1)])),_:2,__:[10]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[R,a(h).loading]])]),o("div",$e,[s(N,{modelValue:a(h),"onUpdate:modelValue":t[5]||(t[5]=e=>O(h)?h.value=e:null),layout:"prev, pager, next",onChange:a(u)},null,8,["modelValue","onChange"])])])])):a(m)?(n(),y(_e,{key:1,type:a(C).IMAGE,onBack:I},null,8,["type"])):a(b)?(n(),y(me,{key:2,type:a(C).IMAGE,onBack:I},null,8,["type"])):f("",!0)}}});export{He as _};
