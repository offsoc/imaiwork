import{E as L}from"./index.f15af271.js";import{E as B}from"./el-empty.77af023a.js";import{d as N,aF as V,r,A as q,cq as z,bR as j,bI as G,k as o,l as i,m as t,Z as n,I as f,s as H,J as b,K as J,q as l,a0 as K,L as C,G as h,aH as k,y as T,u as U}from"./entry.d7219633.js";/* empty css                     */import{_ as Z}from"./7_day.257301c1.js";import{ae as O,af as Q,ag as W,ah as X}from"./person_wechat.8bcf26fc.js";import Y from"./material-edit.80b2904d.js";import{_ as ee}from"./send-date.vue.6229a0f9.js";import{_ as se}from"./send-date-preview.vue.df15fef5.js";import te from"./send-container-item.2945e581.js";const ae={class:"h-full flex flex-col gap-x-4"},oe={class:"grow min-h-0 flex"},ne={class:"flex-1 flex flex-col h-full"},re={class:"flex-shrink min-h-0"},ie={class:"px-4 flex flex-col gap-y-4"},le={key:1,class:"mt-14"},ce={class:"w-[456px] flex-shrink-0"},de={class:"h-full"},me={key:0,class:"border border-primary-light-8 rounded-xl py-4 relative px-2"},pe={key:1,class:""},be=N({__name:"send-container",props:{type:{},taskId:{},pushDay:{}},emits:["back","success"],setup(D,{expose:S,emit:P}){const g=D,c=P,I=U(),d=V({push_time_list:[]}),m=r([]),F=e=>{I.$confirm({message:"确定删除该内容吗？",onConfirm:async()=>{try{await O({content_id:e}),c("success"),h.msgSuccess("删除成功")}catch(s){h.msgError(s)}}})},p=r(!1),u=q(),M=async()=>{var e;p.value=!0,await k(),(e=u.value)==null||e.open("add")},y=async e=>{var s,_;try{const a=await Q({content_id:e});p.value=!0,await k(),(s=u.value)==null||s.open("edit"),(_=u.value)==null||_.setFormData({content_id:a.id,content:a.content,time:{order_day:a.order_day,push_time:a.push_time}})}catch(a){h.msgError(a)}},R=async e=>{try{e.content_id?await W({push_id:g.taskId,...e}):await X({push_id:g.taskId,...e}),c("success")}catch(s){h.msgError(s)}},v=r(!1);r(!1);const E=r(),$=async()=>{var e;v.value=!0,await k(),(e=E.value)==null||e.open()};z(async()=>{if(d.push_time_list.length==0){j.error("请添加内容");return}c("success"),A()});const A=()=>{c("back")};return S({setFormData:e=>G(e,d),setDateList:e=>{m.value=e}}),(e,s)=>{const _=L,a=B,w=T;return o(),i(b,null,[t("div",ae,[t("div",oe,[t("div",ne,[t("div",re,[n(d).push_time_list.length?(o(),f(_,{key:0},{default:H(()=>[t("div",ie,[(o(!0),i(b,null,J(n(d).push_time_list,(x,ue)=>(o(),f(te,{item:x,onDelete:F,onEdit:y},null,8,["item"]))),256))])]),_:1})):(o(),i("div",le,[l(a,{description:"请添加内容"})]))]),t("div",{class:"m-4 p-2 bg-primary-light-9 rounded-xl flex items-center justify-center cursor-pointer gap-x-2",onClick:K(M,["stop"])},[l(w,{name:"local-icon-add_box_fill",color:"var(--color-primary)",size:20}),s[2]||(s[2]=t("span",{class:"text-primary font-bold"}," 添加内容 ",-1))])]),t("div",ce,[s[3]||(s[3]=t("div",{class:"flex items-center gap-2 mb-4"},[t("img",{src:Z,class:"w-6 h-6"}),t("span",null,"推送日期预览")],-1)),t("div",de,[n(m).length?(o(),i("div",me,[l(ee,{"date-list":n(m),onEdit:y},null,8,["date-list"]),t("div",{class:"absolute top-1 right-1 z-40 p-1 hover:bg-primary-light-8 rounded-md cursor-pointer",onClick:$},[l(w,{name:"local-icon-fullscreen",color:"var(--color-primary)"})])])):(o(),i("div",pe,[l(a,{description:"请添加内容"})]))])])])]),n(v)?(o(),f(se,{key:0,ref_key:"sendDatePreviewRef",ref:E,"date-list":n(m),onClose:s[0]||(s[0]=x=>v.value=!1),onEdit:y},null,8,["date-list"])):C("",!0),n(p)?(o(),f(Y,{key:1,ref_key:"materialEditRef",ref:u,"push-day":e.pushDay,onSuccess:R,onClose:s[1]||(s[1]=x=>p.value=!1)},null,8,["push-day"])):C("",!0)],64)}}});export{be as _};
