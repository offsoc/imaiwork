import{d as z,bM as J,aF as O,r as _,o as Y,Z as o,k as l,l as i,m as s,q as n,s as d,v as g,$ as H,aI as Q,J as S,K as V,t as b,L as B,bK as W,I as D,aH as F,bQ as Z,G as $,ax as X,y as ee,au as se,aw as te,cQ as oe,u as le}from"./entry.46557796.js";import{E as ne}from"./index.304400de.js";import{_ as ae}from"./index.vue.383c1815.js";import{E as ie}from"./el-empty.db5857ba.js";/* empty css                     */import{u as re}from"./usePaging.3ef28349.js";import{_ as ce}from"./flow_title_img.b33c9278.js";import{aj as de,aG as me}from"./person_wechat.8bcf26fc.js";import{_ as fe}from"./flow-add.vue.84e473c3.js";import pe from"./create-panel.9601b608.js";import{SidebarTypeEnum as L}from"./index.a1206616.js";const ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAACVBMVEVHcEwkVPMjU/TCW17aAAAAAnRSTlMAgJsrThgAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAA5SURBVEhLY2AYBaMhMBoCSCHAyAQBjGAxfDyYplEdNAwrUgN3VD2uxAtJrqSGz2jZMBoCoyEACwEA0fMDAfienuwAAAAASUVORK5CYII=",_e={key:0,class:"h-full flex flex-col bg-white rounded-xl"},Ae={class:"flex items-center justify-between p-4"},xe={class:"flex items-center gap-2"},ge={class:"grow min-h-0 flex flex-col"},we={key:0,class:"grow min-h-0 py-2"},ye={class:"flex flex-col gap-6 p-4"},ve={class:"flex items-center justify-between h-[56px]"},he={class:"flex items-center gap-4"},Ee={class:"text-lg font-bold"},ke={class:"grow min-h-0"},Ce={class:"h-full flex items-center whitespace-nowrap overflow-x-auto px-6"},Se={class:"flex flex-col items-center gap-2"},Ve={class:"text-[#5E656E]"},be={key:0,class:"flex-1 flex justify-center"},Be={class:"flex justify-end p-4"},De={key:1,class:"h-full flex items-center justify-center"},qe=z({__name:"index",setup(Fe){const{query:w}=J(),M=le(),f=O({flow_name:""}),{pager:r,getLists:y,resetPage:m,resetParams:$e}=re({fetchFun:de,params:f,isScroll:!0}),R=()=>{f.flow_name="",m()},A=_(!1),v=_(),h=_(),p=_(w.is_create=="1"&&parseInt(w.type)==L.FLOW),j=async()=>{var a;A.value=!0,await F(),(a=v.value)==null||a.open()},I=async a=>{var e;p.value=!0,await F(),Z({id:a,is_create:"1"}),(e=h.value)==null||e.getDetail(a)},E=async(a,e)=>{await M.$confirm({message:"确定删除该客户流程吗？",onConfirm:async()=>{try{await me({id:a});const c=r.lists.findIndex(u=>u.id==a);r.lists.splice(c,1),$.msgSuccess("删除成功"),e&&k()}catch(c){$.msgError(c)}}})},k=()=>{p.value=!1,window.history.replaceState("","",`?type=${L.FLOW}`),m()};return Y(()=>{p.value||y()}),(a,e)=>{const c=X,u=ee,N=se,P=te,U=ne,K=ae,T=ie,G=oe;return o(p)?(l(),D(pe,{key:1,ref_key:"createPanelRef",ref:h,onDelete:E,onBack:k},null,512)):(l(),i("div",_e,[s("div",Ae,[n(c,{type:"primary",onClick:j},{default:d(()=>e[5]||(e[5]=[g("新建客户流程",-1)])),_:1,__:[5]}),s("div",xe,[n(N,{modelValue:o(f).flow_name,"onUpdate:modelValue":e[1]||(e[1]=t=>o(f).flow_name=t),class:"!w-[240px]",clearable:"",placeholder:"请输入流程名称",onClear:R,onKeyup:e[2]||(e[2]=H(t=>o(m)(),["enter"]))},{append:d(()=>[n(c,{onClick:e[0]||(e[0]=t=>o(m)())},{default:d(()=>[n(u,{name:"el-icon-Search"})]),_:1})]),_:1},8,["modelValue"])])]),Q((l(),i("div",ge,[o(r).lists.length>0?(l(),i("div",we,[n(U,null,{default:d(()=>[s("div",ye,[(l(!0),i(S,null,V(o(r).lists,(t,q)=>(l(),i("div",{key:q,class:"h-[160px] flex flex-col rounded-xl shadow-lighter px-4"},[s("div",ve,[s("div",he,[e[6]||(e[6]=s("img",{src:ce,class:"w-6 h-6"},null,-1)),s("div",Ee,b(t.flow_name),1)]),s("div",null,[n(c,{type:"primary",size:"small",onClick:x=>I(t.id)},{default:d(()=>e[7]||(e[7]=[g("编辑",-1)])),_:2,__:[7]},1032,["onClick"]),n(c,{type:"danger",size:"small",onClick:x=>E(t.id)},{default:d(()=>e[8]||(e[8]=[g("删除",-1)])),_:2,__:[8]},1032,["onClick"])])]),n(P,{class:"!m-0 border-[#E7E7E7]"}),s("div",ke,[s("div",Ce,[(l(!0),i(S,null,V(t.key_stages,(x,C)=>(l(),i("div",{key:C,class:"flex items-center gap-2 w-[200px] flex-shrink-0"},[s("div",Se,[n(u,{name:"el-icon-LocationFilled",color:"var(--color-primary)",size:20}),s("span",Ve,b(x.sub_stage_name),1)]),C<t.key_stages.length-1?(l(),i("div",be,e[9]||(e[9]=[s("img",{src:ue,class:"h-6"},null,-1)]))):B("",!0)]))),128))])])]))),128))])]),_:1}),s("div",Be,[n(K,{modelValue:o(r),"onUpdate:modelValue":e[3]||(e[3]=t=>W(r)?r.value=t:null),onChange:o(y)},null,8,["modelValue","onChange"])])])):(l(),i("div",De,[n(T,{description:"暂无数据"})]))])),[[G,o(r).loading]]),o(A)?(l(),D(fe,{key:0,ref_key:"flowAddRef",ref:v,onClose:e[4]||(e[4]=t=>A.value=!1),onSuccess:o(m)},null,8,["onSuccess"])):B("",!0)]))}}});export{qe as _};
