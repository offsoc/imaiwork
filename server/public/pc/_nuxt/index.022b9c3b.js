import{d as K,bM as q,aF as H,r as A,o as R,k as a,l as i,Z as o,m as n,q as s,s as l,$ as G,v as d,aI as J,I as v,J as m,K as Q,t as w,Y,L as c,bK as Z,bQ as B,G as b,ax as O,au as X,y as ee,b5 as te,cP as se,u as ae,_ as oe}from"./entry.d7219633.js";import{E as ne}from"./index.f15af271.js";import{E as le,a as ie}from"./index.0a6eb9ae.js";import{E as re}from"./el-empty.77af023a.js";import{_ as de}from"./index.vue.5e2341cc.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                 */import{u as ce}from"./usePaging.3c53b51c.js";import{l as pe,m as me,n as ue}from"./sph.47a77ad4.js";import{SidebarTypeEnum as C}from"./index.4596121c.js";import _e from"./create-panel.0698e397.js";import{_ as fe}from"./detail.vue.2cad7c3f.js";import"./_baseIteratee.5c97421a.js";import"./debounce.085e8a4a.js";import"./index.ead96a32.js";import"./index.50778a9c.js";import"./index.4953ba77.js";import"./strings.03d3529c.js";import"./index.55703cf7.js";import"./index.3adcf74a.js";import"./index.9efd0300.js";import"./cloneDeep.1f319c9b.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./el-switch.69f0f4ce.js";import"./index.vue.f38ca415.js";/* empty css                  */import"./useDictOptions.2e009744.js";import"./person_wechat.8bcf26fc.js";import"./remark-pop.vue.61720d59.js";const ye={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},he={class:"flex-shrink-0 px-[14px]"},ge={class:"flex items-center justify-end h-[88px]"},xe={class:"flex items-center gap-[14px]"},ve={class:"grow min-h-0 overflow-hidden flex flex-col"},be={class:"grow min-h-0"},ke={key:0,class:"flex gap-x-2 justify-center"},Ce={class:"rounded-md px-4 py-1 bg-app-bg-4 border border-app-border-2"},Ee={key:1},Ae={class:"flex items-center justify-center gap-x-2"},we={class:"flex justify-end items-center"},Be={class:"flex justify-center items-center h-full"},Se={class:"flex justify-center p-4"},$e=K({__name:"index",setup(De){const{query:h}=q(),S=ae(),k=H({device_code:"",wechat_no:"",channel:"",exec_type:"",name:"",status:"",page_size:20}),f=A(h.is_create=="1"&&parseInt(h.type)==C.MANUAL_ADD_WECHAT),g=A(h.is_detail=="1"&&parseInt(h.type)==C.MANUAL_ADD_WECHAT),{pager:y,getLists:p,resetPage:$}=ce({fetchFun:pe,params:k}),D=()=>{f.value=!0,B({is_create:1})},T=r=>{g.value=!0,B({is_detail:1,id:r})},V=r=>({0:"bg-[#999999]",1:"bg-primary",2:"bg-[#FFBC50]",3:"bg-[#3BB840]",4:"bg-[#3BB840]"})[r],M=async r=>{try{await me({id:r.id,status:r.status==1?2:1}),b.msgSuccess(r.status==1?"继续成功":"暂停成功"),p()}catch(e){b.msgError(e||"操作失败")}},I=async r=>{S.$confirm({message:"确定删除该记录吗？",theme:"dark",onConfirm:async()=>{try{await ue({id:r}),b.msgSuccess("删除成功"),p()}catch(e){b.msgError(e||"删除失败")}}})},E=()=>{f.value=!1,g.value=!1,window.history.replaceState("","",`?type=${C.MANUAL_ADD_WECHAT}`),p()};return R(()=>{f.value||p()}),(r,e)=>{const u=O,L=X,N=ee,W=te,j=ne,_=le,z=re,F=ie,P=de,U=se;return a(),i(m,null,[!o(f)&&!o(g)?(a(),i("div",ye,[n("div",he,[s(j,null,{default:l(()=>[n("div",ge,[n("div",xe,[s(L,{modelValue:o(k).name,"onUpdate:modelValue":e[1]||(e[1]=t=>o(k).name=t),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[2]||(e[2]=t=>o(p)()),onKeydown:e[3]||(e[3]=G(t=>o(p)(),["enter"]))},{append:l(()=>[s(u,{text:"",onClick:e[0]||(e[0]=t=>o(p)())},{default:l(()=>e[6]||(e[6]=[d(" 搜索 ",-1)])),_:1,__:[6]})]),_:1},8,["modelValue"]),s(u,{type:"primary",class:"!rounded-full !h-10",onClick:D},{default:l(()=>[s(N,{name:"local-icon-add_circle",color:"#ffffff"}),e[7]||(e[7]=n("span",{class:"ml-2"},"创建任务 ",-1))]),_:1,__:[7]}),n("div",null,[s(W,{content:"刷新"},{default:l(()=>[s(u,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[4]||(e[4]=t=>o($)())})]),_:1})])])])]),_:1})]),n("div",ve,[n("div",be,[J((a(),v(F,{height:"100%",data:o(y).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:l(()=>[n("div",Be,[s(z,{description:"暂无数据"})])]),default:l(()=>[s(_,{prop:"name",label:"任务名称",width:"240",fixed:"left"}),s(_,{label:"执行账号","min-width":"140","show-overflow-tooltip":""},{default:l(({row:t})=>[t.wechats.length>0?(a(),i("div",ke,[(a(!0),i(m,null,Q(t.wechats,x=>(a(),i("div",Ce,w(x.wechat_nickname),1))),256))])):(a(),i("div",Ee,"-"))]),_:1}),s(_,{label:"任务状态",width:"160",align:"center"},{default:l(({row:t})=>[n("div",Ae,[n("div",{class:Y(["w-[6px] h-[6px] rounded-full",V(t.status)])},null,2),n("span",null,[t.status==0?(a(),i(m,{key:0},[d("未开始")],64)):c("",!0),t.status==1?(a(),i(m,{key:1},[d("进行中")],64)):c("",!0),t.status==2?(a(),i(m,{key:2},[d("已暂停")],64)):c("",!0),t.status==3?(a(),i(m,{key:3},[d("已完成")],64)):c("",!0),t.status==4?(a(),i(m,{key:4},[d("已结束")],64)):c("",!0)])])]),_:1}),s(_,{prop:"exec_day",label:"已执行天数","min-width":"120"}),s(_,{prop:"create_time",label:"创建时间",width:"180"}),s(_,{label:"操作",width:"120",fixed:"right",align:"right"},{default:l(({row:t})=>[n("div",we,[t.status==1||t.status==2?(a(),v(u,{key:0,class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>M(t)},{default:l(()=>[d(w(t.status==1?"继续":"暂停"),1)]),_:2},1032,["onClick"])):c("",!0),s(u,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:x=>T(t.id)},{default:l(()=>e[8]||(e[8]=[d("详情",-1)])),_:2,__:[8]},1032,["onClick"]),s(u,{type:"danger",link:"",size:"small",onClick:x=>I(t.id)},{default:l(()=>e[9]||(e[9]=[d("删除",-1)])),_:2,__:[9]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[U,o(y).loading]])]),n("div",Se,[s(P,{modelValue:o(y),"onUpdate:modelValue":e[5]||(e[5]=t=>Z(y)?y.value=t:null),layout:"prev, pager, next",onChange:o(p)},null,8,["modelValue","onChange"])])])])):c("",!0),o(f)?(a(),v(_e,{key:1,onBack:E})):c("",!0),o(g)?(a(),v(fe,{key:2,onBack:E})):c("",!0)],64)}}});const ct=oe($e,[["__scopeId","data-v-67675a37"]]);export{ct as default};
