import{d as q,A as S,r as R,aF as D,cx as G,G as J,k as f,I as V,s as a,m as e,q as t,Z as l,$ as M,v as $,t as h,bM as Z,l as w,K as H,J as O,cV as Q,y as X,ax as Y,au as ee,u as se}from"./entry.2beb4577.js";import{a as te,E as ne}from"./index.6beaca44.js";import{_ as oe}from"./index.vue.5646543a.js";import{E as le}from"./index.47b30189.js";import{E as ae}from"./el-empty.bc763313.js";/* empty css                        *//* empty css               *//* empty css                     */import{u as ie}from"./usePaging.85211d66.js";import{y as ce,z as re}from"./person_wechat.8bcf26fc.js";import{_ as de}from"./sidebar-panel.vue.88b68abd.js";const fe={class:"relative"},pe={class:"w-full bg-white rounded-lg flex h-[896px] overflow-hidden"},_e={class:"w-[94px] flex-shrink-0"},ue={class:"flex-1 flex flex-col border-r border-gray-200"},me={class:"flex-shrink-0"},he={class:"h-[70px] flex items-center justify-end px-4"},xe={class:"grow min-h-0"},ve=["src"],ge={class:"p-4 flex justify-end"},we={class:"w-[248px] flex-shrink-0 flex flex-col"},ke={class:"flex-shrink-0"},ye={class:"w-full h-[66px] bg-primary flex justify-between items-center px-4"},be={class:"text-white"},Ce={class:"grow min-h-0 py-4"},Ee={class:"flex flex-col gap-y-4 px-4"},Se=["src"],Re={class:"flex-1 text-[#414142]"},Ve={class:"line-clamp-1"},$e=["onClick"],Le={key:1,class:"flex items-center justify-center h-full"},Fe={class:"flex-shrink-0 mx-2 py-2"},Ie={class:"absolute -right-10 top-2"},Ge=q({__name:"add-friend",props:{wechatId:{}},emits:["close","success"],setup(k,{expose:L,emit:F}){const y=k,b=F,I=se(),C=S(),r=S(),x=R([]),p=D({wechat_id:"",nickname:""}),{pager:_,getLists:v}=ie({fetchFun:ce,params:p}),g=async()=>{var s,c;await v();const o=(s=r.value)==null?void 0:s.getSelectionRows();(c=r.value)==null||c.clearSelection(),o.forEach(d=>{var u;(u=r.value)==null||u.toggleRowSelection(d)})},i=R([]),B=o=>{i.value=o},T=async o=>{var s;(s=r.value)==null||s.toggleRowSelection(o,void 0)},j=async()=>{await I.$confirm({message:"确定要清空吗？",onConfirm:async()=>{var o;i.value=[],(o=r.value)==null||o.clearSelection()}})},{isLock:z,lockFn:N}=G(async()=>{if(i.value.length===0){J.msgWarning("请选择要添加的好友");return}E(),b("success",i.value)}),W=async()=>{const{lists:o}=await re({page_size:999,wechat_id:y.wechatId});x.value=o,x.value.length>0&&(p.wechat_id=y.wechatId,v())},A=()=>{var o;(o=C.value)==null||o.open(),W()},E=()=>{b("close")};return L({open:A}),(o,s)=>{const c=X,d=Y,u=ee,m=ne,K=oe,P=le,U=ae;return f(),V(Q,{"custom-class":"add-friend",ref_key:"popupRef",ref:C,"hide-title":"",width:"900px","show-close":!1,"cancel-button-text":"","confirm-button-text":""},{default:a(()=>[e("div",fe,[e("div",pe,[e("div",_e,[t(de,{"wechat-list":l(x),"show-add-we-chat":!1,"current-wechat":{wechat_id:k.wechatId}},null,8,["wechat-list","current-wechat"])]),e("div",ue,[e("div",me,[e("div",he,[t(u,{modelValue:l(p).nickname,"onUpdate:modelValue":s[1]||(s[1]=n=>l(p).nickname=n),placeholder:"搜索",class:"!w-[200px] h-[32px]",clearable:"",onClear:s[2]||(s[2]=n=>g()),onKeyup:s[3]||(s[3]=M(n=>g(),["enter"]))},{append:a(()=>[t(d,{onClick:s[0]||(s[0]=n=>g())},{default:a(()=>[t(c,{name:"el-icon-Search"})]),_:1})]),_:1},8,["modelValue"])])]),e("div",xe,[t(l(te),{ref_key:"friendTableRef",ref:r,data:l(_).lists,stripe:"",height:"100%","row-style":{height:"60px"},"row-key":"friend_id",onSelectionChange:B},{default:a(()=>[t(m,{type:"selection","reserve-selection":"",width:"55",fixed:"left"}),t(m,{prop:"friend_nickname",label:"微信名称"}),t(m,{prop:"avatar",label:"头像"},{default:a(({row:n})=>[e("img",{src:n.friend_avatar,class:"w-8 h-8 rounded mx-auto"},null,8,ve)]),_:1}),t(m,{prop:"remark",label:"备注名称"},{default:a(({row:n})=>[$(h(n.remark||"-"),1)]),_:1})]),_:1},8,["data"])]),e("div",ge,[t(K,{modelValue:l(_),"onUpdate:modelValue":s[4]||(s[4]=n=>Z(_)?_.value=n:null),onChange:l(v)},null,8,["modelValue","onChange"])])]),e("div",we,[e("div",ke,[e("div",ye,[e("div",be,"已选好友（"+h(l(i).length)+"）人",1),t(d,{link:"",onClick:j},{default:a(()=>[t(c,{name:"local-icon-clean",size:16,color:"#ffffff"}),s[5]||(s[5]=e("span",{class:"text-white ml-2"},"清空",-1))]),_:1})])]),e("div",Ce,[l(i).length>0?(f(),V(P,{key:0},{default:a(()=>[e("div",Ee,[(f(!0),w(O,null,H(l(i),n=>(f(),w("div",{key:n.friend_id,class:"flex items-center gap-x-4"},[e("img",{src:n.friend_avatar,class:"flex-shrink-0 w-8 h-8 rounded"},null,8,Se),e("div",Re,[e("div",Ve,h(n.friend_nickname),1),e("div",null,h(n.remark||"-"),1)]),e("div",{class:"flex-shrink-0 w-4 h-4 rounded-full bg-error flex items-center justify-center cursor-pointer",onClick:Be=>T(n)},[t(c,{name:"local-icon-close",color:"#ffffff"})],8,$e)]))),128))])]),_:1})):(f(),w("div",Le,[t(U,{description:"暂无数据"})]))]),e("div",Fe,[t(d,{type:"primary",class:"w-full !h-[37px]",loading:l(z),onClick:l(N)},{default:a(()=>[...s[6]||(s[6]=[$(" 确定添加 ",-1)])]),_:1},8,["loading","onClick"])])])]),e("div",Ie,[t(d,{circle:"",type:"primary",onClick:E},{default:a(()=>[t(c,{name:"local-icon-close",color:"#ffffff",size:16})]),_:1})])])]),_:1},512)}}});export{Ge as _};
