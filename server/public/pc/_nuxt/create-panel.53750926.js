import{d as Z,at as Q,c as X,aF as Y,r as w,A as ee,cq as te,G as p,b6 as se,k as r,l as d,m as t,q as o,s as n,v as le,Z as a,L as _,J as v,K as g,I as y,aI as U,t as ae,a0 as oe,aH as $,y as ie,ax as re,cT as ne,cU as de,au as fe,aw as pe,_ as me}from"./entry.d9d53b29.js";import{_ as ce}from"./index.ece7f347.js";import{E as ue,a as _e}from"./index.79f7263c.js";import{E as ve}from"./el-switch.d7a8c51d.js";import{_ as xe}from"./index.vue.3e248b2d.js";import{E as be}from"./index.050c9b6b.js";/* empty css                  *//* empty css               *//* empty css                     */import{u as ke}from"./useDictOptions.794690b5.js";import{h as we,d as ge}from"./sph.47a77ad4.js";import{z as ye}from"./person_wechat.8bcf26fc.js";import{_ as he}from"./remark-pop.vue.94ece9df.js";import"./index.d23c2db7.js";import"./index.cce223cb.js";import"./cloneDeep.df46b56a.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./index.8a3302e5.js";import"./strings.fbd015b4.js";import"./debounce.39f38609.js";import"./_baseIteratee.73cb21ab.js";import"./index.4538c991.js";const Ve={class:"h-full bg-app-bg-2 rounded-[20px] flex flex-col"},Ee={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},Ce={class:"flex items-center gap-1"},Re={class:"grow min-h-0"},Se={class:"w-[456px] mx-auto mt-6"},Le={class:"mt-6 flex flex-col gap-y-3"},De={key:0},Ue={class:"flex flex-col items-center justify-center py-6"},$e={key:1},Ae={class:"bg-app-bg-3 rounded-xl shadow-[0_0_0_1px_var(--app-border-color-2)] p-4 mt-4"},Ie={class:"mt-2"},We={class:"mt-2"},ze={class:"mt-2"},Be={class:"flex items-center gap-x-4"},je={class:"flex-1"},Pe={class:"flex items-center gap-x-2"},Te={class:"flex-1"},Fe={class:"flex-1"},Ge={class:"flex items-center gap-x-2"},Ne={class:"flex-1"},Oe={class:"mt-3"},qe={class:"flex items-center justify-between mb-3"},Me={key:0},He={class:"flex flex-wrap gap-2"},Je=["onClick"],Ke={class:"text-white text-xs"},Ze=["onClick"],Qe={class:"flex justify-end"},Xe=Z({__name:"create-panel",emits:["back"],setup(Ye,{emit:A}){const h=A,I=Q(),V=X(()=>I.config.wechat_remarks||[]),s=Y({source:1,fileurl:"",crawling_task_ids:[],add_type:"1",add_number:0,add_interval_time:0,add_friends_prompt:"",add_remark_enable:1,remarks:V.value||[],wechat_id:[],wechat_reg_type:0}),E=w([]),m=w(!1),x=ee(),u=w(-1),{optionsData:W}=ke({wechatLists:{api:ye,params:{page_size:1e3},transformData:i=>i.lists}}),z=i=>{s.fileurl=i.data.uri},B=async()=>{var i;m.value=!0,await $(),(i=x.value)==null||i.open()},j=i=>{u.value==-1?s.remarks.push(i):s.remarks[u.value]=i,u.value=-1,m.value=!1},P=async(i,e)=>{var f;m.value=!0,u.value=e,await $(),(f=x.value)==null||f.open(i)},T=i=>{s.remarks.splice(i,1)},{isLock:F,lockFn:G}=te(async()=>{if(s.source==1&&!s.fileurl){p.msgWarning("请上传文件");return}if(s.source==2&&!s.crawling_task_ids.length){p.msgWarning("请选择获客任务");return}if(s.add_type=="1"){if(!s.wechat_id.length){p.msgWarning("请选择加微微信");return}if(s.add_remark_enable==1&&!s.remarks.length){p.msgWarning("请输入加好友备注内容");return}}try{await we(s),p.msgSuccess("创建成功"),h("back")}catch(i){p.msgError(i)}}),C=async i=>{const{lists:e}=await ge({page:1,page_size:20,status:4,name:i});E.value=e};return C(),(i,e)=>{const f=ie,R=re,S=ne,N=de,O=ce,c=ue,b=_e,L=fe,q=ve,M=xe,H=pe,J=be,D=se("number-input");return r(),d(v,null,[t("div",Ve,[t("div",Ee,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[0]||(e[0]=l=>h("back"))},[o(f,{name:"el-icon-ArrowLeft",color:"#ffffff"}),e[10]||(e[10]=t("div",{class:"text-white"},"返回",-1))]),t("div",Ce,[o(R,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:a(F),onClick:a(G)},{default:n(()=>e[11]||(e[11]=[le(" 确认执行 ",-1)])),_:1,__:[11]},8,["loading","onClick"])])]),t("div",Re,[o(J,null,{default:n(()=>[t("div",Se,[e[30]||(e[30]=t("div",{class:"text-[20px] font-bold text-white"},"创建新的自动加好友任务",-1)),t("div",Le,[t("div",null,[e[14]||(e[14]=t("div",{class:"text-[#ffffff80] mb-3"},"线索来源",-1)),t("div",null,[o(N,{modelValue:a(s).source,"onUpdate:modelValue":e[1]||(e[1]=l=>a(s).source=l)},{default:n(()=>[o(S,{value:1,border:""},{default:n(()=>e[12]||(e[12]=[t("div",{class:"text-white"},"表格导入",-1)])),_:1,__:[12]}),o(S,{value:2,border:""},{default:n(()=>e[13]||(e[13]=[t("div",{class:"text-white"},"获客任务引用",-1)])),_:1,__:[13]})]),_:1},8,["modelValue"])])]),a(s).source==1?(r(),d("div",De,[e[17]||(e[17]=t("div",{class:"flex items-center justify-between mb-3"},[t("div",{class:"text-[#ffffff80]"},"导入模版"),t("div",{class:"text-primary cursor-pointer"},[t("a",{href:"/static/file/template/wechatidcsv.csv",target:"_blank"},"下载模版")])],-1)),o(O,{type:"file","list-type":"text","show-file-list":"",accept:".csv,.xlsx",drag:"",limit:1,onSuccess:z,onRemove:e[2]||(e[2]=l=>a(s).fileurl="")},{default:n(()=>[t("div",Ue,[o(f,{name:"local-icon-upload2",size:48,color:"#ffffff4d"}),e[15]||(e[15]=t("div",{class:"mt-3 text-[#ffffff4d]"},"点击添加或将文件拖拽到该处",-1)),e[16]||(e[16]=t("div",{class:"text-xs text-[#ffffff33] mt-2 w-[80%]"}," 支持扩展名：.csv、.xlsx格式 ",-1))])]),_:1})])):_("",!0),a(s).source==2?(r(),d("div",$e,[e[18]||(e[18]=t("div",{class:"text-[#ffffff80] mb-3"},"获客任务引用",-1)),o(b,{modelValue:a(s).crawling_task_ids,"onUpdate:modelValue":e[3]||(e[3]=l=>a(s).crawling_task_ids=l),placeholder:"请选择获客任务",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","popper-class":"dark-select-popper","show-arrow":!1,"remote-method":C},{default:n(()=>[(r(!0),d(v,null,g(a(E),l=>(r(),y(c,{label:l.name,value:l.id,key:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):_("",!0),t("div",Ae,[e[29]||(e[29]=t("div",{class:"text-white"},"自动加好友设置",-1)),t("div",Ie,[e[19]||(e[19]=t("div",{class:"text-[#ffffff80] mb-3"},"加微微信：",-1)),o(b,{modelValue:a(s).wechat_id,"onUpdate:modelValue":e[4]||(e[4]=l=>a(s).wechat_id=l),placeholder:"请选择添加的微信",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:n(()=>[(r(!0),d(v,null,g(a(W).wechatLists,l=>(r(),y(c,{label:l.wechat_nickname,value:l.wechat_id,key:l.wechat_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",We,[e[20]||(e[20]=t("div",{class:"text-[#ffffff80] mb-3"},"加微规则：",-1)),o(b,{modelValue:a(s).wechat_reg_type,"onUpdate:modelValue":e[5]||(e[5]=l=>a(s).wechat_reg_type=l),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1},{default:n(()=>[o(c,{label:"全部",value:0}),o(c,{label:"微信号",value:1}),o(c,{label:"手机号",value:2})]),_:1},8,["modelValue"])]),t("div",ze,[e[25]||(e[25]=t("div",{class:"text-[#ffffff80] mb-3"},"自动加好友频率：",-1)),t("div",Be,[t("div",je,[e[22]||(e[22]=t("div",{class:"text-white mb-3"},"当天执行",-1)),t("div",Pe,[t("div",Te,[U(o(L,{modelValue:a(s).add_number,"onUpdate:modelValue":e[6]||(e[6]=l=>a(s).add_number=l),type:"number",class:"!h-11"},null,8,["modelValue"]),[[D,{min:0,max:99}]])]),e[21]||(e[21]=t("span",{class:"text-[#ffffff80]"},"次",-1))])]),t("div",Fe,[e[24]||(e[24]=t("div",{class:"text-white mb-3"},"每次间隔",-1)),t("div",Ge,[t("div",Ne,[U(o(L,{modelValue:a(s).add_interval_time,"onUpdate:modelValue":e[7]||(e[7]=l=>a(s).add_interval_time=l),type:"number",class:"!h-11"},null,8,["modelValue"]),[[D,{min:0,max:999}]])]),e[23]||(e[23]=t("span",{class:"text-[#ffffff80]"},"分钟",-1))])])])]),t("div",Oe,[t("div",qe,[e[26]||(e[26]=t("div",{class:"text-white"},"加好友备注内容",-1)),o(q,{modelValue:a(s).add_remark_enable,"onUpdate:modelValue":e[8]||(e[8]=l=>a(s).add_remark_enable=l),style:{"--el-switch-off-color":"#333333"},"active-value":1,"inactive-value":0},null,8,["modelValue"])]),a(s).add_remark_enable==1?(r(),d("div",Me,[t("div",He,[(r(!0),d(v,null,g(a(V),(l,k)=>(r(),d("div",{key:k,class:"cursor-pointer hover:bg-app-bg-1 transition-all duration-300 border border-app-border-2 rounded-md px-4 py-2 flex items-center",onClick:K=>P(l,k)},[t("div",Ke,ae(l),1),e[27]||(e[27]=t("div",{class:"w-[1px] h-[8px] bg-app-border-2 mx-2"},null,-1)),t("div",{class:"w-4 h-4",onClick:oe(K=>T(k),["stop"])},[o(M,{"icon-size":10})],8,Ze)],8,Je))),128))]),o(H,{class:"!my-4 !border-app-border-2"}),t("div",Qe,[o(R,{class:"!h-8 !border-[#ffffff1a]",color:"#121212",onClick:B},{default:n(()=>[o(f,{name:"el-icon-Plus",color:"#ffffff",size:12}),e[28]||(e[28]=t("div",{class:"text-white text-xs ml-1"},"新增文案",-1))]),_:1,__:[28]})])])):_("",!0)])])])])]),_:1})])]),a(m)?(r(),y(he,{key:0,ref_key:"remarkPopupRef",ref:x,onClose:e[9]||(e[9]=l=>m.value=!1),onConfirm:j},null,512)):_("",!0)],64)}}});const Vt=me(Xe,[["__scopeId","data-v-edcfa1d8"]]);export{Vt as default};
