import{cU as w,af as I,N as L,aH as m,cf as O}from"./entry.ee599c70.js";import{t as E}from"./throttle.108b0b49.js";const g=t=>{let e=0,n=t;for(;n;)e+=n.offsetTop,n=n.offsetParent;return e},A=(t,e)=>Math.abs(g(t)-g(e)),r="ElInfiniteScroll",D=50,_=200,C=0,F={delay:{type:Number,default:_},distance:{type:Number,default:C},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},h=(t,e)=>Object.entries(F).reduce((n,[o,l])=>{var f,s;const{type:u,default:c}=l,a=t.getAttribute(`infinite-scroll-${o}`);let i=(s=(f=e[a])!=null?f:a)!=null?s:c;return i=i==="false"?!1:i,i=u(i),n[o]=Number.isNaN(i)?c:i,n},{}),S=t=>{const{observer:e}=t[r];e&&(e.disconnect(),delete t[r].observer)},U=(t,e)=>{const{container:n,containerEl:o,instance:l,observer:f,lastScrollTop:s}=t[r],{disabled:u,distance:c}=h(t,l),{clientHeight:a,scrollHeight:i,scrollTop:d}=o,T=d-s;if(t[r].lastScrollTop=d,f||u||T<0)return;let b=!1;if(n===t)b=i-(a+d)<=c;else{const{clientTop:y,scrollHeight:H}=t,N=A(t,o);b=d+a>=N+y+H-c}b&&e.call(l)};function p(t,e){const{containerEl:n,instance:o}=t[r],{disabled:l}=h(t,o);l||n.clientHeight===0||(n.scrollHeight<=n.clientHeight?e.call(o):S(t))}const V={async mounted(t,e){const{instance:n,value:o}=e;w({scope:r,from:"the directive v-infinite-scroll",replacement:"the el-scrollbar infinite scroll",version:"3.0.0",ref:"https://element-plus.org/en-US/component/scrollbar#infinite-scroll"},!0),I(o)||L(r,"'v-infinite-scroll' binding value must be a function"),await m();const{delay:l,immediate:f}=h(t,n),s=O(t,!0),u=s===window?document.documentElement:s,c=E(U.bind(null,t,o),l);if(s){if(t[r]={instance:n,container:s,containerEl:u,delay:l,cb:o,onScroll:c,lastScrollTop:u.scrollTop},f){const a=new MutationObserver(E(p.bind(null,t,o),D));t[r].observer=a,a.observe(t,{childList:!0,subtree:!0}),p(t,o)}s.addEventListener("scroll",c)}},unmounted(t){if(!t[r])return;const{container:e,onScroll:n}=t[r];e==null||e.removeEventListener("scroll",n),S(t)},async updated(t){if(!t[r])await m();else{const{containerEl:e,cb:n,observer:o}=t[r];e.clientHeight&&o&&p(t,n)}}},v=V;v.install=t=>{t.directive("InfiniteScroll",v)};const B=v;export{B as E};
