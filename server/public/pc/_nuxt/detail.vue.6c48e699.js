import{_ as O}from"./index.vue.478e85a5.js";import{E as Q}from"./el-image.a83bf837.js";import{d as W,A as I,r as v,c as X,k as o,I as g,s as b,m as t,q as w,t as r,Z as i,l as a,L as c,K as E,J as u,v as D,bM as Y,u as tt,G as h,ax as st}from"./entry.2beb4577.js";import{E as et}from"./index.47b30189.js";import{E as ot}from"./el-empty.bc763313.js";import{E as at}from"./index.7d01f438.js";import"./el-image-viewer.d11cc27b.js";/* empty css                     *//* empty css                  */import{u as lt}from"./useSocialPlatform.694640c2.js";import{d as rt,b as it,c as nt}from"./device.b7e58507.js";const ct={class:"mt-[38px] px-[26px]"},dt={class:"text-[15px] font-bold text-white mb-[14px]"},ft={class:"flex"},_t={class:"text-white"},pt={class:"flex mt-2"},ut={class:"flex gap-2"},mt=["src"],xt={class:"text-white"},vt={class:"flex mt-2"},ht={class:"text-white"},yt={class:"flex mt-2"},kt={class:"text-white"},gt={class:"grow min-h-0 mt-5"},bt={class:"px-[26px]"},wt={class:"flex flex-col gap-y-3"},Et={class:"h-10 flex items-center border-0 border-b border-app-border-1 text-[#ffffff80]"},Dt={class:"py-2"},Rt={class:"text-white"},Bt={class:"mt-2 text-[11px] text-white"},Vt={class:"mt-[10px] flex flex-wrap gap-2 text-[11px] text-[#ffffff80]"},Ct={key:0,class:"grid grid-cols-4 gap-3 mt-3"},Lt={key:1,class:"mt-3"},Pt=["src","poster","onPlay"],At={class:"flex mt-[17px]"},Nt={key:0,class:"text-info"},St={key:1,class:"text-[#3BB840]"},It={key:2,class:"text-danger"},Tt={key:3,class:"text-primary"},$t={class:"flex mt-2"},jt={class:"text-white"},zt={class:"flex justify-end"},qt={key:1,class:"my-10"},Yt=W({__name:"detail",emits:["close"],setup(Ft,{expose:T,emit:$}){const j=$,{getPlatform:z}=lt(),R=I(),_=I(),p=v(!1),y=v({}),d=v({}),k=v([]),B=X(()=>{var l,s;return(s=z((l=d.value)==null?void 0:l.account_type))==null?void 0:s.icon}),q=l=>{if(!_.value||!Array.isArray(_.value))return;const s=_.value[l];s&&(_.value.forEach(n=>{n&&n!==s&&!n.paused&&n.pause()}),s.play())},F=l=>{tt().$confirm({message:"确定要删除吗？",theme:"dark",onConfirm:async()=>{try{h.loading("删除中...",R.value),await rt({id:l}),h.msgSuccess("删除成功"),V()}catch(s){h.msgError(s||"删除失败")}finally{h.closeLoading()}}})},G=l=>{p.value=!0,y.value=l,C(l.id),V()},J=()=>{p.value=!1,j("close")},V=async()=>{var s,n;const{lists:l}=await it({page_size:9999,task_type:3,publish_id:(s=y.value)==null?void 0:s.publish_id,account:(n=y.value)==null?void 0:n.account});k.value=l},C=async l=>{const s=await nt({id:l});d.value=s};return T({open:G,getDetail:C}),(l,s)=>{const n=O,K=Q,M=st,U=et,Z=ot,H=at;return o(),g(H,{modelValue:i(p),"onUpdate:modelValue":s[0]||(s[0]=m=>Y(p)?p.value=m:null),"body-class":"bg-app-bg-2 !p-0",size:"450px","with-header":!1},{default:b(()=>{var m,L,P,A,N,S;return[t("div",{class:"h-full flex flex-col",ref_key:"containerRef",ref:R},[t("div",{class:"absolute w-6 h-6 top-5 right-2",onClick:J},[w(n)]),s[8]||(s[8]=t("div",{class:"text-[15px] font-bold text-white pt-[23px] px-[26px]"},"任务详情",-1)),t("div",ct,[t("div",dt,r((m=i(d))==null?void 0:m.name),1),t("div",ft,[s[1]||(s[1]=t("div",{class:"text-[#ffffff66] flex-shrink-0"},"任务类型：",-1)),t("div",_t,r((L=i(d))==null?void 0:L.task_category),1)]),t("div",pt,[s[2]||(s[2]=t("div",{class:"text-[#ffffff66] flex-shrink-0"},"发布账号：",-1)),t("div",ut,[i(B)?(o(),a("img",{key:0,src:i(B),class:"w-4 h-4"},null,8,mt)):c("",!0),t("span",xt,r((P=i(d))==null?void 0:P.account_name)+"（设备："+r((A=i(d))==null?void 0:A.device_name)+"）",1)])]),t("div",vt,[s[3]||(s[3]=t("div",{class:"text-[#ffffff66] flex-shrink-0"},"发布数量（每天）：",-1)),t("div",ht,r(((N=i(d))==null?void 0:N.count)||0)+"条",1)]),t("div",yt,[s[4]||(s[4]=t("div",{class:"text-[#ffffff66] flex-shrink-0"},"创建时间：",-1)),t("div",kt,r(((S=i(d))==null?void 0:S.create_time)||"-"),1)])]),t("div",gt,[i(k).length>0?(o(),g(U,{key:0},{default:b(()=>[t("div",bt,[t("div",wt,[(o(!0),a(u,null,E(i(k),(e,x)=>(o(),a("div",{key:x,class:"border border-app-border-1 rounded-md px-[23px]"},[t("div",Et,[e.material_type==2?(o(),a(u,{key:0},[D(" 第"+r(x+1)+"组图文发布 ",1)],64)):c("",!0),e.material_type==1?(o(),a(u,{key:1},[D(" 第"+r(x+1)+"个视频发布 ",1)],64)):c("",!0)]),t("div",Dt,[t("div",Rt,r(e.material_title),1),t("div",Bt,r(e.material_subtitle),1),t("div",Vt,[(o(!0),a(u,null,E(e.material_tag,f=>(o(),a("div",{key:f},"#"+r(f),1))),128))]),e.material_type==2?(o(),a("div",Ct,[(o(!0),a(u,null,E(e.material_url.split(","),f=>(o(),g(K,{class:"h-[80px] rounded-md",fit:"cover",src:f,"preview-src-list":e.material_url.split(","),"preview-teleported":""},null,8,["src","preview-src-list"]))),256))])):c("",!0),e.material_type==1?(o(),a("div",Lt,[t("video",{ref_for:!0,ref_key:"videoRef",ref:_,src:e.material_url,poster:e.pic,class:"h-auto w-full rounded-md object-cover",controls:"",onPlay:f=>q(x)},null,40,Pt)])):c("",!0),t("div",At,[s[5]||(s[5]=t("div",{class:"text-[#ffffff66]"},"任务状态：",-1)),t("div",null,[e.status==0?(o(),a("span",Nt,"未发布")):c("",!0),e.status==1?(o(),a("span",St,"已发布")):c("",!0),e.status==2?(o(),a("span",It,"发布失败("+r(e.remark)+")",1)):c("",!0),e.status==3?(o(),a("span",Tt,"发布中")):c("",!0)])]),t("div",$t,[s[6]||(s[6]=t("div",{class:"text-[#ffffff66]"},"发布时间：",-1)),t("div",jt,r(e.publish_time),1)]),t("div",zt,[w(M,{color:"#121212",class:"!border-app-border-1",onClick:f=>F(e.id)},{default:b(()=>[...s[7]||(s[7]=[D("删除",-1)])]),_:1},8,["onClick"])])])]))),128))])])]),_:1})):(o(),a("div",qt,[w(Z)]))])],512)]}),_:1},8,["modelValue"])}}});export{Yt as _};
