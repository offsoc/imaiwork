import{d as ue,at as ve,z as xe,c as O,aF as he,bz as ye,r as w,A as D,cq as we,G as _,ef as be,b6 as ke,k as r,l as i,m as t,q as n,s as d,v as R,Z as l,J as v,K as b,I as h,Y as ge,t as k,L as u,aI as q,a0 as Ve,dr as J,aH as g,y as Ce,ax as Ee,au as Be,b5 as Ne,cS as De,cT as Re,aw as Se,_ as $e}from"./entry.d7219633.js";import{E as Ae,a as Ue}from"./index.50778a9c.js";import{_ as Ie}from"./index.vue.f38ca415.js";import{E as Oe}from"./el-switch.69f0f4ce.js";import{E as Te}from"./index.f15af271.js";/* empty css                  *//* empty css               *//* empty css                     */import{u as Le}from"./useDictOptions.2e009744.js";import{c as Pe}from"./sph.47a77ad4.js";import{g as ze}from"./device.317521e4.js";import{z as Fe}from"./person_wechat.8bcf26fc.js";import{CreateTypeEnum as S}from"./index.4596121c.js";import{_ as je}from"./ai-add-keyword.vue.4afe7544.js";import{_ as Ge}from"./ai-add-friend.vue.597a124d.js";import{_ as We}from"./ai-private-chat.vue.4b11ea46.js";import{_ as Ke}from"./remark-pop.vue.61720d59.js";import"./index.4953ba77.js";import"./strings.03d3529c.js";import"./debounce.085e8a4a.js";import"./_baseIteratee.5c97421a.js";import"./index.ead96a32.js";import"./chatEnum.1c450e0f.js";const He={class:"h-full bg-app-bg-2 rounded-[20px] flex flex-col"},Me={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},qe={class:"flex items-center gap-1"},Je={class:"grow min-h-0"},Ye={class:"w-[456px] mx-auto mt-6"},Ze={class:"mt-6 flex flex-col gap-y-3"},Qe={class:"keyword-content"},Xe={class:"max-h-[200px] overflow-y-auto flex flex-col gap-y-2 dynamic-scroller"},et={class:"flex-1"},tt=["onClick"],st={class:"flex justify-end mt-3"},at={class:"mb-3 flex items-center gap-x-2"},lt={class:"cursor-pointer"},ot={class:"w-[303px]"},nt={class:"mt-5"};const rt={class:"bg-app-bg-3 rounded-xl shadow-[0_0_0_1px_var(--app-border-color-2)] p-4"},dt={class:"flex justify-between items-center"},it={class:"mt-2"},ct={class:"mt-2"},ft={class:"mt-2"},pt={class:"flex items-center gap-x-4"},mt={class:"flex-1"},_t={class:"flex items-center gap-x-2"},ut={class:"flex-1"},vt={class:"flex-1"},xt={class:"flex items-center gap-x-2"},ht={class:"flex-1"},yt={class:"mt-3"},wt={class:"flex items-center justify-between"},bt={key:0,class:"mt-3"},kt={class:"flex justify-end mt-4"},gt={key:1},Vt={class:"flex flex-wrap gap-2"},Ct=["onClick"],Et={class:"text-white text-xs"},Bt=["onClick"],Nt={class:"flex justify-end"},Dt=ue({__name:"create-panel",emits:["back"],setup(Rt,{emit:Y}){const T=Y,Z=ve(),L=xe(),P=O(()=>{var o;return(o=L.getTokenByScene(J.SPH_OCR))==null?void 0:o.score}),Q=O(()=>{var o;return(o=L.getTokenByScene(J.SPH_LOCAL_OCR))==null?void 0:o.score}),z=O(()=>Z.config.wechat_remarks||[]),s=he({name:ye().format("MMDDHHmmss")+"视频号获客任务",device_codes:[],type:[4],keywords:[""],chat_type:"0",chat_number:30,chat_interval_time:10,add_type:"1",remark:"",add_number:15,add_interval_time:10,greeting_content:"",crawl_type:S.ACCOUNT,private_message_prompt:"",add_friends_prompt:"",wechat_id:[],wechat_reg_type:0,ocr_type:1,add_remark_enable:1,remarks:z.value||[]}),{optionsData:F}=Le({deviceLists:{api:ze,params:{page_size:1e3},transformData:o=>o.lists},wechatLists:{api:Fe,params:{page_size:1e3},transformData:o=>o.lists}}),X=[{label:"视频获客",value:S.VIDEO},{label:"账号获客",value:S.ACCOUNT}],$=w(!1),j=D(),G=async o=>{o=="ai"?($.value=!0,await g(),j.value.open()):s.keywords.push("")},ee=o=>{s.keywords.length!=0&&s.keywords.push(...o)},te=o=>{if(s.keywords.length==1){_.msgWarning("检索关键词至少存在一个！");return}s.keywords.splice(o,1)},V=w(!1),C=w(!1),A=D(),U=D(),se=async o=>{var e,c,p,m;o=="add_friend"?(V.value=!0,await g(),(e=A.value)==null||e.open(),(c=A.value)==null||c.setFormData({content:s.add_friends_prompt})):(C.value=!0,await g(),(p=U.value)==null||p.open(),(m=U.value)==null||m.setFormData({content:s.private_message_prompt}))},ae=o=>{V.value=!1,s.add_friends_prompt=o},le=o=>{C.value=!1,s.private_message_prompt=o},y=w(!1),I=D(),E=w(-1),oe=async()=>{var o;y.value=!0,await g(),(o=I.value)==null||o.open()},ne=o=>{E.value==-1?s.remarks.push(o):s.remarks[E.value]=o,E.value=-1,y.value=!1},re=async(o,e)=>{var c;y.value=!0,E.value=e,await g(),(c=I.value)==null||c.open(o)},de=o=>{s.remarks.splice(o,1)},{lockFn:ie,isLock:ce}=we(async()=>{if(s.name){if(s.device_codes.length==0){_.msgWarning("请选择执行设备");return}else if(s.keywords.length==1&&!s.keywords[0]){_.msgWarning("请输入检索关键词");return}else if(s.add_type=="1"&&s.wechat_id.length==0){_.msgWarning("请选择加微微信");return}}else{_.msgWarning("请输入任务名称");return}if(s.add_remark_enable==1&&s.remarks.length==0){_.msgWarning("请输入加好友备注内容");return}try{await Pe({...s,keywords:s.keywords.filter(o=>o),type:[be.SPH]}),_.msgSuccess("创建成功"),T("back")}catch(o){_.msgError(o)}});return(o,e)=>{const c=Ce,p=Ee,m=Be,x=Ae,B=Ue,W=Ie,fe=Ne,K=De,pe=Re,H=Oe,me=Se,_e=Te,M=ke("number-input");return r(),i(v,null,[t("div",He,[t("div",Me,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[0]||(e[0]=a=>T("back"))},[n(c,{name:"el-icon-ArrowLeft",color:"#ffffff"}),e[24]||(e[24]=t("div",{class:"text-white"},"返回",-1))]),t("div",qe,[n(p,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:l(ce),onClick:l(ie)},{default:d(()=>e[25]||(e[25]=[R(" 创建任务 ",-1)])),_:1,__:[25]},8,["loading","onClick"])])]),t("div",Je,[n(_e,null,{default:d(()=>[t("div",Ye,[e[56]||(e[56]=t("div",{class:"text-[20px] font-bold text-white"},"创建新的自动获客任务",-1)),t("div",Ze,[t("div",null,[e[26]||(e[26]=t("div",{class:"text-[#ffffff80] mb-3"},"任务名称",-1)),n(m,{modelValue:l(s).name,"onUpdate:modelValue":e[1]||(e[1]=a=>l(s).name=a),placeholder:"请输入任务名称",class:"!h-11",maxlength:"30","show-word-limit":"",clearable:""},null,8,["modelValue"])]),t("div",null,[e[27]||(e[27]=t("div",{class:"text-[#ffffff80] mb-3"},"任务类型",-1)),t("div",null,[n(B,{modelValue:l(s).crawl_type,"onUpdate:modelValue":e[2]||(e[2]=a=>l(s).crawl_type=a),placeholder:"请选择任务类型",class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[(r(),i(v,null,b(X,a=>n(x,{label:a.label,value:a.value,key:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),t("div",null,[e[28]||(e[28]=t("div",{class:"text-[#ffffff80] mb-3"},"执行设备",-1)),t("div",null,[n(B,{modelValue:l(s).device_codes,"onUpdate:modelValue":e[3]||(e[3]=a=>l(s).device_codes=a),placeholder:"请选择执行设备",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[(r(!0),i(v,null,b(l(F).deviceLists,a=>(r(),h(x,{label:a.device_code,value:a.device_code,key:a.device_code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),t("div",null,[e[32]||(e[32]=t("div",{class:"text-[#ffffff80] mb-3"},"检索关键词",-1)),t("div",Qe,[t("div",Xe,[(r(!0),i(v,null,b(l(s).keywords,(a,f)=>(r(),i("div",{key:f,class:"flex items-center bg-app-bg-3 gap-x-2 border border-app-border-2 px-3 h-11 rounded-md"},[t("div",{class:ge(["rounded-[100px] text-white min-w-[32px] h-5 flex items-center justify-center",[a?"bg-[#3BB840]":"shadow-[0_0_0_1px_var(--app-border-color-2)]"]])},k(f+1),3),t("div",et,[n(m,{modelValue:l(s).keywords[f],"onUpdate:modelValue":N=>l(s).keywords[f]=N,class:"!h-11",placeholder:"请输入相关关键词",maxlength:"30","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),e[29]||(e[29]=t("div",{class:"w-[1px] h-[12px] bg-[#ffffff1a]"},null,-1)),t("div",null,[t("div",{class:"w-4 h-4",onClick:N=>te(f)},[n(W,{"icon-size":10})],8,tt)])]))),128))]),t("div",st,[n(p,{type:"primary",class:"!h-[26px] !text-[11px]",onClick:e[4]||(e[4]=a=>G("ai"))},{default:d(()=>e[30]||(e[30]=[R("AI添加",-1)])),_:1,__:[30]}),n(p,{class:"!h-[26px] !text-[11px] !border-app-border-2",color:"#181818",onClick:e[5]||(e[5]=a=>G("manual"))},{default:d(()=>e[31]||(e[31]=[R("手动添加",-1)])),_:1,__:[31]})])])]),t("div",null,[t("div",at,[e[33]||(e[33]=t("div",{class:"text-[#ffffff80]"},"线索识别方式",-1)),n(fe,{content:"请选择线索识别方式",placement:"top"},{content:d(()=>[t("div",ot,[t("div",null," 本地识别（每条扣"+k(l(Q))+"算力）使用系统内置识别逻辑完成，识别率较依赖本地环境，复杂图片可能不够精准 ",1),t("div",nt," 云端OCR识别（每条扣 "+k(l(P))+" 算力）使用云端OCR服务识别微信号，每条线索消耗"+k(l(P))+"算力，识别率更高，支持更复杂的图片和场景 ",1)])]),default:d(()=>[t("div",lt,[n(c,{name:"local-icon-tips2",color:"#ffffff"})])]),_:1})]),t("div",null,[n(pe,{modelValue:l(s).ocr_type,"onUpdate:modelValue":e[6]||(e[6]=a=>l(s).ocr_type=a)},{default:d(()=>[n(K,{value:1},{default:d(()=>e[34]||(e[34]=[t("span",{class:"text-white"},"云端OCR识别",-1)])),_:1,__:[34]}),n(K,{value:2},{default:d(()=>e[35]||(e[35]=[t("span",{class:"text-white"},"本地识别",-1)])),_:1,__:[35]})]),_:1},8,["modelValue"])])]),u("",!0),t("div",rt,[t("div",dt,[e[44]||(e[44]=t("div",{class:"text-white"},"自动加好友设置",-1)),t("div",null,[n(H,{modelValue:l(s).add_type,"onUpdate:modelValue":e[12]||(e[12]=a=>l(s).add_type=a),style:{"--el-switch-off-color":"#333333"},"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])]),l(s).add_type=="1"?(r(),i(v,{key:0},[t("div",it,[e[45]||(e[45]=t("div",{class:"text-[#ffffff80] mb-3"},"加微微信：",-1)),n(B,{modelValue:l(s).wechat_id,"onUpdate:modelValue":e[13]||(e[13]=a=>l(s).wechat_id=a),placeholder:"请选择添加的微信",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[(r(!0),i(v,null,b(l(F).wechatLists,a=>(r(),h(x,{label:a.wechat_nickname,value:a.wechat_id,key:a.wechat_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",ct,[e[46]||(e[46]=t("div",{class:"text-[#ffffff80] mb-3"},"加微规则：",-1)),n(B,{modelValue:l(s).wechat_reg_type,"onUpdate:modelValue":e[14]||(e[14]=a=>l(s).wechat_reg_type=a),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[n(x,{label:"全部",value:0}),n(x,{label:"微信号",value:1}),n(x,{label:"手机号",value:2})]),_:1},8,["modelValue"])]),t("div",ft,[e[51]||(e[51]=t("div",{class:"text-[#ffffff80] mb-3"},"自动加好友频率：",-1)),t("div",pt,[t("div",mt,[e[48]||(e[48]=t("div",{class:"text-white mb-3"},"当天执行",-1)),t("div",_t,[t("div",ut,[q(n(m,{modelValue:l(s).add_number,"onUpdate:modelValue":e[15]||(e[15]=a=>l(s).add_number=a),type:"number",class:"!h-11"},null,8,["modelValue"]),[[M,{min:0,max:99}]])]),e[47]||(e[47]=t("span",{class:"text-[#ffffff80]"},"次",-1))])]),t("div",vt,[e[50]||(e[50]=t("div",{class:"text-white mb-3"},"每次间隔",-1)),t("div",xt,[t("div",ht,[q(n(m,{modelValue:l(s).add_interval_time,"onUpdate:modelValue":e[16]||(e[16]=a=>l(s).add_interval_time=a),type:"number",class:"!h-11"},null,8,["modelValue"]),[[M,{min:0,max:999}]])]),e[49]||(e[49]=t("span",{class:"text-[#ffffff80]"},"分钟",-1))])])])]),t("div",yt,[t("div",wt,[e[52]||(e[52]=t("div",{class:"text-white mb-3"},"加好友验证内容",-1)),n(H,{modelValue:l(s).add_remark_enable,"onUpdate:modelValue":e[17]||(e[17]=a=>l(s).add_remark_enable=a),style:{"--el-switch-off-color":"#333333"},"active-value":1,"inactive-value":0},null,8,["modelValue"])]),l(s).add_remark_enable==0?(r(),i("div",bt,[n(m,{modelValue:l(s).remark,"onUpdate:modelValue":e[18]||(e[18]=a=>l(s).remark=a),type:"textarea",placeholder:"请输入备注内容，为了避免封控，系统将自动调用AI进行去重润色",resize:"none",rows:3},null,8,["modelValue"]),t("div",kt,[n(p,{type:"primary",class:"!h-[26px] !text-[11px]",onClick:e[19]||(e[19]=a=>se("add_friend"))},{default:d(()=>e[53]||(e[53]=[R("AI提示词设置",-1)])),_:1,__:[53]})])])):u("",!0),l(s).add_remark_enable==1?(r(),i("div",gt,[t("div",Vt,[(r(!0),i(v,null,b(l(z),(a,f)=>(r(),i("div",{key:f,class:"cursor-pointer hover:bg-app-bg-1 transition-all duration-300 border border-app-border-2 rounded-md px-4 py-2 flex items-center",onClick:N=>re(a,f)},[t("div",Et,k(a),1),e[54]||(e[54]=t("div",{class:"w-[1px] h-[8px] bg-app-border-2 mx-2"},null,-1)),t("div",{class:"w-4 h-4",onClick:Ve(N=>de(f),["stop"])},[n(W,{"icon-size":10})],8,Bt)],8,Ct))),128))]),n(me,{class:"!my-4 !border-app-border-2"}),t("div",Nt,[n(p,{class:"!h-8 !border-[#ffffff1a]",color:"#121212",onClick:oe},{default:d(()=>[n(c,{name:"el-icon-Plus",color:"#ffffff",size:12}),e[55]||(e[55]=t("div",{class:"text-white text-xs ml-1"},"新增文案",-1))]),_:1,__:[55]})])])):u("",!0)])],64)):u("",!0)])])])]),_:1})])]),l($)?(r(),h(je,{key:0,ref_key:"aiAddKeywordRef",ref:j,type:l(s).crawl_type==l(S).VIDEO?2:3,onClose:e[20]||(e[20]=a=>$.value=!1),onSuccess:ee},null,8,["type"])):u("",!0),l(V)?(r(),h(Ge,{key:1,ref_key:"aiAddFriendRef",ref:A,onClose:e[21]||(e[21]=a=>V.value=!1),onConfirm:ae},null,512)):u("",!0),l(C)?(r(),h(We,{key:2,ref_key:"aiPrivateChatRef",ref:U,onClose:e[22]||(e[22]=a=>C.value=!1),onConfirm:le},null,512)):u("",!0),l(y)?(r(),h(Ke,{key:3,ref_key:"remarkPopupRef",ref:I,onClose:e[23]||(e[23]=a=>y.value=!1),onConfirm:ne},null,512)):u("",!0)],64)}}});const es=$e(Dt,[["__scopeId","data-v-802fad25"]]);export{es as default};
