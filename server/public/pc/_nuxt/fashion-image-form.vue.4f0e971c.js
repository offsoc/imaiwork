import{_ as ae}from"./index.vue.3e248b2d.js";import{d as ne,aF as re,r as h,aV as ie,G as v,k as f,l as _,m as o,q as l,s as n,Z as r,J as g,a0 as O,t as C,K as M,L as k,I as U,v as S,Y as ce,u as fe,y as pe,av as ue,ax as de,ay as me}from"./entry.d9d53b29.js";import{_ as _e}from"./index.ece7f347.js";import{E as ge,a as he}from"./el-tabs.4663b04e.js";import{E as ve}from"./el-image.239907bf.js";import{E as xe}from"./index.050c9b6b.js";import{E as ye}from"./el-image-viewer.291603f7.js";/* empty css                     */import{u as we}from"./useDictOptions.794690b5.js";import{a as Ee,c as be,d as Ce}from"./drawing.7058a163.js";import{FashionImageTypeEnum as p}from"./index.fb0aa6a9.js";import{_ as V}from"./case-image-v2.vue.6690f66a.js";const ke={class:"h-full flex flex-col"},Se={class:"h-[164px] w-full flex flex-col items-center justify-center leading-[1.5] relative"},Ie=["src"],Le=["onClick"],Re={class:"text-xs text-[#ffffff4d] mt-3 mx-[50px]"},Pe={class:"type-tabs"},De={class:"grow min-h-0"},Te={class:"p-4"},ze={class:"w-full"},Fe={class:"w-full"},Oe={class:"w-full"},Me={class:"flex justify-between gap-2"},Ue={class:"w-full h-[420px]"},Ve={class:"grid grid-cols-3 gap-2"},$e={class:"h-[127px] w-full flex-col rounded-md flex items-center justify-center bg-app-bg-3"},We=["onClick"],je={class:"absolute top-0 left-0 w-full h-full invisible group-hover:visible bg-[var(--el-overlay-color-lighter)] flex items-center justify-center"},Be=["onClick"],He={class:"fixed right-4 top-[93px] z-[22]"},$=".jpg,.jpeg,.png",W=20,os=ne({__name:"fashion-image-form",emits:["update:formData","generatePrompt"],setup(Ne,{expose:j,emit:B}){const H=B,I=[{label:"上下装",value:p.UPPER_LOWER_CLOTHES},{label:"连衣裙",value:p.DRESS}],e=re({type:p.UPPER_LOWER_CLOTHES,dress:"",upper_clothes:"",lower_clothes:"",persons:[],img_count:0}),x=[2,1],N=(t,s)=>{const a=t.data.uri;if(e.type==p.DRESS){e.upper_clothes=a,e.lower_clothes=e.upper_clothes;return}e[s]=a},{optionsData:d}=we({modelList:{api:Ee,params:{case_type:4,page_size:999},transformData:t=>t.lists.map(s=>({...s,result_image:s.result_image}))}}),q=t=>{const s=t.data.uri;d.modelList.unshift({result_image:s}),be({result_image:s})},A=t=>{e.persons.includes(t)?e.persons=[]:e.persons=[t],e.img_count=e.persons.length},G=t=>{fe().$confirm({title:"提示",message:"确定删除该模特吗？",theme:"dark",onConfirm:async()=>{const s=d.modelList[t];if(s.user_id)try{await Ce({id:s.id}),v.msgSuccess("删除成功"),d.modelList.splice(t,1),e.persons.splice(t,1)}catch{v.msgError("删除失败")}}})},w=h(!1),L=h(0),R=h([]),J=t=>{w.value=!0,L.value=t,R.value=d.modelList.map(s=>s.result_image)},P=h(),K=()=>{P.value.open()},Y=t=>{const{data:s}=t,a=s.result_image,c=d.modelList.find(m=>m.result_image==a);if(c){e.persons=[a],e.persons.includes(a)||e.persons.push(a);return}d.modelList.unshift(c),e.persons=[a]},D=h(),Z=()=>{D.value.open()},Q=t=>{var c,m;const{case_type:s,data:a}=t;s==0&&(e.upper_clothes=(c=a.params)==null?void 0:c.images[0],e.lower_clothes=(m=a.params)==null?void 0:m.images[1],e.type=p.UPPER_LOWER_CLOTHES),s==1&&(e.dress=a.result_image,e.upper_clothes=e.dress,e.lower_clothes=e.dress,e.type=p.DRESS)};let T;const X={setup(t,{slots:s}){return()=>{T=s.default}}},E=t=>T(t);return ie(()=>{H("update:formData",e)}),j({getFormData:()=>{var t;return{params:{upper_clothes:e.upper_clothes,lower_clothes:e.lower_clothes,persons:e.persons,img_count:e.persons.length},type:e.type,type_name:(t=I.find(s=>s.value==e.type))==null?void 0:t.label}},validateForm:()=>new Promise((t,s)=>{if(!e.upper_clothes){v.msgWarning("请上传上衣"),s(!1);return}if(e.type==p.UPPER_LOWER_CLOTHES&&!e.lower_clothes){v.msgWarning("请上传下装"),s(!1);return}if(e.persons.length==0){v.msgWarning("请选择模特"),s(!1);return}t(!0)})}),(t,s)=>{const a=ae,c=pe,m=_e,ee=ge,se=he,y=ue,b=de,te=ve,z=xe,oe=me,le=ye;return f(),_(g,null,[o("div",ke,[l(X,null,{default:n(({type:i})=>[l(m,{class:"w-full h-full","show-progress":"",drag:"","show-file-list":!1,accept:$,"ratio-size":[x[0],x[1]],"max-size":W,onSuccess:u=>N(u,i)},{default:n(()=>[o("div",Se,[r(e)[i]?(f(),_(g,{key:0},[o("img",{src:r(e)[i],class:"w-full h-full object-contain"},null,8,Ie),o("div",{class:"absolute top-1 right-1 cursor-pointer w-6 h-6",onClick:O(u=>r(e)[i]="",["stop"])},[l(a)],8,Le),s[2]||(s[2]=o("div",{class:"absolute bottom-3 cursor-pointer px-[10px] text-white rounded-full border border-[#ffffff1a] bg-[#ffffff4d] shadow-[0px_6px_12px_0px_rgba(0,0,0,0.24)] h-[28px] flex items-center justify-center"}," 更换图片 ",-1))],64)):(f(),_(g,{key:1},[l(c,{name:"local-icon-file_add",size:28,color:"#ffffff"}),s[3]||(s[3]=o("div",{class:"text-xs text-white mt-3"},"点此上传图片 支持拖拽上传",-1)),o("div",Re," 单个文件不超过"+C(W)+"MB，宽高比小于"+C(x[0])+"/"+C(x[1])+"，请勿上传gif格式图片 ",1)],64))])]),_:2},1032,["ratio-size","onSuccess"])]),_:1}),o("div",Pe,[l(se,{modelValue:r(e).type,"onUpdate:modelValue":s[0]||(s[0]=i=>r(e).type=i)},{default:n(()=>[(f(),_(g,null,M(I,(i,u)=>l(ee,{name:i.value,label:i.label,key:u},null,8,["name","label"])),64))]),_:1},8,["modelValue"])]),o("div",De,[l(z,null,{default:n(()=>[o("div",Te,[l(oe,{model:r(e),"label-position":"top"},{default:n(()=>[r(e).type==r(p).UPPER_LOWER_CLOTHES?(f(),_(g,{key:0},[l(y,{label:"上衣部分"},{default:n(()=>[o("div",ze,[l(E,{type:"upper_clothes"})])]),_:1}),l(y,{label:"下装部分"},{default:n(()=>[o("div",Fe,[l(E,{type:"lower_clothes"})])]),_:1})],64)):k("",!0),r(e).type==r(p).DRESS?(f(),U(y,{key:1,label:"连衣裙部分"},{default:n(()=>[o("div",Oe,[l(E,{type:"upper_clothes"})])]),_:1})):k("",!0),l(y,null,{label:n(()=>[o("div",Me,[s[5]||(s[5]=o("div",null,[o("div",{class:"text-white"},"模特类型"),o("div",{class:"text-[#ffffff4d] text-[11px]"},"提示：上传模特请选择模特类型图片")],-1)),l(b,{type:"primary",size:"small",onClick:K},{default:n(()=>s[4]||(s[4]=[S("更多模特",-1)])),_:1,__:[4]})])]),default:n(()=>[o("div",Ue,[l(z,null,{default:n(()=>[o("div",Ve,[l(m,{drag:"","show-progress":"","show-file-list":!1,accept:$,onSuccess:q},{default:n(()=>[o("div",$e,[l(c,{name:"local-icon-file_add",size:28,color:"#ffffff"}),s[6]||(s[6]=o("span",{class:"mt-2 text-[11px] text-[#ffffff80]"},"点击添加模特",-1))])]),_:1}),(f(!0),_(g,null,M(r(d).modelList,(i,u)=>(f(),_("div",{key:u,class:ce(["relative h-[130px] w-full flex-col rounded-md flex items-center justify-center bg-app-bg-3 overflow-hidden border-[2px] border-[#ffffff33] cursor-pointer group",r(e).persons.includes(i.result_image)?"border-primary":""]),onClick:F=>A(i.result_image)},[l(te,{src:i.result_image,class:"w-full h-full",fit:"cover"},null,8,["src"]),o("div",je,[o("div",{class:"cursor-pointer absolute top-0 right-0",onClick:O(F=>J(u),["stop"])},[l(c,{name:"local-icon-fullscreen",size:32})],8,Be),l(b,{color:"#FF3C26",class:"w-[68px] !h-7 !rounded-full",onClick:F=>G(u)},{default:n(()=>s[7]||(s[7]=[S("删除",-1)])),_:2,__:[7]},1032,["onClick"])])],10,We))),128))])]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})])]),o("div",He,[l(b,{type:"primary",class:"!rounded-full w-[100px] !h-10",onClick:Z},{default:n(()=>s[8]||(s[8]=[S(" 优秀案例 ",-1)])),_:1,__:[8]})]),r(w)?(f(),U(le,{key:0,"initial-index":r(L),"url-list":r(R),onClose:s[1]||(s[1]=i=>w.value=!1)},null,8,["initial-index","url-list"])):k("",!0),l(V,{ref_key:"caseImageRef",ref:D,type:"fashion",onChoose:Q},null,512),l(V,{ref_key:"modelImageRef",ref:P,type:"model",onChoose:Y},null,512)],64)}}});export{os as _};
