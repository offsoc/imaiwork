import{d as F,r as u,ef as G,aF as D,c as W,o as q,b6 as K,k as m,l as x,m as s,q as i,s as _,v as w,Z as n,J as A,L as h,I as H,aI as J,G as c,eh as I,aH as M,y as Q,ax as Z,au as z,cP as X,_ as Y}from"./entry.46557796.js";import{_ as ee}from"./index.vue.520aef1d.js";import{l as te,m as oe,n as se,o as ne}from"./redbook.f03a8b74.js";import{_ as k}from"./copywriting-card.vue.7e0002b7.js";import"./index.304400de.js";/* empty css                     */const ae={class:"h-full bg-app-bg-2 rounded-[20px] overflow-y-auto dynamic-scroller"},le={class:"h-full flex flex-col min-w-[1000px]"},ie={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},re={class:"flex items-center gap-1"},ce={class:"grow min-h-0 flex flex-col mx-auto p-5"},de={class:"flex justify-end items-center gap-x-2 flex-shrink-0"},pe={class:"grow min-h-0 flex justify-center gap-x-[18px] mt-5"},ue={class:"content-item"},me={class:"content-item"},_e={key:1,class:"content-item"},fe={class:"-my-2"},ye={class:"mt-[18px]"},be={class:"mt-[18px]"},ve=F({__name:"create-panel",props:{type:{}},emits:["back"],setup(L,{emit:N}){const O=L,C=N,f=u(!1),y=u(!1),V=G(),e=D({id:V.id||"",title:[],oral_copy:[],described:[],copywriting_type:O.type||Number(V.copywriting_type)}),r=D({keyword:"",total_num:1}),E=W(()=>{const o=t=>t.some(d=>{var a;return(a=d.content)==null?void 0:a.trim()});return e.copywriting_type===1?!o(e.title)||!o(e.described):e.copywriting_type===2?!o(e.oral_copy):!0}),S=async()=>{if(!e.id)return;const o=await te({id:e.id});e.title=o.title||[],e.described=o.described||[],e.oral_copy=o.oral_copy||[]},T=async()=>{if(E.value){c.msgWarning("请确保所有必填项都已填写内容");return}f.value=!0;try{const o=d=>{var a;return(a=d.content)==null?void 0:a.trim()},t={...e,type:I.REDBOOK,title:e.title.filter(o),oral_copy:e.oral_copy.filter(o),described:e.described.filter(o)};e.id?await oe(t):await se(t),c.msgSuccess("操作成功"),C("back")}catch(o){c.msgError(o)}finally{f.value=!1}},b=u(),v=u(!1),U=async()=>{var o;v.value=!0,await M(),(o=b.value)==null||o.open()},B=()=>{var o;(o=b.value)==null||o.close()},j=async()=>{if(!r.keyword.trim())return c.msgWarning("请输入您希望生成的主题内容");if(!r.total_num||r.total_num<1)return c.msgWarning("生成数量必须大于0");y.value=!0;try{const o=await ne({...r,type:I.REDBOOK,copywriting_type:e.copywriting_type,channel:2});if(!o)return c.msgError("生成失败！");const{described:t,oral_copy:d,title:a}=o;if(e.copywriting_type===1){const g=a.map(p=>(p.content=p.content.slice(0,20),p));e.title.push(...g),e.described.push(...t)}else e.copywriting_type===2&&e.oral_copy.push(...d);c.msgSuccess("生成成功！"),B()}catch(o){c.msgError(o)}finally{y.value=!1}},P=()=>{C("back")};return q(()=>{e.id&&S()}),(o,t)=>{const d=Q,a=Z,g=ee,p=z,R=X,$=K("number-input");return m(),x(A,null,[s("div",ae,[s("div",le,[s("div",ie,[s("div",{class:"flex items-center gap-2 cursor-pointer",onClick:P},[i(d,{name:"el-icon-ArrowLeft",color:"#ffffff"}),t[6]||(t[6]=s("div",{class:"text-white"},"返回上一步",-1))]),s("div",re,[i(a,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:n(f),disabled:n(E),onClick:T},{default:_(()=>t[7]||(t[7]=[w(" 保存 ",-1)])),_:1,__:[7]},8,["loading","disabled"])])]),s("div",ce,[s("div",de,[i(a,{class:"!rounded-full !h-10 w-[106px] !border-app-border-2",color:"#181818",onClick:U},{default:_(()=>t[8]||(t[8]=[w(" 智能生成 ",-1)])),_:1,__:[8]})]),s("div",pe,[n(e).copywriting_type===1?(m(),x(A,{key:0},[s("div",ue,[i(k,{"model-value":n(e).title,"onUpdate:modelValue":t[0]||(t[0]=l=>n(e).title=l),type:1},null,8,["model-value"])]),s("div",me,[i(k,{"model-value":n(e).described,"onUpdate:modelValue":t[1]||(t[1]=l=>n(e).described=l),type:2},null,8,["model-value"])])],64)):h("",!0),n(e).copywriting_type===2?(m(),x("div",_e,[i(k,{"model-value":n(e).oral_copy,"onUpdate:modelValue":t[2]||(t[2]=l=>n(e).oral_copy=l),type:3,"show-topic":!1},null,8,["model-value"])])):h("",!0)])])])]),n(v)?(m(),H(R,{key:0,ref_key:"popupRef",ref:b,"cancel-button-text":"","confirm-button-text":"",style:{"background-color":"var(--app-bg-color-2)","box-shadow":"0px 0px 0px 1px var(--app-border-color-1)"},"show-close":!1,onClosed:t[5]||(t[5]=l=>v.value=!1)},{default:_(()=>[s("div",fe,[s("div",{class:"w-6 h-6 absolute top-[18px] right-[18px] cursor-pointer",onClick:B},[i(g)]),t[10]||(t[10]=s("div",{class:"text-white text-[15px] font-bold"},"智能生成",-1)),s("div",ye,[i(p,{modelValue:n(r).keyword,"onUpdate:modelValue":t[3]||(t[3]=l=>n(r).keyword=l),placeholder:"您希望生成什么样的主题内容",class:"!h-11"},null,8,["modelValue"]),J(i(p,{modelValue:n(r).total_num,"onUpdate:modelValue":t[4]||(t[4]=l=>n(r).total_num=l),min:1,type:"number",placeholder:"您希望生成的数量",class:"!h-11 mt-2"},null,8,["modelValue"]),[[$,{decimal:0}]])]),s("div",be,[i(a,{type:"primary",class:"!rounded-full !h-[50px] w-full",loading:n(y),onClick:j},{default:_(()=>t[9]||(t[9]=[w(" 开始 ",-1)])),_:1,__:[9]},8,["loading"])])])]),_:1},512)):h("",!0)],64)}}});const Ve=Y(ve,[["__scopeId","data-v-bc190dba"]]);export{Ve as default};
