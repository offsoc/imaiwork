import{d as L,c as $,r as D,o as V,k as r,l as c,m as e,q as d,s as f,aI as K,Z as i,I as P,J as v,K as y,t as g,Y as m,a0 as T,L as q,bC as b,y as J,ax as R,cW as W,_ as Z}from"./entry.f4f46cb5.js";import{E as G}from"./index.25e18e1c.js";import{E as O}from"./index.bad4fd13.js";import{E as Q}from"./el-empty.28f9091a.js";/* empty css                   *//* empty css                     */import{useChatHistory as U}from"./useChatHistory.00fd0c17.js";import"./chat.cb90ba99.js";import"./useChatManager.28d87b61.js";const X={class:"w-full h-full flex flex-col bg-[#F9FAFB] border-r border-gray-200"},ee={class:"px-4 mt-[33px]"},te={class:"flex items-center gap-1 mt-[25px]"},se={class:"grow min-h-0 mt-4"},oe={class:"px-2"},ae={class:"text-[#81858c] text-xs px-2 py-2.5 sticky top-0 z-[88] bg-[#f9fafb]"},re={class:"mb-4 flex flex-col gap-y-1"},ie=["onClick"],ne={class:"text-[14px] truncate"},ce=["onClick"],le={class:"flex flex-col gap-2"},de=["onClick"],pe={class:"flex w-5 h-5 rounded items-center justify-center bg-[#0000000b]"},_e={key:0,class:"text-tx-secondary text-center text-xs w-full py-4"},fe={key:1,class:"p-10 text-center"},me=L({__name:"chat-history",setup(ue){const{chatHistory:u,isLoading:k,isFinished:w,currentSessionId:C,fetchChatHistory:E,createNewSession:F,switchToSession:H,deleteSession:B,loadHistory:S}=U(),M=$(()=>{const n=b(),t=new Map;return u.value.forEach(s=>{const o=b(s.create_time);let l;n.diff(o,"day")<30?l="30天内":l=o.format("YYYY-MM"),t.has(l)||t.set(l,[]),t.get(l).push(s)}),Array.from(t.entries()).map(([s,o])=>({date:s,sessions:o})).sort((s,o)=>s.date===o.date?0:s.date==="30天内"?-1:o.date==="30天内"?1:o.date.localeCompare(s.date))}),_=D(""),j=(n,t)=>{_.value=n?t:""},z=n=>{_.value=n},A=()=>{F()},I=n=>{n=="bottom"&&S()};return V(()=>{E()}),(n,t)=>{const p=J,s=R,o=G,l=O,N=Q,Y=W;return r(),c("div",X,[e("div",ee,[d(s,{class:"w-full !h-[45px]",onClick:A},{default:f(()=>[d(p,{name:"local-icon-history_add",size:16}),t[0]||(t[0]=e("span",{class:"ml-2 text-[14px] font-bold"},"新建会话",-1))]),_:1}),e("div",te,[d(p,{name:"local-icon-time",size:16}),t[1]||(t[1]=e("span",{class:"text-[14px] font-bold"},"最近对话",-1))])]),K((r(),c("div",se,[i(u).length>0?(r(),P(l,{key:0,onEndReached:I},{default:f(()=>[e("div",oe,[(r(!0),c(v,null,y(i(M),h=>(r(),c("div",null,[e("div",ae,g(h.date),1),e("div",re,[(r(!0),c(v,null,y(h.sessions,a=>(r(),c("div",{key:a.task_id,class:m(["h-10 flex items-center justify-between px-2 py-[9px] cursor-pointer transition-colors rounded-lg group relative",[i(C)===a.task_id?"bg-[#e4edfd] text-primary hover:bg-[#e4edfd] hover:text-primary":" hover:bg-[#f1f3f5] "]]),onClick:()=>i(H)(a.task_id)},[e("div",ne,g(a.message),1),d(o,{"popper-class":"!p-2 !rounded-xl !border-[#efefef]",trigger:"click","show-arrow":!1,onHide:x=>j(!1,a.task_id)},{reference:f(()=>[e("div",{class:m(["absolute -right-2 h-full flex items-center justify-center w-[56px] invisible group-hover:visible",i(_)===a.task_id?"!visible":""]),onClick:T(x=>z(a.task_id),["stop"])},[e("div",{class:m(["w-[28px] h-[28px] flex items-center justify-center rounded-full hover:bg-[#2631480f] text-gray-500",i(_)===a.task_id?"!bg-[#2631480f]":""])},[d(p,{name:"el-icon-MoreFilled",size:14})],2)],10,ce)]),default:f(()=>[e("div",le,[e("div",{class:"h-8 px-3 rounded-lg cursor-pointer flex items-center gap-3 hover:shadow-[0_0_0_1px_rgba(239,239,239,1)] hover:bg-[#F6F6F6]",onClick:x=>i(B)(a.task_id)},[e("span",pe,[d(p,{name:"local-icon-delete"})]),t[2]||(t[2]=e("span",null,"删除",-1))],8,de)])]),_:2},1032,["onHide"])],10,ie))),128))])]))),256)),i(w)?q("",!0):(r(),c("div",_e,"暂无更多了~"))])]),_:1})):(r(),c("div",fe,[d(N,{description:"暂无会话记录"})]))])),[[Y,i(k)]])])}}});const Ee=Z(me,[["__scopeId","data-v-0d9caa1f"]]);export{Ee as default};
