import{_ as v}from"./chatting.db6ea2ec.js";import{d as I,z as S,aG as R,D as o,o as b,bx as x,k as N,I as y,s as z,m as B,Z as n,G as M}from"./entry.46557796.js";import{useChatManager as A}from"./useChatManager.10039942.js";import{useChatStore as G}from"./chat.1328a2b2.js";const D=I({__name:"standard-agent-chat",props:{agentId:{},agentName:{},taskId:{},detail:{}},emits:["new-conversation","update:isReceiving"],setup(l,{emit:m}){const t=l,i=m,f=S(),{userTokens:u}=R(f),a=G(),{chattingRef:r,chatContentList:p,isStopChat:g,isReceiving:c,initialize:h,sendMessage:_,stopStream:d,fetchChatHistory:C}=A();o(c,e=>i("update:isReceiving",e));const k=async e=>{if(u.value<=0){M.msgPowerInsufficient();return}const s=!t.taskId;await _(e,!1,()=>{s&&i("new-conversation",{task_id:a.taskId,title:e})})};return o(()=>t.taskId,async e=>{var s;a.clearChat(),a.setAgent({id:t.agentId,name:t.agentName||""}),d(),e&&(a.setTaskId(e||""),await C(),(s=r.value)==null||s.resetScroll())},{immediate:!0,deep:!0}),o(()=>t.detail,e=>{a.setAgent({id:t.agentId,name:t.agentName||""})}),b(()=>{h()}),x(()=>{a.clearChat()}),(e,s)=>{const w=v;return N(),y(w,{ref_key:"chattingRef",ref:r,"is-new-chat":!1,"is-stop":n(g),"is-disabled-humanize":!0,"content-list":n(p),"send-disabled":n(c),"is-upload-file":!1,"is-network":!1,onContentPost:k,onClose:n(d)},{content:z(()=>s[0]||(s[0]=[B("div",{class:"h-full"},null,-1)])),_:1},8,["is-stop","content-list","send-disabled","onClose"])}}});export{D as _};
