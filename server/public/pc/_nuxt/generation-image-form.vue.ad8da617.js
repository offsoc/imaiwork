import{E as oe,a as ae}from"./el-tabs.0dd2047f.js";import{E as se,a as ne}from"./index.52e544f1.js";import{d as re,at as ie,c as X,aF as pe,r as me,A as H,D as de,aV as ue,G as N,b6 as fe,k as u,l as E,m as r,q as s,s as i,J as g,K as G,Z as o,I as v,v as b,L as y,Y as ce,t as _e,bK as Ee,B as ge,aI as be,av as Ie,au as Ae,ax as xe,y as he,b5 as ve,ay as ye}from"./entry.46557796.js";import{E as Me}from"./el-switch.03413428.js";import{E as we}from"./index.304400de.js";/* empty css                  *//* empty css               *//* empty css                     */import{drawTypeEnumMap as P,DrawTypeEnum as z,ModelEnum as m}from"./index.fb0aa6a9.js";import{CopywritingTypeEnum as B}from"./chatEnum.1c450e0f.js";import{_ as Te}from"./image-upload.vue.dc909951.js";import{_ as Ge}from"./resolution-select.vue.0bd47da6.js";import Ve from"./inspiration-image.4a071c9e.js";import Ce from"./case-image-v1.1e3aa0a2.js";const Re={class:"h-full flex flex-col"},ke={class:"flex-shrink-0"},De={class:"grow min-h-0"},Se={class:"p-4"},Ue={class:"w-full"},Xe={class:"mt-3 rounded-md bg-app-bg-3 border border-app-border-2 p-[6px]"},He={class:"flex items-center gap-1 text-[11px] px-[6px]"},Ne={class:"mt-2"},Pe={class:"flex items-center justify-between gap-2"},ze={class:"flex items-center justify-between w-full border border-app-border-2 rounded-lg bg-app-bg-3 px-3 h-11"},Be={class:"flex items-center gap-2 text-white"},$e={class:"fixed right-4 top-[93px] z-[22]"},at=re({__name:"generation-image-form",emits:["update:formData","generatePrompt"],setup(Fe,{expose:$,emit:F}){const V=F;let p;(l=>{l[l.TXT2IMAGE=P[z.TXT2IMAGE]]="TXT2IMAGE",l[l.IMAGE2IMAGE=P[z.IMAGE2IMAGE]]="IMAGE2IMAGE"})(p||(p={}));const M=ie(),I=X(()=>{if(M.getHdConfig.channel.forEach(l=>l.id=parseInt(l.id)),e.type==p.IMAGE2IMAGE)return M.getHdConfig.channel.filter(l=>[m.HIDREAMAI,m.SEEDREAM].includes(l.id));if(e.type==p.TXT2IMAGE)return M.getHdConfig.channel.filter(l=>[m.HIDREAMAI,m.GENERAL,m.SEEDREAM].includes(l.id))}),e=pe({type:p.TXT2IMAGE,model:"",prompt:"",use_sr:!0,width:"",height:"",resolution:"",img_count:1,image:"",content:""}),C=X(()=>e.model==m.HIDREAMAI?1e3:2e3),L=[{label:"文生图",value:p.TXT2IMAGE},{label:"参考生图",value:p.IMAGE2IMAGE}],O=l=>{e.model=I.value[0].id},j=l=>{e.model==m.GENERAL&&(e.img_count=1)},q=l=>{e.resolution=l.label,e.width=l.width,e.height=l.height},R=[{label:"通用垫图",id:1},{label:"角色特征",id:2},{label:"人物长相",id:3},{label:"风格转绘",id:4}],K=me(R[0].id),k=H(),W=async()=>{k.value.open()},J=l=>{e.prompt=l.join(",")},D=l=>{V("generatePrompt",{promptId:l,prompt:e.prompt})},Y=l=>{e.prompt=l.slice(0,C.value)},S=H(),Z=()=>{S.value.open()},Q=l=>{e.prompt=l};return de(()=>I.value,l=>{l.length>0&&(e.model=l[0].id)},{immediate:!0}),ue(()=>{V("update:formData",e)}),$({getFormData:()=>{var h;const{model:l,type:t,resolution:c,prompt:w,img_count:A,width:x,height:d,use_sr:_,image:f}=e,n={model:l,model_name:(h=I.value.find(T=>T.id==l))==null?void 0:h.name,type:t,resolution:c,type_name:t==p.TXT2IMAGE?"文生图":"参考生图",params:{prompt:w}};return t==p.TXT2IMAGE?l==m.HIDREAMAI?(n.params.aspect_ratio=c,n.params.img_count=A):(l==m.GENERAL||l==m.SEEDREAM)&&(n.params.width=x,n.params.height=d,n.params.use_sr=`${_}`,n.params.model=l):t==p.IMAGE2IMAGE&&(n.model==m.HIDREAMAI?(n.params.image=[f],n.params.aspect_ratio=c,n.params.img_count=A,n.params.negative_prompt=""):n.model==m.SEEDREAM&&(n.params.width=x,n.params.height=d,n.params.image_url=f,n.params.model=l)),n},validateForm:()=>new Promise((l,t)=>{if(e.type==p.TXT2IMAGE&&!e.prompt){N.msgWarning("请输入提示词"),t(!1);return}if(e.type==p.IMAGE2IMAGE&&!e.image){N.msgWarning("请上传参考图"),t(!1);return}l(!0)}),setPrompt:Y}),(l,t)=>{const c=oe,w=ae,A=se,x=ne,d=Ie,_=Ae,f=xe,n=he,h=Me,T=ve,ee=ye,te=we,le=fe("number-input");return u(),E(g,null,[r("div",Re,[r("div",ke,[s(w,{modelValue:o(e).type,"onUpdate:modelValue":t[0]||(t[0]=a=>o(e).type=a),onTabClick:O},{default:i(()=>[(u(),E(g,null,G(L,(a,U)=>s(c,{name:a.value,label:a.label,key:U},null,8,["name","label"])),64))]),_:1},8,["modelValue"])]),r("div",De,[s(te,null,{default:i(()=>[r("div",Se,[s(ee,{model:o(e),"label-position":"top"},{default:i(()=>[s(d,{label:"生成模型"},{default:i(()=>[s(x,{modelValue:o(e).model,"onUpdate:modelValue":t[1]||(t[1]=a=>o(e).model=a),class:"!h-11","popper-class":"dark-select-popper",placeholder:"请选择模型名称","show-arrow":!1,onChange:j},{default:i(()=>[(u(!0),E(g,null,G(o(I),a=>(u(),v(A,{label:a.name,value:a.id,key:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(e).type===p.TXT2IMAGE?(u(),v(d,{key:0,label:"提示词"},{default:i(()=>[s(_,{modelValue:o(e).prompt,"onUpdate:modelValue":t[2]||(t[2]=a=>o(e).prompt=a),type:"textarea","show-word-limit":"",resize:"none",placeholder:"请输入提示词",autosize:{minRows:6,maxRows:15},maxlength:o(C)},null,8,["modelValue","maxlength"]),s(f,{type:"primary",class:"!rounded-full !h-[50px] w-full mt-3",disabled:!o(e).prompt,onClick:t[3]||(t[3]=a=>D(o(B).AI_TEXT_TO_IMAGE))},{default:i(()=>t[9]||(t[9]=[b(" 生成提示词 ",-1)])),_:1,__:[9]},8,["disabled"])]),_:1})):y("",!0),o(e).type===p.IMAGE2IMAGE?(u(),E(g,{key:1},[s(d,null,{default:i(()=>[r("div",Ue,[t[10]||(t[10]=r("div",{class:"flex items-center gap-2 text-[11px] text-white"},[r("div",{class:"h-[26px] rounded-md px-[11px] bg-primary flex items-center cursor-pointer"}," 单图参考 "),r("div",{class:"h-[26px] rounded-md px-[11px] bg-app-bg-3 border border-app-border-2 flex items-center cursor-not-allowed"}," 多图参考（开发中） ")],-1)),r("div",Xe,[r("div",He,[(u(),E(g,null,G(R,(a,U)=>r("div",{class:ce(["text-white px-[11px] rounded-md h-[26px] flex items-center",o(K)===a.id?"shadow-[0_0_0_1px_rgba(255,255,255,0.10)] bg-app-bg-3 cursor-pointer":"cursor-not-allowed"])},_e(a.label),3)),64))]),r("div",Ne,[s(Te,{"form-data":o(e),"onUpdate:formData":t[4]||(t[4]=a=>Ee(e)?e.value=a:null),"template-video-url":`${o(ge)()}/static/videos/reference-image-tips-char.mp4`},null,8,["form-data","template-video-url"])])])])]),_:1}),s(d,null,{label:i(()=>[r("div",Pe,[t[12]||(t[12]=r("div",null,"创意描述（选填）",-1)),s(f,{type:"primary",size:"small",onClick:W},{default:i(()=>t[11]||(t[11]=[b("灵感",-1)])),_:1,__:[11]})])]),default:i(()=>[s(_,{modelValue:o(e).prompt,"onUpdate:modelValue":t[5]||(t[5]=a=>o(e).prompt=a),type:"textarea",resize:"none",placeholder:"选填内容",rows:6},null,8,["modelValue"]),s(f,{type:"primary",class:"!rounded-full !h-[50px] w-full mt-3",disabled:!o(e).prompt,onClick:t[6]||(t[6]=a=>D(o(B).AI_IMAGE_TO_IMAGE))},{default:i(()=>t[13]||(t[13]=[b(" 生成提示词 ",-1)])),_:1,__:[13]},8,["disabled"])]),_:1})],64)):y("",!0),o(e).model==o(m).GENERAL?(u(),v(d,{key:2},{default:i(()=>[s(T,{placement:"right","popper-class":"w-[228px]",content:"开启后可将【生成规格】中的宽高均乘以2返回，如上述宽高均为512和512，此参数关闭出图 512*512 ，此参数打开出图1024 * 1024"},{default:i(()=>[r("div",ze,[r("div",Be,[t[14]||(t[14]=b(" 超分辨率生成 ",-1)),s(n,{name:"local-icon-question",size:16})]),s(h,{modelValue:o(e).use_sr,"onUpdate:modelValue":t[7]||(t[7]=a=>o(e).use_sr=a)},null,8,["modelValue"])])]),_:1})]),_:1})):y("",!0),s(d,null,{label:i(()=>t[15]||(t[15]=[r("div",{class:"flex items-center gap-2 text-white"},[r("span",null,"生成模型")],-1)])),default:i(()=>[s(Ge,{model:o(e).model,"onUpdate:resolution":q},null,8,["model"])]),_:1}),o(e).model==o(m).HIDREAMAI?(u(),v(d,{key:3,label:"生成张数"},{default:i(()=>[be(s(_,{modelValue:o(e).img_count,"onUpdate:modelValue":t[8]||(t[8]=a=>o(e).img_count=a),min:"1",max:"4",type:"number",class:"!h-11"},null,8,["modelValue"]),[[le,{decimal:0}]])]),_:1})):y("",!0)]),_:1},8,["model"])])]),_:1})])]),r("div",$e,[s(f,{type:"primary",class:"!rounded-full w-[100px] !h-10",onClick:Z},{default:i(()=>t[16]||(t[16]=[b(" 优秀案例 ",-1)])),_:1,__:[16]})]),s(Ve,{ref_key:"inspirationImageRef",ref:k,onUseAssemble:J},null,512),s(Ce,{ref_key:"caseImageRef",ref:S,type:"goods",onChoose:Q},null,512)],64)}}});export{at as _};
