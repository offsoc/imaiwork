import{d as D,z as v,r as g,G as y,aF as x,bC as C,k as h,l as R,q as d,s as X,m as b,Z as u}from"./entry.2beb4577.js";import{k as S,l as V,m as Y,n as B}from"./drawing.7058a163.js";import{drawTypeEnumMap as f,DrawTypeEnum as E,ModelEnum as c}from"./index.fb0aa6a9.js";import H from"./useCreateForm.c8aa97e1.js";import L from"./useDrawingTask.6ae92c8b.js";import N from"./result-content.b980c24a.js";import{E as U}from"./index.47b30189.js";const j={class:"h-full relative w-full"},q={class:"px-[10px]"},Q=D({__name:"index",setup(z){let t;(a=>{a[a.TXT2IMAGE=f[E.TXT2IMAGE]]="TXT2IMAGE",a[a.IMAGE2IMAGE=f[E.IMAGE2IMAGE]]="IMAGE2IMAGE"})(t||(t={}));const I=v(),{onEvent:_,setFormData:T}=H(),p=g([]),r=g(!1);_("update:formData",async a=>{if(r.value){y.msgWarning("请等待上一次任务完成");return}r.value=!0;const{type:o,type_name:M,model:n,resolution:w,model_name:k,params:l}=a,s=x({date:C().format("YYYY-MM-DD HH:mm"),prompt:l.prompt,images:[],formData:a,tags:[k,w,M]});p.value.unshift(s);try{if(n==c.HIDREAMAI){s.images=new Array(parseInt(l.img_count)).fill({url:"",loading:!0,progress:0,status:0,error:!1});const i=o==t.TXT2IMAGE?S:V,{result:e}=await i(l),{processDrawingTask:m}=L({type:o,task_id:e.task_id,dataLists:s.images});await m({callback:G=>{s.images=G}})}else if(n==c.GENERAL||n==c.SEEDREAM){s.images=[{url:"",loading:!0,progress:0,status:0,error:!1}];const i=o==t.TXT2IMAGE?Y:B,{result:e}=await i(l);s.images=[e.image_urls].map(m=>({url:m,loading:!1,progress:100,status:1,error:!1}))}I.getUser()}catch{s.images=s.images.map(e=>({...e,loading:!1,progress:0,status:4,error:!0}))}finally{r.value=!1}});const A=a=>{T(a)};return(a,o)=>(h(),R("div",j,[d(u(U),null,{default:X(()=>[b("div",q,[d(N,{"result-lists":u(p),"is-all-tasks-completed":u(r),onRetry:A},null,8,["result-lists","is-all-tasks-completed"])])]),_:1})]))}});export{Q as _};
