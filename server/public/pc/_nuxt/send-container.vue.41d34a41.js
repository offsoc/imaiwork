import{E as R}from"./index.bad4fd13.js";import{E as B}from"./el-empty.28f9091a.js";import{d as N,aF as V,r,A as z,cx as K,bT as T,bK as j,k as o,l as i,m as s,Z as n,I as _,s as q,J as C,K as G,q as l,a0 as H,L as D,G as h,aH as k,y as J,u as U}from"./entry.f4f46cb5.js";/* empty css                     */import{_ as Z}from"./7_day.257301c1.js";import{ae as O,af as Q,ag as W,ah as X}from"./person_wechat.703f63bb.js";import Y from"./material-edit.91e90493.js";import{_ as ee}from"./send-date.vue.d7c9e266.js";import{_ as te}from"./send-date-preview.vue.32003375.js";import se from"./send-container-item.74c13f58.js";const ae={class:"h-full flex flex-col gap-x-4"},oe={class:"grow min-h-0 flex"},ne={class:"flex-1 flex flex-col h-full"},re={class:"flex-shrink min-h-0"},ie={class:"px-4 flex flex-col gap-y-4"},le={key:1,class:"mt-14"},ce={class:"w-[456px] flex-shrink-0"},de={class:"h-full"},me={key:0,class:"border border-primary-light-8 rounded-xl py-4 relative px-2"},pe={key:1,class:""},be=N({__name:"send-container",props:{type:{},taskId:{},pushDay:{}},emits:["back","success"],setup(g,{expose:S,emit:P}){const E=g,c=P,F=U(),d=V({push_time_list:[]}),m=r([]),I=e=>{F.$confirm({message:"确定删除该内容吗？",onConfirm:async()=>{try{await O({content_id:e}),c("success"),h.msgSuccess("删除成功")}catch(t){h.msgError(t)}}})},p=r(!1),u=z(),M=async()=>{var e;p.value=!0,await k(),(e=u.value)==null||e.open("add")},y=async e=>{var t,f;try{const a=await Q({content_id:e});p.value=!0,await k(),(t=u.value)==null||t.open("edit"),(f=u.value)==null||f.setFormData({content_id:a.id,content:a.content,time:{order_day:a.order_day,push_time:a.push_time}})}catch(a){h.msgError(a)}},$=async e=>{try{e.content_id?await W({push_id:E.taskId,...e}):await X({push_id:E.taskId,...e}),c("success")}catch(t){h.msgError(t)}},v=r(!1);r(!1);const w=r(),A=async()=>{var e;v.value=!0,await k(),(e=w.value)==null||e.open()};K(async()=>{if(d.push_time_list.length==0){T.error("请添加内容");return}c("success"),L()});const L=()=>{c("back")};return S({setFormData:e=>j(e,d),setDateList:e=>{m.value=e}}),(e,t)=>{const f=R,a=B,b=J;return o(),i(C,null,[s("div",ae,[s("div",oe,[s("div",ne,[s("div",re,[n(d).push_time_list.length?(o(),_(f,{key:0},{default:q(()=>[s("div",ie,[(o(!0),i(C,null,G(n(d).push_time_list,(x,ue)=>(o(),_(se,{item:x,onDelete:I,onEdit:y},null,8,["item"]))),256))])]),_:1})):(o(),i("div",le,[l(a,{description:"请添加内容"})]))]),s("div",{class:"m-4 p-2 bg-primary-light-9 rounded-xl flex items-center justify-center cursor-pointer gap-x-2",onClick:H(M,["stop"])},[l(b,{name:"local-icon-add_box_fill",color:"var(--color-primary)",size:20}),t[2]||(t[2]=s("span",{class:"text-primary font-bold"}," 添加内容 ",-1))])]),s("div",ce,[t[3]||(t[3]=s("div",{class:"flex items-center gap-2 mb-4"},[s("img",{src:Z,class:"w-6 h-6"}),s("span",null,"推送日期预览")],-1)),s("div",de,[n(m).length?(o(),i("div",me,[l(ee,{"date-list":n(m),onEdit:y},null,8,["date-list"]),s("div",{class:"absolute top-1 right-1 z-40 p-1 hover:bg-primary-light-8 rounded-md cursor-pointer",onClick:A},[l(b,{name:"local-icon-fullscreen",color:"var(--color-primary)"})])])):(o(),i("div",pe,[l(a,{description:"请添加内容"})]))])])])]),n(v)?(o(),_(te,{key:0,ref_key:"sendDatePreviewRef",ref:w,"date-list":n(m),onClose:t[0]||(t[0]=x=>v.value=!1),onEdit:y},null,8,["date-list"])):D("",!0),n(p)?(o(),_(Y,{key:1,ref_key:"materialEditRef",ref:u,"push-day":g.pushDay,onSuccess:$,onClose:t[1]||(t[1]=x=>p.value=!1)},null,8,["push-day"])):D("",!0)],64)}}});export{be as _};
