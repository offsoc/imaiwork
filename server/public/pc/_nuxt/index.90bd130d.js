import{d as Be,at as Ie,c as b,A as x,aF as te,bC as je,r as p,k as r,l as c,m as s,q as i,s as u,Z as l,v as D,aI as ze,J as B,K as se,Y as I,L as f,t as C,a0 as Me,au as le,I as y,bM as Re,a3 as Ue,aH as k,bK as ae,G as ie,dy as Se,y as $e,ax as Pe,ba as Le,cW as Oe,_ as Fe}from"./entry.ee599c70.js";import{E as He,a as Ge}from"./el-tabs.68bb8047.js";import{E as Ye}from"./index.e69b4eeb.js";import{E as Je}from"./el-switch.7d8162d3.js";import{a as Xe,E as We}from"./index.8fd3c68c.js";import{E as Ke}from"./index.f36399ff.js";import{_ as qe}from"./index.vue.d98c851e.js";import{_ as Ze}from"./index.vue.6e4dda8f.js";/* empty css                     *//* empty css                  *//* empty css               *//* empty css                   */import{u as Qe}from"./usePaging.5914886e.js";import{u as eo}from"./useTemplate.afda57ca.js";import{e as oo}from"./digital_human.b276942f.js";import{A as to,a as so}from"./choose-audio.c33960ba.js";import{CreateTypeEnum as v,DigitalHumanModelVersionEnum as m,ModeTypeEnum as j}from"./index.728f9c9c.js";import{ClipStyleEnum as lo}from"./indexEnum.66dc19ba.js";import{CopywritingTypeEnum as ao}from"./chatEnum.1c450e0f.js";import io from"./generate-prompt.bff635d0.js";import{_ as no}from"./index.c972ba3d.js";import ro from"./choose-tone.12399413.js";import co from"./upload-form.878c9477.js";import{_ as fo}from"./create-panel.vue.3dc5d237.js";import uo from"./choose-anchor.d70e6045.js";import"./raf.09011a0b.js";import"./strings.32bdf471.js";import"./clamp.05cad4d6.js";import"./toNumber.0872a42f.js";import"./index.6ab00366.js";import"./index.684b3e96.js";import"./_baseIteratee.6942dcd2.js";import"./index.0e845cb8.js";import"./el-empty.76498597.js";import"./index.vue.33025166.js";import"./useAudio.5d8f0f69.js";import"./redbook.418b34fe.js";import"./index.db2ee73f.js";import"./el-segmented.facbb135.js";import"./index.c8874308.js";import"./index.6fe7ec27.js";import"./cloneDeep.d0528121.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./index.ef8eb140.js";import"./debounce.f4735d5c.js";/* empty css                        *//* empty css                 */import"./cloneDeep.cbdff7c9.js";import"./index.a571e11a.js";import"./video-item.02d77f77.js";import"./index.vue.79d745ab.js";import"./index.364e6819.js";import"./throttle.108b0b49.js";const mo=""+new URL("linshi.51f4e6ed.png",import.meta.url).href,po={class:"flex gap-x-4 h-full create-container"},_o={class:"w-12 h-12 rounded-xl flex items-center justify-center border border-dashed border-[#ffffff1a] hover:border-[#ffffff33] cursor-pointer"},vo={class:"flex-1 flex gap-4 flex-col overflow-hidden"},ho={class:"grow min-h-0 w-full flex flex-col bg-app-bg-2 rounded-xl overflow-hidden"},xo={key:0,class:"upload-container"},go={key:1,class:"w-full h-full relative flex overflow-hidden"},bo=["src"],yo={class:"h-[252px] bg-app-bg-2 flex flex-col rounded-lg flex-shrink-0 anchor-box"},wo={class:"relative"},Co={class:"flex items-center gap-2 absolute right-2 top-[10px]"},ko={class:"grow min-h-0 flex px-5 gap-[14px]"},Vo={class:"mt-5"},Eo={class:"flex gap-[14px] py-6 px-4"},No=["onClick"],Ao=["src"],To={key:0,class:"absolute top-0 left-0 w-full h-full flex items-center justify-center z-[88]"},Do={key:1,class:"absolute left-0 bottom-2 w-full flex justify-center"},Bo={key:0,class:"absolute top-2 right-2 z-[888] p-1 leading-[0] rounded-md"},Io=["onClick"],jo={key:3,class:"absolute top-0 left-0 w-full h-full bg-[#0000005E] z-[888]"},zo={class:"flex flex-col items-center justify-center w-full h-full gap-[2px]"},Mo={class:"w-6 h-6 rounded-full bg-primary flex items-center justify-center"},Ro={class:"create-card"},Uo={class:"px-4 py-[1px] bg-app-bg-1 rounded-md flex items-center gap-x-3 border border-[var(--app-border-color-1)]"},So={class:"flex-1 flex items-center"},$o={class:"grow min-h-0 bg-[#1A1A1A] rounded-lg flex flex-col"},Po={class:"create-tabs"},Lo={class:"grow min-h-0 mt-4"},Oo={key:0,class:"rounded-md border border-app-border-1"},Fo={class:"h-11 flex items-center gap-x-3 px-3 border-0 border-b-[1px] border-[var(--app-border-color-1)]"},Ho={class:"w-5 h-5 flex items-center justify-center rounded bg-[#ffffff0d]"},Go={class:"px-4"},Yo={class:"absolute top-2 right-2"},Jo={key:0,class:"absolute left-0 bottom-4 w-full flex justify-center"},Xo={class:"absolute left-0 bottom-0 w-full h-full flex items-center justify-center invisible group-hover:visible bg-[#000000cc]"},Wo={key:1,class:"flex flex-col items-center justify-center pt-[50px]"},Ko={class:"flex items-center gap-x-1 rounded-full bg-[#ffffff08] p-1 mt-5"},qo={class:"flex items-center justify-between mt-2"},Zo={class:"text-[#ffffff4d] text-xs"},Qo={class:"my-3"},et={key:1,class:"rounded-md border border-app-border-1"},ot={class:"h-11 flex items-center gap-x-3 px-3 border-0 border-b-[1px] border-app-border-1"},tt={class:"w-5 h-5 flex items-center justify-center rounded bg-[#ffffff0d]"},st={class:"p-2"},lt={class:"w-full h-[246px] flex flex-col items-center justify-center cursor-pointer"},at={key:2,class:"rounded-md border border-app-border-1 mt-4"},it={class:"h-11 flex items-center gap-x-3 px-3 border-0 border-b-[1px] border-app-border-1"},nt={class:"w-5 h-5 flex items-center justify-center rounded bg-[#ffffff0d]"},rt={class:"p-4"},ct={class:"flex justify-between items-center"};const dt={class:"mt-4"},ft=Be({__name:"index",setup(ut){const ne=Ie(),re=b(()=>{var o;return((o=ne.getDigitalHumanConfig)==null?void 0:o.channel)||{}}),V=b(()=>re.value.reduce((o,e)=>(o[e.id]=e.name,o),{})),ce=x(),t=te({url:"",name:je().format("YYYYMMDDHHmmss").substring(2),anchor_name:"",anchor_id:"",pic:"",model_version:"",audio_type:v.TEXT,audio_src:"",voice_id:"",voice_url:"",voice_name:"",msg:"",audio_duration:0,audio_url:"",voice_type:1,music_url:"",music_name:"",music_type:1,clip_type:`${lo.AI_RECOMMEND}`,automatic_clip:0}),H=x(),G=()=>{var o;t.pic="",t.url="",t.model_version="",t.anchor_name="",t.anchor_id="",t.audio_url="",t.audio_duration=0,h.value=-1,(o=H.value)==null||o.clearFile()},z=p(!1),M=x(),Y=async o=>{var e,n;z.value=!0,await k(),(e=M.value)==null||e.open(),(n=M.value)==null||n.setUrl(o)},J=async o=>{var e;L.value=!0,await k(),(e=q.value)==null||e.open(o)},h=p(-1),{pager:_,getLists:de,resetPage:X}=Qe({fetchFun:oo,params:{type:0,status:"0,1",model_version:m.CHANJING}}),R=b(()=>{const o=_.lists[h.value]||{};return{...o,name:t.name,anchor_name:o.anchor_id?o.name:o.anchor_name}}),fe=async()=>{await X(),_.lists.unshift(...S.value)},E=p(!1),U=x(),ue=async()=>{var o,e;E.value=!0,await k(),(o=U.value)==null||o.open(),R.value&&((e=U.value)==null||e.setChooseAnchor(R.value))},me=o=>{E.value=!1,W(o)},W=(o,e)=>{h.value=e??_.lists.findIndex(d=>d.anchor_id==o.anchor_id),t.model_version!=o.model_version&&(Object.assign(t,{msg:"",audio_url:"",audio_duration:0}),t.voice_type==1&&t.voice_id!=-1&&Object.assign(t,{voice_id:"",voice_name:""}));const n={url:o.url,pic:o.pic,model_version:o.model_version,anchor_id:o.anchor_id,anchor_name:o.anchor_name,width:o.width,height:o.height};Object.assign(t,n)},S=p([]),pe=async o=>{const{modelType:e}=o;if(e===j.VIDEO){const n={...o.formData,is_vanish:!0};S.value.unshift(n),_.lists.unshift(n),h.value=0,ae(n,t)}else e===j.FIGURE&&(await X(),_.lists.unshift(...S.value),h.value=0,ae(_.lists[0],t))},$=x(),P=p(!1),_e=b(()=>t.model_version==m.CHANJING),ve=async()=>{var o,e;if(!t.model_version){ie.msgWarning("请先选择形象~");return}P.value=!0,await k(),(o=$.value)==null||o.open(t.model_version),t.voice_id&&((e=$.value)==null||e.setChooseTone({type:t.voice_type,voice_id:t.voice_id}))},he=o=>{const{builtin:e,voice_id:n,name:d}=o;t.voice_name=d,t.voice_id=n,t.voice_type=e},K=x(),N=p(!1),mt=async()=>{var o;N.value=!0,await k(),(o=K.value)==null||o.open()},xe=o=>{N.value=!1,t.music_url=o.url,t.music_name=o.name},pt=o=>{const{uri:e,name:n}=o.data;t.music_name=n,t.music_url=e,so({url:e,name:n,type:"0"})},_t=()=>{t.music_name="",t.music_url=""},q=x(),L=p(!1),g=b(()=>({[m.STANDARD]:150,[m.SUPER]:300,[m.ADVANCED]:1e3,[m.ELITE]:1e3,[m.CHANJING]:4e3})[t.model_version]||150),O=b(()=>{const o={[m.STANDARD]:{min:5,max:100,size:100},[m.SUPER]:{min:2,max:120,size:30},[m.ADVANCED]:{min:5,max:600,size:100},[m.ELITE]:{min:5,max:600,size:100},[m.CHANJING]:{min:30,max:600,size:100}};return t.model_version?o[t.model_version]:{}}),w=p(v.TEXT),ge=p([{label:"文字驱动",value:v.TEXT,icon:"txt"},{label:"语音驱动",value:v.AUDIO,icon:"mic"}]),be=o=>{t.voice_id="",t.audio_type=o.index==="0"?v.TEXT:v.AUDIO,o.index===0?(t.audio_url="",t.audio_duration=0):(t.voice_url="",t.voice_name="",t.msg="")},ye=o=>{const{response:{data:{uri:e}},raw:n}=o,d=new Audio(URL.createObjectURL(n));d.addEventListener("loadedmetadata",()=>{t.audio_duration=Math.floor(d.duration)}),t.audio_url=e},we=o=>{o.length>g.value?(ie.msgWarning(`内容过长，将截取前${g.value}字符`),t.msg=o.substring(0,g.value)):t.msg=o},Ce=()=>{G(),setTimeout(()=>{window.location.reload()},2e3)},ke=o=>{var n;const{type:e}=o;switch(e){case"name":(n=ce.value)==null||n.focus();break}},Z=te({is_open:!1}),Ve=async()=>{const{code:o}=await Se();Z.is_open=o==1e4},{DefineTemplate:Ee,UseTemplate:F}=eo();return de(),Ve(),(o,e)=>{const n=$e,d=Pe,A=He,Q=Ge,ee=Le,oe=Ye,Ne=Je,vt=We,ht=Xe,xt=Ke,gt=qe,Ae=Ze,Te=Oe;return r(),c(B,null,[s("div",po,[i(l(Ee),null,{default:u(()=>[s("div",_o,[i(n,{name:"el-icon-Plus",color:"#ffffff"})])]),_:1}),s("div",vo,[s("div",ho,[l(t).url?(r(),c("div",go,[s("video",{src:l(t).url,class:"w-full h-full object-contain",controls:""},null,8,bo)])):(r(),c("div",xo,[e[15]||(e[15]=s("div",{class:"upload-title"},"领先的定制数字人形象",-1)),e[16]||(e[16]=s("div",{class:"text-xs text-white mt-[10px]"},"开始创作，打造你的专属数字人分身",-1)),i(d,{type:"primary",class:"mt-5 !h-[50px] !w-[208px] !rounded-full",onClick:e[0]||(e[0]=a=>J(l(j).VIDEO))},{default:u(()=>[...e[14]||(e[14]=[D(" 定制形象 ",-1)])]),_:1})]))]),s("div",yo,[s("div",wo,[i(Q,{"model-value":"clone",class:"w-full"},{default:u(()=>[i(A,{name:"clone",label:"克隆数字人"}),i(A,{name:"image",label:"图片数字人（内测中）",disabled:""})]),_:1}),s("div",Co,[i(ee,{content:"刷新"},{default:u(()=>[i(d,{icon:"el-icon-Refresh",circle:"",onClick:fe,color:"#1f1f1f"})]),_:1})])]),s("div",ko,[s("div",{class:"w-[116px] h-[154px] flex flex-col gap-4 items-center justify-evenly flex-shrink-0 my-6 border border-[#ffffff1a] rounded-xl cursor-pointer hover:border-[#ffffff33]",onClick:e[1]||(e[1]=a=>J(l(j).FIGURE))},[s("div",Vo,[i(l(F))]),e[17]||(e[17]=s("div",{class:"w-[68px] h-[24px] flex items-center justify-center rounded-full border border-[#ffffff1a] text-white text-[11px]"}," 形象克隆 ",-1))]),i(oe,{always:""},{default:u(()=>[ze((r(),c("div",Eo,[(r(!0),c(B,null,se(l(_).lists,(a,T)=>(r(),c("div",{class:I(["anchor-item card-gradient group bg-black flex-shrink-0",{"!border-primary":l(h)===T}]),key:a.id},[i(ee,{content:a.name||a.anchor_name,placement:"right",class:"w-full h-full"},{default:u(()=>[s("div",{class:"w-full h-full",onClick:De=>W(a,T)},[s("div",{class:I(["absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center",{"blur-sm filter":a.is_vanish}])},[s("img",{src:a.pic,class:"w-full mx-auto h-full object-cover"},null,8,Ao)],2),a.is_vanish?(r(),c("div",To,[...e[18]||(e[18]=[s("img",{src:mo,class:"w-[50%]"},null,-1)])])):f("",!0),l(V)[a.model_version]?(r(),c("div",Do,[s("div",{class:I(["text-[10px] digital-human-tag",`digital-human-tag-${a.model_version}`])},C(l(V)[a.model_version]),3)])):f("",!0),a.status==1||a.is_vanish?(r(),c(B,{key:2},[l(h)==T?(r(),c("div",Bo,[i(n,{name:"local-icon-success_fill",color:"var(--color-primary)",size:20})])):f("",!0),s("div",{class:"w-4 h-4 flex items-center justify-center invisible group-hover:visible absolute right-1 bottom-2 z-[888] p-[2px] leading-[0] rounded-full bg-[#ffffff33]",style:{"backdrop-filter":"blur(5px)"},onClick:Me(De=>Y(a.url),["stop"])},[i(n,{name:"local-icon-play2",size:14})],8,Io)],64)):(r(),c("div",jo,[s("div",zo,[s("span",Mo,[i(n,{name:"local-icon-pic2",size:14})]),e[19]||(e[19]=s("span",{class:"text-white font-bold mt-1 text-xs"},"正在生成中",-1)),e[20]||(e[20]=s("span",{class:"text-[#ffffff80] text-[11px]"},"大约等待几分钟",-1))])]))],8,No)]),_:2},1032,["content"])],2))),128))])),[[Te,l(_).loading]])]),_:1})])])]),s("div",Ro,[s("div",Uo,[e[21]||(e[21]=s("div",{class:"text-[#ffffff80]"},"视频名称",-1)),e[22]||(e[22]=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"2",height:"12",viewBox:"0 0 2 12",fill:"none"},[s("path",{opacity:"0.1",d:"M1 0V12",stroke:"white"})],-1)),s("div",So,[i(l(le),{modelValue:l(t).name,"onUpdate:modelValue":e[2]||(e[2]=a=>l(t).name=a),placeholder:"请输入数字人名称",class:"name-input",maxlength:"10","auto-focus":"",focus:"","input-style":"text-align:right;color:#ffffff"},null,8,["modelValue"]),i(n,{name:"local-icon-edit",size:14})])]),s("div",$o,[s("div",Po,[i(Q,{modelValue:l(w),"onUpdate:modelValue":e[3]||(e[3]=a=>Re(w)?w.value=a:null),onTabClick:be},{default:u(()=>[(r(!0),c(B,null,se(l(ge),a=>(r(),y(A,{name:a.value,label:a.label},null,8,["name","label"]))),256))]),_:1},8,["modelValue"])]),s("div",Lo,[i(oe,null,{default:u(()=>[l(w)==l(v).TEXT?(r(),c("div",Oo,[s("div",Fo,[s("div",Ho,[i(n,{name:"local-icon-txt2",size:14})]),e[23]||(e[23]=s("div",{class:"text-[#ffffffcc]"},"文字设置",-1))]),s("div",Go,[l(t).model_version?(r(),c("div",{key:0,class:"w-[116px] h-[154px] rounded-xl bg-cover bg-no-repeat mt-4 relative shadow-[0_0_0_1px_var(--color-primary)] cursor-pointer overflow-hidden group hover:shadow-[0_0_0_1px_rgba(255,255,255,0.2)]",style:Ue({backgroundImage:`url(${l(t).pic})`})},[s("div",Yo,[i(n,{name:"local-icon-success_fill",size:20,color:"var(--color-primary)"})]),l(V)[l(t).model_version]?(r(),c("div",Jo,[s("div",{class:I(["digital-human-tag",`digital-human-tag-${l(t).model_version}`])},C(l(V)[l(t).model_version]),3)])):f("",!0),s("div",Xo,[i(d,{color:"#FF3C26",class:"!h-[26px]",round:"",onClick:G},{default:u(()=>[...e[24]||(e[24]=[D("删除",-1)])]),_:1})])],4)):(r(),c("div",Wo,[i(l(F)),i(d,{type:"primary",class:"mt-3 !h-[28px] !w-[68px] !text-[11px]",onClick:ue},{default:u(()=>[...e[25]||(e[25]=[D(" 选择形象 ",-1)])]),_:1}),s("div",Ko,[i(n,{name:"local-icon-tips",size:16}),e[26]||(e[26]=s("div",{class:"text-[#ffffff4d] text-xs"}," 注意：重新选择形象，文案会重置与输入。 ",-1))])])),e[27]||(e[27]=s("svg",{class:"my-3",xmlns:"http://www.w3.org/2000/svg",width:"266",height:"2",viewBox:"0 0 266 2",fill:"none"},[s("path",{opacity:"0.1",d:"M0 1H266",stroke:"white","stroke-width":"0.5"})],-1)),s("div",null,[i(l(le),{class:"msg-input",modelValue:l(t).msg,"onUpdate:modelValue":e[4]||(e[4]=a=>l(t).msg=a),type:"textarea",placeholder:"请输入您的配音文案内容",resize:"none","input-style":"color:#ffffff;font-size:12px;",maxlength:l(g),rows:8},null,8,["modelValue","maxlength"]),s("div",qo,[s("div",null,[i(io,{"prompt-type":l(ao).AI_DIGITAL_HUMAN_COPYWRITING,"max-size":l(g),disabled:!l(t).model_version,onUseContent:we},null,8,["prompt-type","max-size","disabled"])]),s("div",Zo,C(l(t).msg.length)+"/"+C(l(g)),1)])]),s("div",Qo,[i(d,{class:"w-full !h-[44px] !rounded-md",color:"#262626",onClick:ve},{default:u(()=>[D(C(l(t).voice_name||"从音色库选择"),1)]),_:1})])])])):f("",!0),l(w)==l(v).AUDIO?(r(),c("div",et,[s("div",ot,[s("div",tt,[i(n,{name:"local-icon-audio",size:14})]),e[28]||(e[28]=s("div",{class:"text-[#ffffffcc]"},"语音设置",-1))]),s("div",st,[i(no,{ref_key:"audioUploadRef",ref:H,type:"audio",drag:"","list-type":"text",multiple:!1,limit:1,"max-size":l(O).size,"min-duration":l(O).min,"max-duration":l(O).max,onRemove:e[5]||(e[5]=a=>l(t).audio_url=""),onChange:ye},{default:u(()=>[s("div",lt,[i(l(F)),e[29]||(e[29]=s("div",{class:"mt-4 text-center"},[s("div",{class:"text-xs text-white"},"点击此上传音频,支持拖拽上传"),s("div",{class:"text-[#ffffff4d] text-xs mt-1"},"只支持mp3、wav格式")],-1))])]),_:1},8,["max-size","min-duration","max-duration"])])])):f("",!0),l(Z).is_open?(r(),c("div",at,[s("div",it,[s("div",nt,[i(n,{name:"local-icon-audio",size:14})]),e[30]||(e[30]=s("div",{class:"text-[#ffffffcc]"},"高级设置",-1))]),s("div",rt,[s("div",ct,[e[31]||(e[31]=s("div",{class:"text-xs text-white"},"AI智能剪辑",-1)),i(Ne,{modelValue:l(t).automatic_clip,"onUpdate:modelValue":e[6]||(e[6]=a=>l(t).automatic_clip=a),style:{"--el-switch-off-color":"#333333"},"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),(l(t).automatic_clip==1,f("",!0))])])):f("",!0)]),_:1})]),s("div",dt,[i(fo,{"form-data":{...l(t),...l(R)},onSuccess:Ce,onError:ke},null,8,["form-data"])])])])]),l(L)?(r(),y(co,{key:0,ref_key:"uploadFormRef",ref:q,onCreate:pe,onClose:e[9]||(e[9]=a=>L.value=!1),onPlayVideo:Y},null,512)):f("",!0),l(z)?(r(),y(Ae,{key:1,ref_key:"videoPreviewPlayerRef",ref:M,onClose:e[10]||(e[10]=a=>z.value=!1)},null,512)):f("",!0),l(E)?(r(),y(uo,{key:2,ref_key:"chooseAnchorRef",ref:U,onClose:e[11]||(e[11]=a=>E.value=!1),onConfirm:me},null,512)):f("",!0),l(P)?(r(),y(ro,{key:3,ref_key:"chooseToneRef",ref:$,is_show_original:l(_e),onClose:e[12]||(e[12]=a=>P.value=!1),onConfirm:he},null,8,["is_show_original"])):f("",!0),l(N)?(r(),y(to,{key:4,ref_key:"chooseMusicRef",ref:K,onClose:e[13]||(e[13]=a=>N.value=!1),onConfirm:xe},null,512)):f("",!0)],64)}}});const ys=Fe(ft,[["__scopeId","data-v-e4401480"]]);export{ys as default};
