import{r as i,aF as G,G as e,cy as v,u as w}from"./entry.ca4d3d61.js";import{u as E}from"./usePaging.15b2220c.js";import{m as M,n as A,o as D,p as S,q as _,r as I,v as L,w as C,x as P}from"./person_wechat.703f63bb.js";import{MaterialTypeEnum as x}from"./index.cf59f1a8.js";const d=w(),l=i(x.IMAGE),s=i(),o=i([]);function N(){const n=async()=>{const r=await M({page_type:0,file_type:l.value});o.value=r.lists,o.value.length>0&&!s.value&&(s.value=o.value[0].id)};return{currentCate:l,currentGroupId:s,cateLists:o,getCateLists:n,handleAddGroup:async r=>{try{await A({group_name:r}),e.msgSuccess("添加成功"),n()}catch(a){e.msgError(a)}},handleEditGroup:async(r,a)=>{try{await D({id:a,group_name:r}),e.msgSuccess("编辑成功")}catch(t){e.msgError(t)}},handleDeleteGroup:async r=>new Promise(async(a,t)=>{await d.$confirm({message:"确定要删除？",onConfirm:async()=>{try{await S({id:r}),e.msgSuccess("删除成功"),r==s.value&&(s.value=o.value[0].id),n(),a(!0)}catch(u){e.msgError(u),t(!1)}}})}),handleGroupSelect:r=>{s.value=r.id}}}const m=G({file_name:"",file_type:l.value,group_id:s.value}),{pager:F,getLists:c,resetPage:q}=E({fetchFun:_,params:m,firstLoading:!0});function T(){const n=i([]);return{currentCate:l,queryParams:m,pager:F,selectItem:n,getLists:c,resetPage:q,handleAddMaterial:async a=>{try{await I({file_type:l.value,...a}),c(),e.msgSuccess("添加成功")}catch(t){e.msgError(t)}},handleDeleteMaterial:async a=>new Promise(async(t,u)=>{d.$confirm({message:"确定要删除？",onConfirm:async()=>{try{await L({ids:a}),e.msgSuccess("删除成功"),c(),t(!0)}catch(y){e.msgError(y),u(!1)}}})}),handleEditMaterial:async a=>{try{await C(a),c(),e.msgSuccess("编辑成功")}catch(t){e.msgError(t)}},handleGetMaterialInfo:async a=>{await P({id:a})},handleDownload:a=>{v(a)}}}export{N as useCate,T as useFile};
