import{d as J,r as I,D as pe,k as n,l as f,q as t,s as r,m as a,a0 as K,H as fe,I as v,Z as s,bM as L,J as W,K as Y,v as O,au as Q,ax as X,c as F,aF as _e,$ as me,aI as ve,Y as T,L as E,t as H,dm as q,aH as Z,y as ye,ba as he,cW as ke,_ as ge}from"./entry.ca4d3d61.js";import{E as xe,a as Ce}from"./index.5f182cdf.js";import{E as Ee}from"./index.655612b0.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                   */import{E as Ie}from"./index.8b07fb5c.js";import{E as be}from"./el-empty.355e6a02.js";import{_ as we}from"./index.vue.441733b3.js";import{MaterialTypeEnum as i}from"./index.cf59f1a8.js";import{useCate as Me,useFile as Ve}from"./useMaterial.92beec54.js";import $e from"./upload.7e91fce6.js";import{_ as ze}from"./preview.vue.9f06463d.js";import{_ as Ne}from"./mini-program-card.vue.dad06a0b.js";import{_ as De}from"./link-card.vue.01b5a6a6.js";import{_ as Se}from"./file-card.vue.913fb3fb.js";import"./index.ab577458.js";import"./strings.5c02160d.js";import"./_baseIteratee.37ea2cef.js";import"./toNumber.33289b44.js";import"./clamp.ba5ce84b.js";import"./index.d577d4c6.js";import"./usePaging.15b2220c.js";import"./person_wechat.703f63bb.js";import"./index.28cc44d7.js";import"./index.803eaa3c.js";import"./index.62355f5a.js";import"./cloneDeep.d975dd37.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./el-image-viewer.c57baf7b.js";import"./throttle.da389ed1.js";import"./debounce.bdbfd9e6.js";import"./index.vue.fa049f69.js";const Le={class:"popover-input__input mr-[10px] flex-1"},Oe={class:"popover-input__btns flex-none"},Re=J({__name:"index",props:{value:{type:String},type:{type:String,default:"text"},width:{type:[Number,String],default:"300px"},placeholder:String,disabled:{type:Boolean,default:!1},options:{type:Array,default:()=>[]},size:{type:String,default:"default"},limit:{type:Number,default:200},showLimit:{type:Boolean,default:!1},teleported:{type:Boolean,default:!0}},emits:["confirm"],setup(p,{emit:R}){const b=p,A=R,y=I(!1),V=I(!1),u=I(),$=()=>{_(),A("confirm",u.value)},x=()=>{b.disabled||(y.value=!0,u.value=b.value)},_=()=>{y.value=!1};return pe(()=>b.value,C=>{u.value=C},{immediate:!0}),(C,d)=>{const B=xe,w=Ce,G=Q,z=X,P=Ee;return n(),f("div",{onMouseenter:d[3]||(d[3]=c=>V.value=!0),onMouseleave:d[4]||(d[4]=c=>V.value=!1)},[t(P,{placement:"top",visible:s(y),"onUpdate:visible":d[2]||(d[2]=c=>L(y)?y.value=c:null),width:p.width,trigger:"contextmenu",class:"popover-input",teleported:p.teleported,persistent:!1,"popper-class":"!p-0"},{reference:r(()=>[a("div",{class:"inline",onClick:K(x,["stop"])},[fe(C.$slots,"default")])]),default:r(()=>[a("div",{class:"flex p-3",onClick:K(c=>123,["stop"])},[a("div",Le,[p.type=="select"?(n(),v(w,{key:0,class:"flex-1",size:p.size,modelValue:s(u),"onUpdate:modelValue":d[0]||(d[0]=c=>L(u)?u.value=c:null),teleported:p.teleported},{default:r(()=>[(n(!0),f(W,null,Y(p.options,c=>(n(),v(B,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["size","modelValue","teleported"])):(n(),v(G,{key:1,modelValue:s(u),"onUpdate:modelValue":d[1]||(d[1]=c=>L(u)?u.value=c:null),modelModifiers:{trim:!0},maxlength:p.limit,"show-word-limit":p.showLimit,type:p.type,size:p.size,clearable:"",placeholder:p.placeholder},null,8,["modelValue","maxlength","show-word-limit","type","size","placeholder"]))]),a("div",Oe,[t(z,{link:"",onClick:_},{default:r(()=>[...d[5]||(d[5]=[O("取消",-1)])]),_:1}),t(z,{type:"primary",size:p.size,onClick:$},{default:r(()=>[...d[6]||(d[6]=[O("确定",-1)])]),_:1},8,["size"])])])]),_:3},8,["visible","width","teleported"])],32)}}}),Ae={class:"flex flex-col w-full h-full"},Be={class:"flex-shrink-0 flex items-center justify-between p-4"},Ge={class:"flex items-center gap-x-2"},Pe={class:"grow min-h-0"},Ue={class:"grow min-h-0 overflow-hidden relative group"},je=["onClick"],Ke=["src"],Fe=["src"],Te={key:1,class:"m-2 h-full"},He={key:2,class:"h-full m-2"},qe={key:3,class:"h-full m-2"},Ze={class:"absolute inset-0 invisible group-hover:visible z-10 flex items-center justify-center gap-2 bg-[var(--el-overlay-color-lighter)]"},Je=["onClick"],We=["onClick"],Ye=["onClick"],Qe=["onClick"],Xe={class:"flex-shrink-0 gap-x-1 flex items-center justify-between p-2"},el={class:"line-clamp-1"},ll={key:1,class:"text-xs"},tl={class:"flex items-center"},ol=["onClick"],nl={key:1,class:"flex justify-center items-center h-full"},il={class:"p-4 flex justify-end"},sl=J({__name:"container",props:{mode:{default:"popup"},limit:{default:9}},emits:["update:select"],setup(p,{emit:R}){const b=p,A=R,{getCateLists:y}=Me(),{currentCate:V,pager:u,queryParams:$,selectItem:x,getLists:_,handleDeleteMaterial:C,handleEditMaterial:d,handleDownload:B}=Ve(),w=l=>[i.IMAGE,i.VIDEO].includes(l),G=l=>[i.LINK,i.MINI_PROGRAM].includes(l),z=F(()=>{const l=V.value;return[i.IMAGE,i.VIDEO].includes(l)?"grid-cols-3 xl:grid-cols-4":[i.LINK,i.MINI_PROGRAM,i.FILE].includes(l)?"grid-cols-3":""}),P=l=>{switch(l){case i.IMAGE:case i.VIDEO:return"h-[225px]";case i.MINI_PROGRAM:return"h-[250px]";case i.LINK:return"h-[170px]";case i.FILE:return"h-[120px]";default:return"h-[225px]"}},c=F(()=>x.value.map(l=>l.id)),U=l=>{const o=c.value.indexOf(l.id);b.limit!=1?o>-1?x.value.splice(o,1):x.value.push(l):x.value=o>-1?[]:[l],A("update:select",x.value)},N=I(!1),D=_e({url:"",type:i.IMAGE}),j=(l,o)=>{D.url=l,D.type=o,N.value=!0},S=I(),M=I(!1),ee=async()=>{var l;M.value=!0,await Z(),(l=S.value)==null||l.open()},le=async l=>{var h,m;M.value=!0,await Z(),(h=S.value)==null||h.open();const o={id:l.id,group_ids:l.group_ids};l.file_type===i.LINK?Object.assign(o,{link:l.ext_info.link,link_title:l.file_name,link_desc:l.ext_info.link_desc,pic:l.file_url}):l.file_type===i.MINI_PROGRAM&&Object.assign(o,{mini_program_name:l.file_name,mini_program_appid:l.ext_info.mini_program_appid,mini_program_path:l.ext_info.mini_program_path,pic:l.file_url}),(m=S.value)==null||m.setFormData(o)},te=(l,o)=>{d({id:l.id,file_name:o,ext_info:l.ext_info,file_type:l.file_type,group_ids:l.group_ids,file_url:l.file_url})},oe=()=>{M.value=!1,_(),y()},ne=async l=>{await C([l]),y()},ie=async()=>{await C(c.value),y()};return _(),(l,o)=>{const h=X,m=ye,se=Q,k=he,ae=Re,re=Ie,ce=be,ue=we,de=ke;return n(),f("div",Ae,[a("div",Be,[a("div",null,[t(h,{type:"primary",onClick:ee},{default:r(()=>[...o[5]||(o[5]=[O("添加素材",-1)])]),_:1}),t(h,{disabled:c.value.length===0,onClick:ie},{default:r(()=>[...o[6]||(o[6]=[O("批量删除",-1)])]),_:1},8,["disabled"])]),a("div",Ge,[t(se,{modelValue:s($).file_name,"onUpdate:modelValue":o[0]||(o[0]=e=>s($).file_name=e),class:"h-[34px]",placeholder:"请输入素材名称",clearable:"",onClear:s(_),onKeyup:me(s(_),["enter"])},{append:r(()=>[t(h,{onClick:s(_)},{default:r(()=>[t(m,{name:"el-icon-Search"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","onClear","onKeyup"]),t(h,{onClick:s(_)},{default:r(()=>[t(m,{name:"el-icon-Refresh"})]),_:1},8,["onClick"])])]),ve((n(),f("div",Pe,[s(u).lists.length?(n(),v(re,{key:0},{default:r(()=>[a("div",{class:T(["grid gap-4 px-4",z.value])},[(n(!0),f(W,null,Y(s(u).lists,e=>(n(),f("div",{key:e.id,class:"relative"},[a("div",{class:T(["flex flex-col bg-primary-light-9 rounded-xl overflow-hidden",P(e.file_type)])},[a("div",Ue,[w(e.file_type)?(n(),f("div",{key:0,class:"h-full hover:scale-105 transition-all duration-300 cursor-pointer",onClick:g=>j(e.file_url,e.file_type)},[e.file_type===s(i).IMAGE?(n(),f("img",{key:0,class:"w-full h-full object-cover",src:e.file_url,alt:"素材图片"},null,8,Ke)):e.file_type===s(i).VIDEO?(n(),f("video",{key:1,src:e.file_url,class:"w-full h-full"},null,8,Fe)):E("",!0)],8,je)):e.file_type===s(i).LINK?(n(),f("div",Te,[t(De,{title:e.file_name,desc:e.ext_info.link_desc,img:e.file_url},null,8,["title","desc","img"])])):e.file_type===s(i).MINI_PROGRAM?(n(),f("div",He,[t(Ne,{title:e.file_name,pic:e.file_url,link:e.ext_info.mini_program_path},null,8,["title","pic","link"])])):e.file_type===s(i).FILE?(n(),f("div",qe,[t(Se,{name:e.file_name,url:e.file_url},null,8,["name","url"])])):E("",!0),a("div",Ze,[w(e.file_type)?(n(),v(k,{key:0,content:"预览"},{default:r(()=>[a("div",{class:"cursor-pointer",onClick:g=>j(e.file_url,e.file_type)},[t(m,{name:"el-icon-ZoomIn",color:"#ffffff",size:18})],8,Je)]),_:2},1024)):E("",!0),t(k,{content:"删除"},{default:r(()=>[a("div",{class:"cursor-pointer",onClick:g=>ne(e.id)},[t(m,{name:"el-icon-Delete",color:"#ffffff",size:18})],8,We)]),_:2},1024),[s(i).IMAGE,s(i).VIDEO].includes(e.file_type)?(n(),v(k,{key:1,content:"下载"},{default:r(()=>[a("div",{class:"cursor-pointer",onClick:g=>s(B)(e.file_url)},[t(m,{name:"el-icon-Download",color:"#ffffff",size:18})],8,Ye)]),_:2},1024)):E("",!0),t(k,{content:"选择"},{default:r(()=>[a("div",{class:"cursor-pointer",onClick:g=>U(e)},[t(m,{name:"el-icon-Check",color:"#ffffff",size:18})],8,Qe)]),_:2},1024)])]),a("div",Xe,[w(e.file_type)?(n(),v(k,{key:0,content:e.file_name},{default:r(()=>[a("div",el,H(e.file_name),1)]),_:2},1032,["content"])):(n(),f("div",ll,H(e.create_time),1)),a("div",tl,[G(e.file_type)?(n(),v(k,{key:0,content:"编辑"},{default:r(()=>[t(h,{link:"",icon:s(q),onClick:g=>le(e)},null,8,["icon","onClick"])]),_:2},1024)):(n(),v(ae,{key:1,value:e.file_name,size:"default",width:"400px","show-limit":"",teleported:"",limit:50,onConfirm:g=>te(e,g)},{default:r(()=>[t(k,{content:"编辑"},{default:r(()=>[t(h,{link:"",icon:s(q)},null,8,["icon"])]),_:1})]),_:1},8,["value","onConfirm"]))])]),c.value.includes(e.id)?(n(),f("div",{key:0,class:"absolute inset-0 rounded-xl w-full h-full bg-black/5 z-20 flex items-center justify-center",onClick:g=>U(e)},[t(k,{content:"取消选择"},{default:r(()=>[a("div",null,[t(m,{name:"el-icon-Close",size:24,color:"#ffffff"})])]),_:1})],8,ol)):E("",!0)],2)]))),128))],2)]),_:1})):(n(),f("div",nl,[t(ce,{description:"暂无数据"})]))])),[[de,s(u).loading]]),a("div",il,[t(ue,{modelValue:s(u),"onUpdate:modelValue":o[1]||(o[1]=e=>L(u)?u.value=e:null),onChange:s(_)},null,8,["modelValue","onChange"])]),M.value?(n(),v($e,{key:0,ref_key:"uploadModalRef",ref:S,onClose:o[2]||(o[2]=e=>M.value=!1),onSuccess:oe},null,512)):E("",!0),t(ze,{modelValue:N.value,"onUpdate:modelValue":o[3]||(o[3]=e=>N.value=e),url:D.url,type:D.type,onClose:o[4]||(o[4]=e=>N.value=!1)},null,8,["modelValue","url","type"])])}}});const Kl=ge(sl,[["__scopeId","data-v-7db96e4c"]]);export{Kl as default};
