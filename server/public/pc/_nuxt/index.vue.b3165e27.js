import{d as E,r as u,G as k,aF as w,bz as y,k as D,l as T,q as p,s as v,m as x,Z as i}from"./entry.46557796.js";import{k as h,m as A}from"./drawing.7058a163.js";import{ModelEnum as m,drawTypeEnumMap as M,DrawTypeEnum as I}from"./index.fb0aa6a9.js";import b from"./useCreateForm.91aa09b3.js";import C from"./useDrawingTask.323114d7.js";import R from"./result-content.ed816fb5.js";import{E as Y}from"./index.304400de.js";const B={class:"h-full relative w-full"},F={class:"px-[10px]"},z=E({__name:"index",setup(G){const{onEvent:c,setFormData:f}=b(),n=u([]),r=u(!1);c("update:formData",async a=>{if(r.value){k.msgWarning("请等待上一次任务完成");return}r.value=!0;const{model:o,model_name:g,params:s}=a,e=w({date:y().format("YYYY-MM-DD HH:mm"),prompt:s.poster_description,images:[],formData:a,tags:[g,s.poster_type,s.poster_color,s.poster_title,s.poster_subtitle]});n.value.unshift(e);try{if(o==m.HIDREAMAI){e.images=new Array(parseInt(s.img_count)).fill({url:"",loading:!0,progress:0,status:0,error:!1});const{result:l}=await h(s),{processDrawingTask:t}=C({type:M[I.TXT2IMAGE],task_id:l.task_id,dataLists:e.images});await t({callback:_=>{e.images=_}})}else if(o==m.GENERAL||o==m.SEEDREAM){e.images=[{url:"",loading:!0,progress:0,status:0,error:!1}];const{result:l}=await A(s);e.images=[l.image_urls].map(t=>({url:t,loading:!1,progress:100,status:1,error:!1}))}}catch{e.images=e.images.map(t=>({...t,loading:!1,progress:0,status:4,error:!0}))}finally{r.value=!1}});const d=a=>{f(a)};return(a,o)=>(D(),T("div",B,[p(i(Y),null,{default:v(()=>[x("div",F,[p(R,{"result-lists":i(n),"is-all-tasks-completed":i(r),onRetry:d},null,8,["result-lists","is-all-tasks-completed"])])]),_:1})]))}});export{z as _};
