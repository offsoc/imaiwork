import{d as M,aF as O,r as C,k as o,l as f,m as u,q as s,s as a,v as i,Z as l,aI as U,I as E,t as c,L as _,bK as G,J as q,aH as T,G as x,ax as K,y as H,au as J,cP as X,u as Z}from"./entry.d7219633.js";import{E as z,a as Q}from"./index.50778a9c.js";import{E as W,a as Y}from"./index.0a6eb9ae.js";import{E as ee}from"./el-empty.77af023a.js";import{_ as te}from"./index.vue.5e2341cc.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                        *//* empty css                 */import{u as se}from"./usePaging.3c53b51c.js";import{R as ae,S as ne,T as le}from"./person_wechat.8bcf26fc.js";import{MaterialTypeEnum as h}from"./index.cf59f1a8.js";import{_ as oe}from"./add.vue.94fe958f.js";const ie={class:"h-full flex flex-col bg-white rounded-xl"},de={class:"flex items-center justify-between flex-shrink-0 p-4"},ue={class:"flex items-center justify-end gap-2 grow"},re={class:"grow min-h-0 flex flex-col overflow-hidden"},ce={class:"grow min-h-0"},_e={class:"flex items-center gap-2 justify-center"},me={key:0,class:"text-warning"},pe={key:1,class:"text-success"},fe={key:2,class:"text-[#918980]"},he={key:3,class:"text-danger"},ve={key:4,class:"text-info"},ye={class:"flex justify-end p-4"},Be=M({__name:"index",setup(ge){const b=Z(),v=O({send_status:"",wechat_id:""}),{pager:y,getLists:m,resetPage:V,resetParams:ke}=se({fetchFun:ae,params:v}),g=C(),k=C(!1),$=async()=>{var n;k.value=!0,await T(),(n=g.value)==null||n.open()},I=async n=>{var t,d;k.value=!0,await T(),(t=g.value)==null||t.open(),(d=g.value)==null||d.getDetail(n)},S=async n=>{await b.$confirm({message:"确定要删除任务吗？",onConfirm:async()=>{try{await ne({id:n}),x.msgSuccess("删除成功"),m()}catch(t){x.msgError(t)}}})},A=async n=>{await b.$confirm({message:`确定要${n.send_status==4?"恢复":"暂停"}任务吗？`,onConfirm:async()=>{try{await le({id:n.id,send_status:n.send_status==4?0:4}),x.msgSuccess("操作成功"),m()}catch(t){x.msgError(t)}}})},D=n=>({[h.IMAGE]:"图片",[h.VIDEO]:"视频",[h.LINK]:"链接",[h.MINI_PROGRAM]:"小程序",[h.FILE]:"文件",[h.TEXT]:"文本"})[n];return m(),(n,t)=>{const d=K,p=z,N=Q,P=H,B=J,r=W,L=ee,R=Y,j=te,F=X;return o(),f(q,null,[u("div",ie,[u("div",de,[s(d,{type:"primary",onClick:$},{default:a(()=>t[6]||(t[6]=[i("添加朋友圈任务",-1)])),_:1,__:[6]}),u("div",ue,[s(N,{modelValue:l(v).send_status,"onUpdate:modelValue":t[0]||(t[0]=e=>l(v).send_status=e),class:"!w-[140px]",placeholder:"请选择状态",clearable:"","empty-values":[null,void 0],onChange:t[1]||(t[1]=e=>l(V)())},{default:a(()=>[s(p,{label:"全部",value:""}),s(p,{label:"待执行",value:0},null,8,["value"]),s(p,{label:"执行中",value:1},null,8,["value"]),s(p,{label:"已完成",value:2},null,8,["value"]),s(p,{label:"已失败",value:3},null,8,["value"]),s(p,{label:"暂停中",value:4},null,8,["value"])]),_:1},8,["modelValue"]),u("div",null,[s(B,{modelValue:l(v).wechat_id,"onUpdate:modelValue":t[3]||(t[3]=e=>l(v).wechat_id=e),placeholder:"请选择微信号"},{append:a(()=>[s(d,{onClick:t[2]||(t[2]=e=>l(m)())},{default:a(()=>[s(P,{name:"el-icon-Search"})]),_:1})]),_:1},8,["modelValue"])])])]),u("div",re,[u("div",ce,[U((o(),E(R,{data:l(y).lists,stripe:"",height:"100%","header-row-style":{height:"62px"},"row-style":{height:"60px"}},{empty:a(()=>[s(L,{description:"暂无数据"})]),default:a(()=>[s(r,{prop:"wechat_nickname",label:"发送账号","min-width":"200"},{default:a(({row:e})=>[i(c(e.wechat_nickname)+"（"+c(e.wechat_id)+"） ",1)]),_:1}),s(r,{prop:"device_model",label:"朋友圈类型",width:"120"},{default:a(({row:e})=>[i(c(D(e.attachment_type)),1)]),_:1}),s(r,{prop:"send_status",label:"状态",width:"120"},{default:a(({row:e})=>[u("div",_e,[e.send_status==1?(o(),f("span",me,"执行中")):_("",!0),e.send_status==2?(o(),f("span",pe,"已完成")):_("",!0),e.send_status==4?(o(),f("span",fe,"暂停中")):_("",!0),e.send_status==3?(o(),f("span",he,"已失败")):_("",!0),e.send_status==0?(o(),f("span",ve,"待执行")):_("",!0)])]),_:1}),s(r,{label:"发送类型",width:"120"},{default:a(({row:e})=>[i(c(e.task_type==1?"定时发送":"即时"),1)]),_:1}),s(r,{prop:"send_time",label:"执行时间",width:"180"},{default:a(({row:e})=>[i(c(e.send_time||"-"),1)]),_:1}),s(r,{prop:"finish_time",label:"完成时间",width:"180"},{default:a(({row:e})=>[i(c(e.finish_time||"-"),1)]),_:1}),s(r,{label:"操作",width:"160",fixed:"right"},{default:a(({row:e})=>[s(d,{type:"primary",link:"",onClick:w=>I(e.id)},{default:a(()=>t[7]||(t[7]=[i("详情",-1)])),_:2,__:[7]},1032,["onClick"]),[0,1,4].includes(e.send_status)?(o(),E(d,{key:0,type:"warning",link:"",onClick:w=>A(e)},{default:a(()=>[i(c(e.send_status==4?"恢复":"暂停"),1)]),_:2},1032,["onClick"])):_("",!0),s(d,{type:"danger",link:"",onClick:w=>S(e.id)},{default:a(()=>t[8]||(t[8]=[i("删除",-1)])),_:2,__:[8]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,l(y).loading]])]),u("div",ye,[s(j,{modelValue:l(y),"onUpdate:modelValue":t[4]||(t[4]=e=>G(y)?y.value=e:null),onChange:l(m)},null,8,["modelValue","onChange"])])])]),l(k)?(o(),E(oe,{key:0,ref_key:"addTaskRef",ref:g,onClose:t[5]||(t[5]=e=>k.value=!1),onSuccess:l(m)},null,8,["onSuccess"])):_("",!0)],64)}}});export{Be as _};
