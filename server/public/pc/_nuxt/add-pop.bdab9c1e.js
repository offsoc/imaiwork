import{d as J,at as K,z as Z,aG as Q,c as _,dt as C,A as W,r as h,aF as X,cq as Y,k as r,l as d,q as a,s,Z as e,J as f,K as w,I as U,m as $,v as A,t as ee,L as oe,cP as te,G as B,au as le,av as ae,ay as ne,ax as se}from"./entry.d9d53b29.js";import{E as re,a as ue}from"./index.79f7263c.js";/* empty css                  *//* empty css               *//* empty css                     */import{g as me,c as ie}from"./digital_human.b276942f.js";import"./index.050c9b6b.js";import"./index.8a3302e5.js";import"./strings.fbd015b4.js";import"./debounce.39f38609.js";import"./_baseIteratee.73cb21ab.js";import"./index.4538c991.js";const de={class:"flex justify-end mt-6"},he=J({__name:"add-pop",emits:["success","close"],setup(ce,{expose:F,emit:I}){var y,E;const R=K(),u=Z(),{userTokens:T}=Q(u),L=_(()=>{var n;return(n=R.getDigitalHumanConfig)==null?void 0:n.channel}),q=(y=u.getTokenByScene(C.HUMAN_AUDIO))==null?void 0:y.score,N=(E=u.getTokenByScene(C.HUMAN_AUDIO_PRO))==null?void 0:E.score,c=_(()=>t.model_version==="1"?N:t.model_version==="2"?q:null),p=W(),v=I,g=h(),t=X({name:"",msg:"",voice_id:"",model_version:""}),D={name:[{required:!0,message:"请输入音频名称"}],msg:[{required:!0,message:"请输入音频内容"}],voice_id:[{required:!0,message:"请选择音色"}],model_version:[{required:!0,message:"请选择模型"}]},H=n=>{b()},k=h([]),b=async()=>{const{lists:n}=await me({page_no:1,page_size:9999,model_version:t.model_version});k.value=n.length?n.filter(o=>o.status==1):[]};_(()=>".mp3");const O=()=>{p.value.open(),b()},P=async()=>{var n,o;if(T.value<c.value){B.msgPowerInsufficient();return}await((n=g.value)==null?void 0:n.validate());try{await ie(t),(o=p.value)==null||o.close(),u.getUser(),v("success")}catch(m){B.msgError(m||"转写失败！")}},M=()=>{v("close")},{lockFn:z,isLock:V}=Y(P);return F({open:O}),(n,o)=>{const m=le,i=ae,x=re,S=ue,G=ne,j=se;return r(),d("div",null,[a(te,{title:"制作音频",ref_key:"popupRef",ref:p,async:!0,width:"500px","confirm-button-text":"","cancel-button-text":"",onClose:M},{default:s(()=>[a(G,{model:e(t),rules:D,ref_key:"formRef",ref:g,"label-position":"top",disabled:e(V)},{default:s(()=>[a(i,{label:"音频名称",prop:"name"},{default:s(()=>[a(m,{modelValue:e(t).name,"onUpdate:modelValue":o[0]||(o[0]=l=>e(t).name=l),placeholder:"请输入音频名称"},null,8,["modelValue"])]),_:1}),a(i,{label:"使用模型",prop:"model_version"},{default:s(()=>[a(S,{modelValue:e(t).model_version,"onUpdate:modelValue":o[1]||(o[1]=l=>e(t).model_version=l),placeholder:"请选择模型",onChange:H},{default:s(()=>[(r(!0),d(f,null,w(e(L),l=>(r(),U(x,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"音色",prop:"voice_id"},{default:s(()=>[a(S,{modelValue:e(t).voice_id,"onUpdate:modelValue":o[2]||(o[2]=l=>e(t).voice_id=l),disabled:!e(t).model_version,placeholder:"请选择音色"},{default:s(()=>[(r(!0),d(f,null,w(e(k),(l,pe)=>(r(),U(x,{value:l.voice_id,label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1}),a(i,{label:"音频内容",prop:"msg"},{default:s(()=>[a(m,{modelValue:e(t).msg,"onUpdate:modelValue":o[3]||(o[3]=l=>e(t).msg=l),placeholder:"请输入音频名称",type:"textarea",maxlength:150,"show-word-limit":"",rows:8},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),$("div",de,[a(j,{type:"primary",loading:e(V),onClick:e(z)},{default:s(()=>[o[4]||(o[4]=A("开始转写 ",-1)),e(c)?(r(),d(f,{key:0},[A("（消耗"+ee(e(c))+"算力）",1)],64)):oe("",!0)]),_:1,__:[4]},8,["loading","onClick"])])]),_:1},512)])}}});export{he as default};
