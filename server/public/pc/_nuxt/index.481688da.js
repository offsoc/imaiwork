import{d as De,at as Be,c as b,A as h,aF as te,bz as Ie,r as p,k as r,l as c,m as t,q as i,s as u,Z as l,v as D,aI as ze,J as B,K as se,Y as I,L as f,t as C,a0 as je,au as le,I as y,bK as Me,a3 as Re,aH as k,bI as Ue,G as ae,dt as Se,y as $e,ax as Pe,b5 as Le,cP as Oe,_ as Fe}from"./entry.d7219633.js";import{E as He,a as Ge}from"./el-tabs.f915a42a.js";import{E as Ye}from"./index.f15af271.js";import{E as Xe}from"./el-switch.69f0f4ce.js";import{a as Je,E as We}from"./index.50778a9c.js";import{E as Ke}from"./index.1f8dde63.js";import{_ as qe}from"./index.vue.f38ca415.js";import{_ as Ze}from"./index.vue.c82b4b26.js";/* empty css                     *//* empty css                  *//* empty css               *//* empty css                   */import{u as Qe}from"./usePaging.3c53b51c.js";import{u as eo}from"./useTemplate.afda57ca.js";import{e as oo}from"./digital_human.b276942f.js";import{A as to,a as so}from"./choose-audio.bd4b8b39.js";import{CreateTypeEnum as _,ModeTypeEnum as z,DigitalHumanModelVersionEnum as m}from"./index.728f9c9c.js";import{ClipStyleEnum as lo}from"./indexEnum.66dc19ba.js";import{CopywritingTypeEnum as ao}from"./chatEnum.1c450e0f.js";import io from"./generate-prompt.880cd9f7.js";import{_ as no}from"./index.55703cf7.js";import ro from"./choose-tone.d51ff0f9.js";import co from"./upload-form.323bcebe.js";import{_ as fo}from"./create-panel.vue.9808d460.js";import uo from"./choose-anchor.fb72d4dc.js";import"./strings.03d3529c.js";import"./index.35988ce8.js";import"./index.4953ba77.js";import"./debounce.085e8a4a.js";import"./_baseIteratee.5c97421a.js";import"./index.ead96a32.js";import"./el-empty.77af023a.js";import"./index.vue.5e2341cc.js";import"./useAudio.81c94342.js";import"./redbook.f03a8b74.js";import"./index.83df7a87.js";import"./el-segmented.e135a089.js";import"./index.3adcf74a.js";import"./index.9efd0300.js";import"./cloneDeep.1f319c9b.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./index.0a6eb9ae.js";/* empty css                        *//* empty css                 */import"./cloneDeep.343bf15a.js";import"./index.a571e11a.js";import"./video-item.a78cec48.js";import"./index.vue.38c569b2.js";import"./index.15764a88.js";import"./position.cb246d7d.js";import"./throttle.70466628.js";const mo=""+new URL("linshi.51f4e6ed.png",import.meta.url).href,po={class:"flex gap-x-4 h-full create-container"},_o={class:"w-12 h-12 rounded-xl flex items-center justify-center border border-dashed border-[#ffffff1a] hover:border-[#ffffff33] cursor-pointer"},vo={class:"flex-1 flex gap-4 flex-col overflow-hidden"},ho={class:"grow min-h-0 w-full flex flex-col bg-app-bg-2 rounded-xl overflow-hidden"},xo={key:0,class:"upload-container"},go={key:1,class:"w-full h-full relative flex overflow-hidden"},bo=["src"],yo={class:"h-[252px] bg-app-bg-2 flex flex-col rounded-lg flex-shrink-0 anchor-box"},wo={class:"relative"},Co={class:"flex items-center gap-2 absolute right-2 top-[10px]"},ko={class:"grow min-h-0 flex px-5 gap-[14px]"},Vo={class:"mt-5"},Eo={class:"flex gap-[14px] py-6 px-4"},No=["onClick"],Ao=["src"],To={key:0,class:"absolute top-0 left-0 w-full h-full flex items-center justify-center z-[88]"},Do={key:1,class:"absolute left-0 bottom-2 w-full flex justify-center"},Bo={key:0,class:"absolute top-2 right-2 z-[888] p-1 leading-[0] rounded-md"},Io=["onClick"],zo={key:3,class:"absolute top-0 left-0 w-full h-full bg-[#0000005E] z-[888]"},jo={class:"flex flex-col items-center justify-center w-full h-full gap-[2px]"},Mo={class:"w-6 h-6 rounded-full bg-primary flex items-center justify-center"},Ro={class:"create-card"},Uo={class:"px-4 py-[1px] bg-app-bg-1 rounded-md flex items-center gap-x-3 border border-[var(--app-border-color-1)]"},So={class:"flex-1 flex items-center"},$o={class:"grow min-h-0 bg-[#1A1A1A] rounded-lg flex flex-col"},Po={class:"create-tabs"},Lo={class:"grow min-h-0 mt-4"},Oo={key:0,class:"rounded-md border border-app-border-1"},Fo={class:"h-11 flex items-center gap-x-3 px-3 border-0 border-b-[1px] border-[var(--app-border-color-1)]"},Ho={class:"w-5 h-5 flex items-center justify-center rounded bg-[#ffffff0d]"},Go={class:"px-4"},Yo={class:"absolute top-2 right-2"},Xo={key:0,class:"absolute left-0 bottom-4 w-full flex justify-center"},Jo={class:"absolute left-0 bottom-0 w-full h-full flex items-center justify-center invisible group-hover:visible bg-[#000000cc]"},Wo={key:1,class:"flex flex-col items-center justify-center pt-[50px]"},Ko={class:"flex items-center gap-x-1 rounded-full bg-[#ffffff08] p-1 mt-5"},qo={class:"flex items-center justify-between mt-2"},Zo={class:"text-[#ffffff4d] text-xs"},Qo={class:"my-3"},et={key:1,class:"rounded-md border border-app-border-1"},ot={class:"h-11 flex items-center gap-x-3 px-3 border-0 border-b-[1px] border-app-border-1"},tt={class:"w-5 h-5 flex items-center justify-center rounded bg-[#ffffff0d]"},st={class:"p-2"},lt={class:"w-full h-[246px] flex flex-col items-center justify-center cursor-pointer"},at={key:2,class:"rounded-md border border-app-border-1 mt-4"},it={class:"h-11 flex items-center gap-x-3 px-3 border-0 border-b-[1px] border-app-border-1"},nt={class:"w-5 h-5 flex items-center justify-center rounded bg-[#ffffff0d]"},rt={class:"p-4"},ct={class:"flex justify-between items-center"};const dt={class:"mt-4"},ft=De({__name:"index",setup(ut){const ie=Be(),ne=b(()=>{var o;return((o=ie.getDigitalHumanConfig)==null?void 0:o.channel)||{}}),V=b(()=>ne.value.reduce((o,e)=>(o[e.id]=e.name,o),{})),re=h(),s=te({url:"",name:Ie().format("YYYYMMDDHHmm").substring(2),anchor_name:"",anchor_id:"",pic:"",model_version:"",audio_type:_.TEXT,audio_src:"",voice_id:"",voice_url:"",voice_name:"",msg:"",audio_duration:0,audio_url:"",voice_type:1,music_url:"",music_name:"",music_type:1,clip_type:`${lo.AI_RECOMMEND}`,automatic_clip:0}),H=h(),G=()=>{var o;s.pic="",s.url="",s.model_version="",s.anchor_name="",s.anchor_id="",s.audio_url="",s.audio_duration=0,x.value=-1,(o=H.value)==null||o.clearFile()},j=p(!1),M=h(),Y=async o=>{var e,n;j.value=!0,await k(),(e=M.value)==null||e.open(),(n=M.value)==null||n.setUrl(o)},X=async o=>{var e;L.value=!0,await k(),(e=q.value)==null||e.open(o)},x=p(-1),{pager:v,getLists:ce,resetPage:J}=Qe({fetchFun:oo,params:{type:0}}),R=b(()=>{const o=v.lists[x.value]||{};return{...o,name:s.name,anchor_name:o.anchor_id?o.name:o.anchor_name}}),de=async()=>{await J(),v.lists.unshift(...S.value)},E=p(!1),U=h(),fe=async()=>{var o,e;E.value=!0,await k(),(o=U.value)==null||o.open(),R.value&&((e=U.value)==null||e.setChooseAnchor(R.value))},ue=o=>{E.value=!1,W(o)},W=(o,e)=>{if(!o.is_vanish&&o.status!=1)return;x.value=e??v.lists.findIndex(d=>d.anchor_id==o.anchor_id),s.model_version!=o.model_version&&(Object.assign(s,{msg:"",audio_url:"",audio_duration:0}),s.voice_type==1&&s.voice_id!=-1&&Object.assign(s,{voice_id:"",voice_name:""}));const n={url:o.url,pic:o.pic,model_version:o.model_version,anchor_id:o.anchor_id,anchor_name:o.anchor_name,width:o.width,height:o.height};Object.assign(s,n)},S=p([]),me=async o=>{const{modelType:e}=o;if(e===z.VIDEO){const n={...o.formData,is_vanish:!0};S.value.unshift(n),v.lists.unshift(n),x.value=0,Ue(n,s)}else e===z.FIGURE&&(await J(),v.lists.unshift(...S.value))},$=h(),P=p(!1),pe=b(()=>s.model_version==m.CHANJING),_e=async()=>{var o,e;if(!s.model_version){ae.msgWarning("请先选择形象~");return}P.value=!0,await k(),(o=$.value)==null||o.open(s.model_version),s.voice_id&&((e=$.value)==null||e.setChooseTone({type:s.voice_type,voice_id:s.voice_id}))},ve=o=>{const{builtin:e,voice_id:n,name:d}=o;s.voice_name=d,s.voice_id=n,s.voice_type=e},K=h(),N=p(!1),mt=async()=>{var o;N.value=!0,await k(),(o=K.value)==null||o.open()},he=o=>{N.value=!1,s.music_url=o.url,s.music_name=o.name},pt=o=>{const{uri:e,name:n}=o.data;s.music_name=n,s.music_url=e,so({url:e,name:n,type:"0"})},_t=()=>{s.music_name="",s.music_url=""},q=h(),L=p(!1),g=b(()=>({[m.STANDARD]:150,[m.SUPER]:300,[m.ADVANCED]:1e3,[m.ELITE]:1e3,[m.CHANJING]:4e3})[s.model_version]||150),O=b(()=>{const o={[m.STANDARD]:{min:5,max:100,size:100},[m.SUPER]:{min:2,max:120,size:30},[m.ADVANCED]:{min:5,max:600,size:100},[m.ELITE]:{min:5,max:600,size:100},[m.CHANJING]:{min:30,max:600,size:100}};return s.model_version?o[s.model_version]:{}}),w=p(_.TEXT),xe=p([{label:"文字驱动",value:_.TEXT,icon:"txt"},{label:"语音驱动",value:_.AUDIO,icon:"mic"}]),ge=o=>{s.voice_id="",s.audio_type=o.index==="0"?_.TEXT:_.AUDIO,o.index===0?(s.audio_url="",s.audio_duration=0):(s.voice_url="",s.voice_name="",s.msg="")},be=o=>{const{response:{data:{uri:e}},raw:n}=o,d=new Audio(URL.createObjectURL(n));d.addEventListener("loadedmetadata",()=>{s.audio_duration=Math.floor(d.duration)}),s.audio_url=e},ye=o=>{o.length>g.value?(ae.msgWarning(`内容过长，将截取前${g.value}字符`),s.msg=o.substring(0,g.value)):s.msg=o},we=()=>{G(),setTimeout(()=>{window.location.reload()},2e3)},Ce=o=>{var n;const{type:e}=o;switch(e){case"name":(n=re.value)==null||n.focus();break}},Z=te({is_open:!1}),ke=async()=>{const{code:o}=await Se();Z.is_open=o==1e4},{DefineTemplate:Ve,UseTemplate:F}=eo();return ce(),ke(),(o,e)=>{const n=$e,d=Pe,A=He,Q=Ge,ee=Le,oe=Ye,Ee=Xe,vt=We,ht=Je,xt=Ke,gt=qe,Ne=Ze,Ae=Oe;return r(),c(B,null,[t("div",po,[i(l(Ve),null,{default:u(()=>[t("div",_o,[i(n,{name:"el-icon-Plus",color:"#ffffff"})])]),_:1}),t("div",vo,[t("div",ho,[l(s).url?(r(),c("div",go,[t("video",{src:l(s).url,class:"w-full h-full object-contain",controls:""},null,8,bo)])):(r(),c("div",xo,[e[15]||(e[15]=t("div",{class:"upload-title"},"领先的定制数字人形象",-1)),e[16]||(e[16]=t("div",{class:"text-xs text-white mt-[10px]"},"开始创作，打造你的专属数字人分身",-1)),i(d,{type:"primary",class:"mt-5 !h-[50px] !w-[208px] !rounded-full",onClick:e[0]||(e[0]=a=>X(l(z).VIDEO))},{default:u(()=>e[14]||(e[14]=[D(" 定制形象 ",-1)])),_:1,__:[14]})]))]),t("div",yo,[t("div",wo,[i(Q,{"model-value":"clone",class:"w-full"},{default:u(()=>[i(A,{name:"clone",label:"克隆数字人"}),i(A,{name:"image",label:"图片数字人（内测中）",disabled:""})]),_:1}),t("div",Co,[i(ee,{content:"刷新"},{default:u(()=>[i(d,{icon:"el-icon-Refresh",circle:"",onClick:de,color:"#1f1f1f"})]),_:1})])]),t("div",ko,[t("div",{class:"w-[116px] h-[154px] flex flex-col gap-4 items-center justify-evenly flex-shrink-0 my-6 border border-[#ffffff1a] rounded-xl cursor-pointer hover:border-[#ffffff33]",onClick:e[1]||(e[1]=a=>X(l(z).FIGURE))},[t("div",Vo,[i(l(F))]),e[17]||(e[17]=t("div",{class:"w-[68px] h-[24px] flex items-center justify-center rounded-full border border-[#ffffff1a] text-white text-[11px]"}," 形象克隆 ",-1))]),i(oe,{always:""},{default:u(()=>[ze((r(),c("div",Eo,[(r(!0),c(B,null,se(l(v).lists,(a,T)=>(r(),c("div",{class:I(["anchor-item card-gradient group bg-black flex-shrink-0",{"!border-primary":l(x)===T}]),key:a.id},[i(ee,{content:a.name||a.anchor_name,placement:"right",class:"w-full h-full"},{default:u(()=>[t("div",{class:"w-full h-full",onClick:Te=>W(a,T)},[t("div",{class:I(["absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center",{"blur-sm filter":a.is_vanish}])},[t("img",{src:a.pic,class:"w-full mx-auto h-full object-cover"},null,8,Ao)],2),a.is_vanish?(r(),c("div",To,e[18]||(e[18]=[t("img",{src:mo,class:"w-[50%]"},null,-1)]))):f("",!0),l(V)[a.model_version]?(r(),c("div",Do,[t("div",{class:I(["text-[10px] digital-human-tag",`digital-human-tag-${a.model_version}`])},C(l(V)[a.model_version]),3)])):f("",!0),a.status==1||a.is_vanish?(r(),c(B,{key:2},[l(x)==T?(r(),c("div",Bo,[i(n,{name:"local-icon-success_fill",color:"var(--color-primary)",size:20})])):f("",!0),t("div",{class:"w-4 h-4 flex items-center justify-center invisible group-hover:visible absolute right-1 bottom-2 z-[888] p-[2px] leading-[0] rounded-full bg-[#ffffff33]",style:{"backdrop-filter":"blur(5px)"},onClick:je(Te=>Y(a.url),["stop"])},[i(n,{name:"local-icon-play2",size:14})],8,Io)],64)):(r(),c("div",zo,[t("div",jo,[t("span",Mo,[i(n,{name:"local-icon-pic2",size:14})]),e[19]||(e[19]=t("span",{class:"text-white font-bold mt-1"},"正在生成中",-1)),e[20]||(e[20]=t("span",{class:"text-[rgba(255,255,255,0.5)]"},"大约等待几分钟",-1))])]))],8,No)]),_:2},1032,["content"])],2))),128))])),[[Ae,l(v).loading]])]),_:1})])])]),t("div",Ro,[t("div",Uo,[e[21]||(e[21]=t("div",{class:"text-[#ffffff80]"},"视频名称",-1)),e[22]||(e[22]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"2",height:"12",viewBox:"0 0 2 12",fill:"none"},[t("path",{opacity:"0.1",d:"M1 0V12",stroke:"white"})],-1)),t("div",So,[i(l(le),{modelValue:l(s).name,"onUpdate:modelValue":e[2]||(e[2]=a=>l(s).name=a),placeholder:"请输入数字人名称",class:"name-input",maxlength:"10","auto-focus":"",focus:"","input-style":"text-align:right;color:#ffffff"},null,8,["modelValue"]),i(n,{name:"local-icon-edit",size:14})])]),t("div",$o,[t("div",Po,[i(Q,{modelValue:l(w),"onUpdate:modelValue":e[3]||(e[3]=a=>Me(w)?w.value=a:null),onTabClick:ge},{default:u(()=>[(r(!0),c(B,null,se(l(xe),a=>(r(),y(A,{name:a.value,label:a.label},null,8,["name","label"]))),256))]),_:1},8,["modelValue"])]),t("div",Lo,[i(oe,null,{default:u(()=>[l(w)==l(_).TEXT?(r(),c("div",Oo,[t("div",Fo,[t("div",Ho,[i(n,{name:"local-icon-txt2",size:14})]),e[23]||(e[23]=t("div",{class:"text-[#ffffffcc]"},"文字设置",-1))]),t("div",Go,[l(s).model_version?(r(),c("div",{key:0,class:"w-[116px] h-[154px] rounded-xl bg-cover bg-no-repeat mt-4 relative shadow-[0_0_0_1px_var(--color-primary)] cursor-pointer overflow-hidden group hover:shadow-[0_0_0_1px_rgba(255,255,255,0.2)]",style:Re({backgroundImage:`url(${l(s).pic})`})},[t("div",Yo,[i(n,{name:"local-icon-success_fill",size:20,color:"var(--color-primary)"})]),l(V)[l(s).model_version]?(r(),c("div",Xo,[t("div",{class:I(["digital-human-tag",`digital-human-tag-${l(s).model_version}`])},C(l(V)[l(s).model_version]),3)])):f("",!0),t("div",Jo,[i(d,{color:"#FF3C26",class:"!h-[26px]",round:"",onClick:G},{default:u(()=>e[24]||(e[24]=[D("删除",-1)])),_:1,__:[24]})])],4)):(r(),c("div",Wo,[i(l(F)),i(d,{type:"primary",class:"mt-3 !h-[28px] !w-[68px] !text-[11px]",onClick:fe},{default:u(()=>e[25]||(e[25]=[D(" 选择形象 ",-1)])),_:1,__:[25]}),t("div",Ko,[i(n,{name:"local-icon-tips",size:16}),e[26]||(e[26]=t("div",{class:"text-[#ffffff4d] text-xs"}," 注意：重新选择形象，文案会重置与输入。 ",-1))])])),e[27]||(e[27]=t("svg",{class:"my-3",xmlns:"http://www.w3.org/2000/svg",width:"266",height:"2",viewBox:"0 0 266 2",fill:"none"},[t("path",{opacity:"0.1",d:"M0 1H266",stroke:"white","stroke-width":"0.5"})],-1)),t("div",null,[i(l(le),{class:"msg-input",modelValue:l(s).msg,"onUpdate:modelValue":e[4]||(e[4]=a=>l(s).msg=a),type:"textarea",placeholder:"请输入您的配音文案内容",resize:"none","input-style":"color:#ffffff;font-size:12px;",maxlength:l(g),rows:8},null,8,["modelValue","maxlength"]),t("div",qo,[t("div",null,[i(io,{"prompt-type":l(ao).AI_DIGITAL_HUMAN_COPYWRITING,"max-size":l(g),disabled:!l(s).model_version,onUseContent:ye},null,8,["prompt-type","max-size","disabled"])]),t("div",Zo,C(l(s).msg.length)+"/"+C(l(g)),1)])]),t("div",Qo,[i(d,{class:"w-full !h-[44px] !rounded-md",color:"#262626",onClick:_e},{default:u(()=>[D(C(l(s).voice_name||"从音色库选择"),1)]),_:1})])])])):f("",!0),l(w)==l(_).AUDIO?(r(),c("div",et,[t("div",ot,[t("div",tt,[i(n,{name:"local-icon-audio",size:14})]),e[28]||(e[28]=t("div",{class:"text-[#ffffffcc]"},"语音设置",-1))]),t("div",st,[i(no,{ref_key:"audioUploadRef",ref:H,type:"audio",drag:"","list-type":"text",multiple:!1,limit:1,"max-size":l(O).size,"min-duration":l(O).min,"max-duration":l(O).max,onRemove:e[5]||(e[5]=a=>l(s).audio_url=""),onChange:be},{default:u(()=>[t("div",lt,[i(l(F)),e[29]||(e[29]=t("div",{class:"mt-4 text-center"},[t("div",{class:"text-xs text-white"},"点击此上传音频,支持拖拽上传"),t("div",{class:"text-[#ffffff4d] text-xs mt-1"},"只支持mp3、wav格式")],-1))])]),_:1},8,["max-size","min-duration","max-duration"])])])):f("",!0),l(Z).is_open?(r(),c("div",at,[t("div",it,[t("div",nt,[i(n,{name:"local-icon-audio",size:14})]),e[30]||(e[30]=t("div",{class:"text-[#ffffffcc]"},"高级设置",-1))]),t("div",rt,[t("div",ct,[e[31]||(e[31]=t("div",{class:"text-xs text-white"},"AI智能剪辑",-1)),i(Ee,{modelValue:l(s).automatic_clip,"onUpdate:modelValue":e[6]||(e[6]=a=>l(s).automatic_clip=a),style:{"--el-switch-off-color":"#333333"},"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),(l(s).automatic_clip==1,f("",!0))])])):f("",!0)]),_:1})]),t("div",dt,[i(fo,{"form-data":{...l(s),...l(R)},onSuccess:we,onError:Ce},null,8,["form-data"])])])])]),l(L)?(r(),y(co,{key:0,ref_key:"uploadFormRef",ref:q,onCreate:me,onClose:e[9]||(e[9]=a=>L.value=!1),onPlayVideo:Y},null,512)):f("",!0),l(j)?(r(),y(Ne,{key:1,ref_key:"videoPreviewPlayerRef",ref:M,onClose:e[10]||(e[10]=a=>j.value=!1)},null,512)):f("",!0),l(E)?(r(),y(uo,{key:2,ref_key:"chooseAnchorRef",ref:U,onClose:e[11]||(e[11]=a=>E.value=!1),onConfirm:ue},null,512)):f("",!0),l(P)?(r(),y(ro,{key:3,ref_key:"chooseToneRef",ref:$,is_show_original:l(pe),onClose:e[12]||(e[12]=a=>P.value=!1),onConfirm:ve},null,8,["is_show_original"])):f("",!0),l(N)?(r(),y(to,{key:4,ref_key:"chooseMusicRef",ref:K,onClose:e[13]||(e[13]=a=>N.value=!1),onConfirm:he},null,512)):f("",!0)],64)}}});const gs=Fe(ft,[["__scopeId","data-v-e5f3d1a5"]]);export{gs as default};
