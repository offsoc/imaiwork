import{d as ee,z as te,aG as oe,r as v,A as se,c as z,cq as le,G as B,D as ne,k as l,l as m,m as n,q as _,s as d,Z as t,a0 as ae,J as g,K as j,I as i,L as h,v as b,t as w,cr as re,c7 as F,cs as ce,au as de,y as ie,av as ue,ay as pe,ax as me,_ as _e}from"./entry.d9d53b29.js";import{_ as fe}from"./index.ece7f347.js";import{E as xe}from"./index.050c9b6b.js";import{E as ye}from"./el-empty.03c7f5cd.js";import{_ as ve}from"./index.5be3fdec.js";/* empty css                     */import{u as he}from"./useCopy.6d9f93e9.js";import{c as ke}from"./agent.a3fcedc5.js";import{FormFieldTypeEnum as f}from"./index.994fc688.js";import"./index.d23c2db7.js";import"./index.cce223cb.js";import"./cloneDeep.df46b56a.js";/* empty css                  *//* empty css                    *//* empty css                  */const Ee={class:"w-full h-full flex"},ge={class:"basis-[40%] border-r-[1px] border-[#0000000d] py-4 flex flex-col"},be={class:"grow min-h-0"},we={class:"px-4"},Fe={class:"h-[111px] rounded-md flex flex-col items-center justify-center relative leading-5"},Ve={class:"mt-3 flex justify-center"},Ce={class:"flex-1"},Ie={class:"p-4"},Se={class:"flex flex-col gap-y-3"},Ue={class:"flex items-center justify-between px-[15px] h-[52px] border-b-[1px] border-[#0000000d]"},Re={class:"flex items-center gap-x-3"},Le={class:"px-2 py-[2px] bg-[#F2F2F2] rounded"},Ne={class:"py-4 px-[14px]"},ze=["onClick"],Be={key:1,class:"h-full flex items-center justify-center"},je={key:1,class:"h-full flex items-center justify-center"},Te=ee({__name:"index",props:{detail:{default:()=>({})},result:{default:()=>({})}},emits:["success"],setup(T,{emit:J}){const u=T,O=J,q=te(),{userTokens:$}=oe(q),{copy:V}=he(),r=v({}),C=se(),I=v({}),A=z(()=>{if(!u.detail)return[];let{inputs:o}=u.detail;return o=F(o)?JSON.parse(o):[],o.forEach(e=>{if(r.value[e.fields]=e.value,e.required==="true"){const c=e.type===f.FILE;I.value[e.fields]=[{required:!0,message:c?"请上传文件":"请输入",trigger:c?"change":"blur"}]}}),o}),x=z(()=>{if(!u.detail)return{};const o=F(u.detail.outputs)?JSON.parse(u.detail.outputs):[],e={};return o.forEach(c=>{e[c.fields]={...c}}),e}),D=(o,e)=>{r.value[e]=o.data.uri},G=(o,e)=>{r.value[e]=""},P=o=>{ce(o)?window.open(o):V(o)},y=v(null),k=v(!1),{lockFn:M,isLock:H}=le(async()=>{var o;if($.value<=1){B.msgPowerInsufficient();return}await((o=C.value)==null?void 0:o.validate());try{k.value=!0;const e=await ke({id:u.detail.id,...r.value});y.value=e,O("success",e)}catch(e){B.msgError(e)}finally{k.value=!1}});return ne(()=>u.result,o=>{if(o){const{content:e}=o;y.value=F(e)?JSON.parse(e):e}},{immediate:!0}),(o,e)=>{const c=de,K=ie,W=fe,X=ue,Z=pe,S=xe,E=me,Q=ye,Y=ve;return l(),m("div",Ee,[n("div",ge,[n("div",be,[_(S,null,{default:d(()=>[n("div",we,[_(Z,{ref_key:"formRef",ref:C,model:t(r),rules:t(I),"label-position":"top",onSubmit:e[0]||(e[0]=ae(()=>{},["prevent"]))},{default:d(()=>[(l(!0),m(g,null,j(t(A),(s,p)=>(l(),i(X,{key:p,label:s.name,prop:s.fields},{default:d(()=>[s.type===t(f).INPUT?(l(),i(c,{key:0,modelValue:t(r)[s.fields],"onUpdate:modelValue":a=>t(r)[s.fields]=a,class:"!h-11",clearable:"",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),s.type===t(f).TEXTAREA?(l(),i(c,{key:1,modelValue:t(r)[s.fields],"onUpdate:modelValue":a=>t(r)[s.fields]=a,clearable:"",placeholder:"请输入",type:"textarea",resize:"none",maxlength:1e3,rows:5},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),s.type===t(f).NUMBER?(l(),i(c,{key:2,modelValue:t(r)[s.fields],"onUpdate:modelValue":a=>t(r)[s.fields]=a,type:"number",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),s.type===t(f).FILE?(l(),i(W,{key:3,class:"w-full",drag:"",type:"file","list-type":"text",limit:1,"max-size":500,onRemove:a=>G(a,s.fields),onSuccess:a=>D(a,s.fields)},{default:d(()=>[n("div",Fe,[_(K,{name:"local-icon-file_add",size:36,color:"#000000"}),e[1]||(e[1]=n("span",{class:"text-gray-500 text-xs mt-2"},"点击或将文件拖拽到这里上传",-1))])]),_:2},1032,["onRemove","onSuccess"])):h("",!0)]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])])]),_:1})]),n("div",Ve,[_(E,{color:"#000000",class:"!h-[50px] w-[276px] !rounded-xl",loading:t(H),onClick:t(M)},{default:d(()=>e[2]||(e[2]=[b(" 立即运行 ",-1)])),_:1,__:[2]},8,["loading","onClick"])])]),n("div",Ce,[t(k)?(l(),m("div",je,[_(Y)])):(l(),m(g,{key:0},[t(y)?(l(),i(S,{key:0},{default:d(()=>[n("div",Ie,[n("div",Se,[(l(!0),m(g,null,j(t(y),(s,p)=>{var a,U,R;return l(),m("div",{key:p,class:"border border-[#0000000d] rounded-xl"},[n("div",Ue,[n("div",Re,[n("span",null,w(((a=t(x)[p])==null?void 0:a.name)||"-"),1),n("span",Le,w((U=t(x)[p])==null?void 0:U.type),1)]),((R=t(x)[p])==null?void 0:R.type)==t(f).FILE?(l(),i(E,{key:0,color:"#000000",size:"small",onClick:L=>{var N;return("download"in o?o.download:t(re))(s,(N=t(x)[p])==null?void 0:N.name)}},{default:d(()=>e[3]||(e[3]=[b(" 下载 ",-1)])),_:2,__:[3]},1032,["onClick"])):(l(),i(E,{key:1,color:"#000000",size:"small",onClick:L=>t(V)(s)},{default:d(()=>e[4]||(e[4]=[b("复制",-1)])),_:2,__:[4]},1032,["onClick"]))]),n("div",Ne,[n("span",{class:"text-primary hover:underline cursor-pointer",onClick:L=>P(s)},w(s),9,ze)])])}),128))])])]),_:1})):(l(),m("div",Be,[_(Q)]))],64))])])}}});const Ye=_e(Te,[["__scopeId","data-v-3164c1dc"]]);export{Ye as default};
