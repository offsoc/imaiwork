import{d as J,at as K,z as Z,aG as Q,c as _,dw as w,A as W,r as C,aF as X,cx as Y,k as r,l as d,q as a,s,Z as e,J as f,K as h,I as U,m as $,v as A,t as ee,L as oe,cV as te,G as B,au as le,av as ae,ay as ne,ax as se}from"./entry.2beb4577.js";import{E as re,a as me}from"./index.4d719c96.js";/* empty css                  *//* empty css               *//* empty css                     */import{g as ue,c as ie}from"./digital_human.b276942f.js";import"./index.47b30189.js";import"./index.dcd97a19.js";import"./strings.a9740cf6.js";import"./_baseIteratee.70cb6d8d.js";import"./toNumber.c824a4a2.js";import"./clamp.a46ea567.js";import"./index.9d200730.js";const de={class:"flex justify-end mt-6"},he=J({__name:"add-pop",emits:["success","close"],setup(ce,{expose:F,emit:I}){var y,E;const R=K(),m=Z(),{userTokens:T}=Q(m),L=_(()=>{var n;return(n=R.getDigitalHumanConfig)==null?void 0:n.channel}),N=(y=m.getTokenByScene(w.HUMAN_AUDIO))==null?void 0:y.score,q=(E=m.getTokenByScene(w.HUMAN_AUDIO_PRO))==null?void 0:E.score,c=_(()=>t.model_version==="1"?q:t.model_version==="2"?N:null),p=W(),v=I,g=C(),t=X({name:"",msg:"",voice_id:"",model_version:""}),D={name:[{required:!0,message:"请输入音频名称"}],msg:[{required:!0,message:"请输入音频内容"}],voice_id:[{required:!0,message:"请选择音色"}],model_version:[{required:!0,message:"请选择模型"}]},H=n=>{V()},k=C([]),V=async()=>{const{lists:n}=await ue({page_no:1,page_size:9999,model_version:t.model_version});k.value=n.length?n.filter(o=>o.status==1):[]};_(()=>".mp3");const O=()=>{p.value.open(),V()},M=async()=>{var n,o;if(T.value<c.value){B.msgPowerInsufficient();return}await((n=g.value)==null?void 0:n.validate());try{await ie(t),(o=p.value)==null||o.close(),m.getUser(),v("success")}catch(u){B.msgError(u||"转写失败！")}},P=()=>{v("close")},{lockFn:z,isLock:b}=Y(M);return F({open:O}),(n,o)=>{const u=le,i=ae,x=re,S=me,G=ne,j=se;return r(),d("div",null,[a(te,{title:"制作音频",ref_key:"popupRef",ref:p,async:!0,width:"500px","confirm-button-text":"","cancel-button-text":"",onClose:P},{default:s(()=>[a(G,{model:e(t),rules:D,ref_key:"formRef",ref:g,"label-position":"top",disabled:e(b)},{default:s(()=>[a(i,{label:"音频名称",prop:"name"},{default:s(()=>[a(u,{modelValue:e(t).name,"onUpdate:modelValue":o[0]||(o[0]=l=>e(t).name=l),placeholder:"请输入音频名称"},null,8,["modelValue"])]),_:1}),a(i,{label:"使用模型",prop:"model_version"},{default:s(()=>[a(S,{modelValue:e(t).model_version,"onUpdate:modelValue":o[1]||(o[1]=l=>e(t).model_version=l),placeholder:"请选择模型",onChange:H},{default:s(()=>[(r(!0),d(f,null,h(e(L),l=>(r(),U(x,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"音色",prop:"voice_id"},{default:s(()=>[a(S,{modelValue:e(t).voice_id,"onUpdate:modelValue":o[2]||(o[2]=l=>e(t).voice_id=l),disabled:!e(t).model_version,placeholder:"请选择音色"},{default:s(()=>[(r(!0),d(f,null,h(e(k),(l,pe)=>(r(),U(x,{value:l.voice_id,label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1}),a(i,{label:"音频内容",prop:"msg"},{default:s(()=>[a(u,{modelValue:e(t).msg,"onUpdate:modelValue":o[3]||(o[3]=l=>e(t).msg=l),placeholder:"请输入音频名称",type:"textarea",maxlength:150,"show-word-limit":"",rows:8},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),$("div",de,[a(j,{type:"primary",loading:e(b),onClick:e(z)},{default:s(()=>[o[4]||(o[4]=A("开始转写 ",-1)),e(c)?(r(),d(f,{key:0},[A("（消耗"+ee(e(c))+"算力）",1)],64)):oe("",!0)]),_:1},8,["loading","onClick"])])]),_:1},512)])}}});export{he as default};
